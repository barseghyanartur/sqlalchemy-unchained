
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="lang:clipboard.copy" content="Copy to clipboard">
  <meta name="lang:clipboard.copied" content="Copied to clipboard">
  <meta name="lang:search.language" content="en">
  <meta name="lang:search.pipeline.stopwords" content="True">
  <meta name="lang:search.pipeline.trimmer" content="True">
  <meta name="lang:search.result.none" content="No matching documents">
  <meta name="lang:search.result.one" content="1 matching document">
  <meta name="lang:search.result.other" content="# matching documents">
  <meta name="lang:search.tokenizer" content="[\s\-]+">

  
    <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin="">
    <link rel="stylesheet"
          href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono:400,500,700&display=fallback">

    <style>
      body,
      input {
        font-family: "Roboto", "Helvetica Neue", Helvetica, Arial, sans-serif
      }

      code,
      kbd,
      pre {
        font-family: "Roboto Mono", "Courier New", Courier, monospace
      }
    </style>
  

  <link rel="stylesheet" href="_static/stylesheets/application.css"/>
  <link rel="stylesheet" href="_static/stylesheets/application-palette.css"/>
  <link rel="stylesheet" href="_static/stylesheets/application-fixes.css"/>
  
  <link rel="stylesheet" href="_static/fonts/material-icons.css"/>
  
  <meta name="theme-color" content="#3f51b5">
  <script src="_static/javascripts/modernizr.js"></script>
  
  
  
    <title>API Documentation &#8212; SQLAlchemy Unchained v0.9.1 documentation</title>
    <link rel="stylesheet" href="_static/material.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/language_data.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Introducing SQLAlchemy Unchained" href="index.html" />
  
   
  
  <script src="_static/javascripts/version_dropdown.js"></script>
  <script>
    var json_loc = ""versions.json"",
        target_loc = "../",
        text = "Versions";
    $( document ).ready( add_version_dropdown(json_loc, target_loc, text));
  </script>


  </head>
  <body dir=ltr
        data-md-color-primary=blue data-md-color-accent=light-blue>
  
  <svg class="md-svg">
    <defs data-children-count="0">
      
      <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="__github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
      
    </defs>
  </svg>
  
  <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer">
  <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search">
  <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
  <a href="#api" tabindex="1" class="md-skip"> Skip to content </a>
  <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex navheader">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="/" title="SQLAlchemy Unchained v0.9.1 documentation" class="md-header-nav__button md-logo">
          
            <i class="md-icon">&#8734</i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          <span class="md-header-nav__topic">
            <a href="/" title="SQLAlchemy Unchained v0.9.1 documentation">SQLAlchemy Unchained</a>
          </span>
          <span class="md-header-nav__topic">
            <a href="" title="API Documentation">
              API Documentation
            </a>
          </span>
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
        
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" action="search.html" method="GET" name="search">
      <input type="text" class="md-search__input" name="q" placeholder="Search"
             autocapitalize="off" autocomplete="off" spellcheck="false"
             data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>

      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            <a href="https://github.com/briancappello/sqlalchemy-unchained" title="Go to repository" class="md-source" data-md-source="github">

    <div class="md-source__icon">
      <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24" width="28" height="28">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    SQLAlchemy Unchained
  </div>
</a>
          </div>
        </div>
      
    </div>
  </nav>
</header>

  
  <div class="md-container">
    
  
  <div class="md-hero"
       data-md-component="hero"
  >
    <div class="md-hero__inner md-grid">
      <p>Enhanced declarative models for SQLAlchemy</p>
    </div>
  </div>

    
    
    <main class="md-main">
      <div class="md-main__inner md-grid" data-md-component="container">
        
          <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="table-of-contents.html" title="SQLAlchemy Unchained v0.9.1 documentation" class="md-nav__button md-logo">
      
        <i class="md-icon">&#8734</i>
      
    </a>
    <a href="table-of-contents.html"
       title="SQLAlchemy Unchained v0.9.1 documentation">SQLAlchemy Unchained</a>
  </label>
    <div class="md-nav__source">
      <a href="https://github.com/briancappello/sqlalchemy-unchained" title="Go to repository" class="md-source" data-md-source="github">

    <div class="md-source__icon">
      <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24" width="28" height="28">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    SQLAlchemy Unchained
  </div>
</a>
    </div>
  
  


  

  

  <ul class="md-nav__list">
    <li class="md-nav__item">
      

      <a href="index.html"
         class="md-nav__link"
      >
        Introducing SQLAlchemy Unchained
      </a>

      
    </li>
    <li class="md-nav__item">
      
        <input type="checkbox" id="__toc"
               class="md-toggle md-nav__toggle"
               data-md-toggle="toc">
        <label class="md-nav__link md-nav__link--active" for="__toc">
          API Documentation
        </label>
      

      <a href="#"
         class="md-nav__link md-nav__link--active"
      >
        API Documentation
      </a>

      
        

<nav class="md-nav md-nav--secondary">
  <ul class="md-nav__list" data-md-scrollfix="">
        <li class="md-nav__item">
          <a href="#api--page-root" class="md-nav__link">
            
              <strong>API Documentation</strong>
            
          </a><nav class="md-nav">
              <ul class="md-nav__list">
                
        <li class="md-nav__item">
          <a href="#init-sqlalchemy-unchained" class="md-nav__link">
            
              init_sqlalchemy_unchained
            
          </a>
        </li>
        <li class="md-nav__item">
          <a href="#scoped-session-factory" class="md-nav__link">
            
              scoped_session_factory
            
          </a>
        </li>
        <li class="md-nav__item">
          <a href="#declarative-base" class="md-nav__link">
            
              declarative_base
            
          </a>
        </li>
        <li class="md-nav__item">
          <a href="#foreign-key" class="md-nav__link">
            
              foreign_key
            
          </a>
        </li>
        <li class="md-nav__item">
          <a href="#basemodel" class="md-nav__link">
            
              BaseModel
            
          </a>
        </li>
        <li class="md-nav__item">
          <a href="#declarativemeta" class="md-nav__link">
            
              DeclarativeMeta
            
          </a>
        </li>
        <li class="md-nav__item">
          <a href="#basequery" class="md-nav__link">
            
              BaseQuery
            
          </a>
        </li>
        <li class="md-nav__item">
          <a href="#sessionmanager" class="md-nav__link">
            
              SessionManager
            
          </a>
        </li>
        <li class="md-nav__item">
          <a href="#modelmanager" class="md-nav__link">
            
              ModelManager
            
          </a>
        </li>
        <li class="md-nav__item">
          <a href="#columnmetaoption" class="md-nav__link">
            
              ColumnMetaOption
            
          </a>
        </li>
        <li class="md-nav__item">
          <a href="#modelmetaoptionsfactory" class="md-nav__link">
            
              ModelMetaOptionsFactory
            
          </a>
        </li>
        <li class="md-nav__item">
          <a href="#modelregistry" class="md-nav__link">
            
              _ModelRegistry
            
          </a>
        </li>
        <li class="md-nav__item">
          <a href="#basevalidator" class="md-nav__link">
            
              BaseValidator
            
          </a>
        </li>
        <li class="md-nav__item">
          <a href="#validationerror" class="md-nav__link">
            
              ValidationError
            
          </a>
        </li>
        <li class="md-nav__item">
          <a href="#validationerrors" class="md-nav__link">
            
              ValidationErrors
            
          </a>
        </li>
        <li class="md-nav__item">
          <a href="#required" class="md-nav__link">
            
              Required
            
          </a>
        </li>
              </ul>
            </nav>
        </li>
      
<li class="md-nav__item"><a class="md-nav__extra_link" href="_sources/api.rst.txt">Show Source</a> </li>

  </ul>
</nav>
      <ul class="md-nav__list">
          
    <li class="md-nav__item">
      

      <a href="#init-sqlalchemy-unchained"
         class="md-nav__link"
      >
        init_sqlalchemy_unchained
      </a>

      
    </li>
    <li class="md-nav__item">
      

      <a href="#scoped-session-factory"
         class="md-nav__link"
      >
        scoped_session_factory
      </a>

      
    </li>
    <li class="md-nav__item">
      

      <a href="#declarative-base"
         class="md-nav__link"
      >
        declarative_base
      </a>

      
    </li>
    <li class="md-nav__item">
      

      <a href="#foreign-key"
         class="md-nav__link"
      >
        foreign_key
      </a>

      
    </li>
    <li class="md-nav__item">
      

      <a href="#basemodel"
         class="md-nav__link"
      >
        BaseModel
      </a>

      
    </li>
    <li class="md-nav__item">
      

      <a href="#declarativemeta"
         class="md-nav__link"
      >
        DeclarativeMeta
      </a>

      
    </li>
    <li class="md-nav__item">
      

      <a href="#basequery"
         class="md-nav__link"
      >
        BaseQuery
      </a>

      
    </li>
    <li class="md-nav__item">
      

      <a href="#sessionmanager"
         class="md-nav__link"
      >
        SessionManager
      </a>

      
    </li>
    <li class="md-nav__item">
      

      <a href="#modelmanager"
         class="md-nav__link"
      >
        ModelManager
      </a>

      
    </li>
    <li class="md-nav__item">
      

      <a href="#columnmetaoption"
         class="md-nav__link"
      >
        ColumnMetaOption
      </a>

      
    </li>
    <li class="md-nav__item">
      

      <a href="#modelmetaoptionsfactory"
         class="md-nav__link"
      >
        ModelMetaOptionsFactory
      </a>

      
    </li>
    <li class="md-nav__item">
      

      <a href="#modelregistry"
         class="md-nav__link"
      >
        _ModelRegistry
      </a>

      
    </li>
    <li class="md-nav__item">
      

      <a href="#basevalidator"
         class="md-nav__link"
      >
        BaseValidator
      </a>

      
    </li>
    <li class="md-nav__item">
      

      <a href="#validationerror"
         class="md-nav__link"
      >
        ValidationError
      </a>

      
    </li>
    <li class="md-nav__item">
      

      <a href="#validationerrors"
         class="md-nav__link"
      >
        ValidationErrors
      </a>

      
    </li>
    <li class="md-nav__item">
      

      <a href="#required"
         class="md-nav__link"
      >
        Required
      </a>

      
    </li>
        </ul>
    </li>
  </ul>
  

</nav>
              </div>
            </div>
          </div>
          <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                

<nav class="md-nav md-nav--secondary">
  <ul class="md-nav__list" data-md-scrollfix="">
        <li class="md-nav__item">
          <a href="#api--page-root" class="md-nav__link">
            
              <strong>API Documentation</strong>
            
          </a><nav class="md-nav">
              <ul class="md-nav__list">
                
        <li class="md-nav__item">
          <a href="#init-sqlalchemy-unchained" class="md-nav__link">
            
              init_sqlalchemy_unchained
            
          </a>
        </li>
        <li class="md-nav__item">
          <a href="#scoped-session-factory" class="md-nav__link">
            
              scoped_session_factory
            
          </a>
        </li>
        <li class="md-nav__item">
          <a href="#declarative-base" class="md-nav__link">
            
              declarative_base
            
          </a>
        </li>
        <li class="md-nav__item">
          <a href="#foreign-key" class="md-nav__link">
            
              foreign_key
            
          </a>
        </li>
        <li class="md-nav__item">
          <a href="#basemodel" class="md-nav__link">
            
              BaseModel
            
          </a>
        </li>
        <li class="md-nav__item">
          <a href="#declarativemeta" class="md-nav__link">
            
              DeclarativeMeta
            
          </a>
        </li>
        <li class="md-nav__item">
          <a href="#basequery" class="md-nav__link">
            
              BaseQuery
            
          </a>
        </li>
        <li class="md-nav__item">
          <a href="#sessionmanager" class="md-nav__link">
            
              SessionManager
            
          </a>
        </li>
        <li class="md-nav__item">
          <a href="#modelmanager" class="md-nav__link">
            
              ModelManager
            
          </a>
        </li>
        <li class="md-nav__item">
          <a href="#columnmetaoption" class="md-nav__link">
            
              ColumnMetaOption
            
          </a>
        </li>
        <li class="md-nav__item">
          <a href="#modelmetaoptionsfactory" class="md-nav__link">
            
              ModelMetaOptionsFactory
            
          </a>
        </li>
        <li class="md-nav__item">
          <a href="#modelregistry" class="md-nav__link">
            
              _ModelRegistry
            
          </a>
        </li>
        <li class="md-nav__item">
          <a href="#basevalidator" class="md-nav__link">
            
              BaseValidator
            
          </a>
        </li>
        <li class="md-nav__item">
          <a href="#validationerror" class="md-nav__link">
            
              ValidationError
            
          </a>
        </li>
        <li class="md-nav__item">
          <a href="#validationerrors" class="md-nav__link">
            
              ValidationErrors
            
          </a>
        </li>
        <li class="md-nav__item">
          <a href="#required" class="md-nav__link">
            
              Required
            
          </a>
        </li>
              </ul>
            </nav>
        </li>
      
<li class="md-nav__item"><a class="md-nav__extra_link" href="_sources/api.rst.txt">Show Source</a> </li>

<li id="searchbox" class="md-nav__item"></li>

  </ul>
</nav>
              </div>
            </div>
          </div>
        
        <div class="md-content">
          <article class="md-content__inner md-typeset" role="main">
            
  
<h1 id="api--page-root">API Documentation<a class="headerlink" href="#api--page-root" title="Permalink to this headline">¶</a></h1>
<p><strong>sqlalchemy_unchained</strong></p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%"/>
<col style="width: 90%"/>
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#sqlalchemy_unchained.init_sqlalchemy_unchained" title="sqlalchemy_unchained.init_sqlalchemy_unchained"><code class="xref py py-obj docutils literal notranslate"><span class="pre">init_sqlalchemy_unchained</span></code></a></p></td>
<td><p>Main entry point for connecting to the database.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sqlalchemy_unchained.scoped_session_factory" title="sqlalchemy_unchained.scoped_session_factory"><code class="xref py py-obj docutils literal notranslate"><span class="pre">scoped_session_factory</span></code></a></p></td>
<td><p>Creates a scoped session using <a class="reference external" href="https://docs.sqlalchemy.org/en/13/orm/session_api.html#sqlalchemy.orm.session.sessionmaker" title="(in SQLAlchemy v1.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">sessionmaker</span></code></a>.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sqlalchemy_unchained.declarative_base" title="sqlalchemy_unchained.declarative_base"><code class="xref py py-obj docutils literal notranslate"><span class="pre">declarative_base</span></code></a></p></td>
<td><p>Construct a base class for declarative class definitions.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sqlalchemy_unchained.foreign_key" title="sqlalchemy_unchained.foreign_key"><code class="xref py py-obj docutils literal notranslate"><span class="pre">foreign_key</span></code></a></p></td>
<td><p>Helper method to add a foreign key column to a model.</p></td>
</tr>
</tbody>
</table>
<p><strong>sqlalchemy_unchained.base_model</strong></p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%"/>
<col style="width: 90%"/>
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#sqlalchemy_unchained.BaseModel" title="sqlalchemy_unchained.BaseModel"><code class="xref py py-obj docutils literal notranslate"><span class="pre">BaseModel</span></code></a></p></td>
<td><p>Base model class for SQLAlchemy declarative base model.</p></td>
</tr>
</tbody>
</table>
<p><strong>sqlalchemy_unchained.base_model_metaclass</strong></p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%"/>
<col style="width: 90%"/>
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#sqlalchemy_unchained.DeclarativeMeta" title="sqlalchemy_unchained.DeclarativeMeta"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeclarativeMeta</span></code></a></p></td>
<td><p>Base metaclass for models in SQLAlchemy Unchained.</p></td>
</tr>
</tbody>
</table>
<p><strong>sqlalchemy_unchained.base_query</strong></p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%"/>
<col style="width: 90%"/>
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#sqlalchemy_unchained.BaseQuery" title="sqlalchemy_unchained.BaseQuery"><code class="xref py py-obj docutils literal notranslate"><span class="pre">BaseQuery</span></code></a></p></td>
<td><p>Base class to use for the <a class="reference internal" href="#sqlalchemy_unchained.ModelManager.query" title="sqlalchemy_unchained.ModelManager.query"><code class="xref py py-attr docutils literal notranslate"><span class="pre">query</span></code></a> attribute on model managers.</p></td>
</tr>
</tbody>
</table>
<p><strong>sqlalchemy_unchained.session_manager</strong></p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%"/>
<col style="width: 90%"/>
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#sqlalchemy_unchained.SessionManager" title="sqlalchemy_unchained.SessionManager"><code class="xref py py-obj docutils literal notranslate"><span class="pre">SessionManager</span></code></a></p></td>
<td><p>The session manager for SQLAlchemy Unchained.</p></td>
</tr>
</tbody>
</table>
<p><strong>sqlalchemy_unchained.model_manager</strong></p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%"/>
<col style="width: 90%"/>
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#sqlalchemy_unchained.ModelManager" title="sqlalchemy_unchained.ModelManager"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ModelManager</span></code></a></p></td>
<td><p>Base class for model managers.</p></td>
</tr>
</tbody>
</table>
<p><strong>sqlalchemy_unchained.model_meta_options</strong></p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%"/>
<col style="width: 90%"/>
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#sqlalchemy_unchained.ColumnMetaOption" title="sqlalchemy_unchained.ColumnMetaOption"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ColumnMetaOption</span></code></a></p></td>
<td><p>A <a class="reference external" href="https://py-meta-utils.readthedocs.io/en/latest/api.html#py_meta_utils.MetaOption" title="(in Py-Meta-Utils)"><code class="xref py py-class docutils literal notranslate"><span class="pre">MetaOption</span></code></a> subclass that simplifies adding columns to models.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sqlalchemy_unchained.ModelMetaOptionsFactory" title="sqlalchemy_unchained.ModelMetaOptionsFactory"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ModelMetaOptionsFactory</span></code></a></p></td>
<td><p>The default <a class="reference external" href="https://py-meta-utils.readthedocs.io/en/latest/api.html#py_meta_utils.MetaOptionsFactory" title="(in Py-Meta-Utils)"><code class="xref py py-class docutils literal notranslate"><span class="pre">MetaOptionsFactory</span></code></a> subclass used by SQLAlchemy Unchained.</p></td>
</tr>
</tbody>
</table>
<p><strong>sqlalchemy_unchained.model_registry</strong></p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%"/>
<col style="width: 90%"/>
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#sqlalchemy_unchained._ModelRegistry" title="sqlalchemy_unchained._ModelRegistry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">_ModelRegistry</span></code></a></p></td>
<td><p>The SQLAlchemy Unchained model registry.</p></td>
</tr>
</tbody>
</table>
<p><strong>sqlalchemy_unchained.validation</strong></p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%"/>
<col style="width: 90%"/>
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#sqlalchemy_unchained.BaseValidator" title="sqlalchemy_unchained.BaseValidator"><code class="xref py py-obj docutils literal notranslate"><span class="pre">BaseValidator</span></code></a></p></td>
<td><p>Base class for column validators in SQLAlchemy Unchained.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sqlalchemy_unchained.ValidationError" title="sqlalchemy_unchained.ValidationError"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ValidationError</span></code></a></p></td>
<td><p>Holds a validation error for a single column of a model.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sqlalchemy_unchained.ValidationErrors" title="sqlalchemy_unchained.ValidationErrors"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ValidationErrors</span></code></a></p></td>
<td><p>Holds validation errors for an entire model.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sqlalchemy_unchained.Required" title="sqlalchemy_unchained.Required"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Required</span></code></a></p></td>
<td><p>A validator to require data.</p></td>
</tr>
</tbody>
</table>

<h2 id="init-sqlalchemy-unchained">init_sqlalchemy_unchained<a class="headerlink" href="#init-sqlalchemy-unchained" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="sqlalchemy_unchained.init_sqlalchemy_unchained">
<code class="sig-prename descclassname">sqlalchemy_unchained.</code><code class="sig-name descname">init_sqlalchemy_unchained</code><span class="sig-paren">(</span><em class="sig-param">database_uri</em>, <em class="sig-param">session_scopefunc=None</em>, <em class="sig-param">query_cls=&lt;class 'sqlalchemy_unchained.base_query.BaseQuery'&gt;</em>, <em class="sig-param">isolation_level=None</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sqlalchemy_unchained.html#init_sqlalchemy_unchained"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sqlalchemy_unchained.init_sqlalchemy_unchained" title="Permalink to this definition">¶</a></dt>
<dd><p>Main entry point for connecting to the database.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>database_uri</strong> – The SQLAlchemy database URI to connect to.</p></li>
<li><p><strong>session_scopefunc</strong> – The function to use for automatically scoping the session.
Defaults to <code class="docutils literal notranslate"><span class="pre">None</span></code>, which means you have full control
over the session lifecycle.</p></li>
<li><p><strong>query_cls</strong> – Class which should be used to create new <code class="docutils literal notranslate"><span class="pre">Query</span></code> objects, as
returned by <a class="reference internal" href="#sqlalchemy_unchained.ModelManager.query" title="sqlalchemy_unchained.ModelManager.query"><code class="xref py py-attr docutils literal notranslate"><span class="pre">query</span></code></a>.</p></li>
<li><p><strong>isolation_level</strong> – The isolation level to use for the engine connection.</p></li>
<li><p><strong>kwargs</strong> – Any extra keyword arguments to pass to <a class="reference internal" href="#sqlalchemy_unchained.declarative_base" title="sqlalchemy_unchained.declarative_base"><code class="xref py py-func docutils literal notranslate"><span class="pre">declarative_base()</span></code></a>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Tuple[engine, Session, Model, relationship]</p>
</dd>
</dl>
</dd></dl>


<h2 id="scoped-session-factory">scoped_session_factory<a class="headerlink" href="#scoped-session-factory" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="sqlalchemy_unchained.scoped_session_factory">
<code class="sig-prename descclassname">sqlalchemy_unchained.</code><code class="sig-name descname">scoped_session_factory</code><span class="sig-paren">(</span><em class="sig-param">bind=None</em>, <em class="sig-param">scopefunc=None</em>, <em class="sig-param">query_cls=&lt;class 'sqlalchemy_unchained.base_query.BaseQuery'&gt;</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sqlalchemy_unchained.html#scoped_session_factory"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sqlalchemy_unchained.scoped_session_factory" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a scoped session using <a class="reference external" href="https://docs.sqlalchemy.org/en/13/orm/session_api.html#sqlalchemy.orm.session.sessionmaker" title="(in SQLAlchemy v1.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">sessionmaker</span></code></a>.
See the SQLAlchemy documentation on
<a class="reference external" href="https://docs.sqlalchemy.org/en/latest/orm/contextual.html">Contextual Sessions</a>
to learn more.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>bind</strong> – An <a class="reference external" href="https://docs.sqlalchemy.org/en/13/core/connections.html#sqlalchemy.engine.Engine" title="(in SQLAlchemy v1.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Engine</span></code></a> or other
<a class="reference external" href="https://docs.sqlalchemy.org/en/13/core/connections.html#sqlalchemy.engine.Connectable" title="(in SQLAlchemy v1.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Connectable</span></code></a> with which newly
created <a class="reference external" href="https://docs.sqlalchemy.org/en/13/orm/session_api.html#sqlalchemy.orm.session.Session" title="(in SQLAlchemy v1.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Session</span></code></a> objects will
be associated.</p></li>
<li><p><strong>scopefunc</strong> – An optional function which defines the current scope. If
not passed, the <a class="reference external" href="https://docs.sqlalchemy.org/en/13/orm/contextual.html#sqlalchemy.orm.scoping.scoped_session" title="(in SQLAlchemy v1.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">scoped_session</span></code></a>
object assumes “thread-local” scope, and will use a Python
<code class="docutils literal notranslate"><span class="pre">threading.local()</span></code> in order to maintain the current
<a class="reference external" href="https://docs.sqlalchemy.org/en/13/orm/session_api.html#sqlalchemy.orm.session.Session" title="(in SQLAlchemy v1.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Session</span></code></a>. If passed, the
function should return a hashable token; this token will be
used as the key in a dictionary in order to store and
retrieve the current <a class="reference external" href="https://docs.sqlalchemy.org/en/13/orm/session_api.html#sqlalchemy.orm.session.Session" title="(in SQLAlchemy v1.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Session</span></code></a>.</p></li>
<li><p><strong>query_cls</strong> – Class which should be used to create new <code class="docutils literal notranslate"><span class="pre">Query</span></code> objects, as
returned by <a class="reference internal" href="#sqlalchemy_unchained.ModelManager.query" title="sqlalchemy_unchained.ModelManager.query"><code class="xref py py-attr docutils literal notranslate"><span class="pre">query</span></code></a>.</p></li>
<li><p><strong>kwargs</strong> – Any extra kwargs to pass along to
<a class="reference external" href="https://docs.sqlalchemy.org/en/13/orm/session_api.html#sqlalchemy.orm.session.sessionmaker" title="(in SQLAlchemy v1.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">sessionmaker</span></code></a>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>


<h2 id="declarative-base">declarative_base<a class="headerlink" href="#declarative-base" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="sqlalchemy_unchained.declarative_base">
<code class="sig-prename descclassname">sqlalchemy_unchained.</code><code class="sig-name descname">declarative_base</code><span class="sig-paren">(</span><em class="sig-param">model=&lt;class 'sqlalchemy_unchained.base_model.BaseModel'&gt;</em>, <em class="sig-param">name='Model'</em>, <em class="sig-param">bind=None</em>, <em class="sig-param">metadata=None</em>, <em class="sig-param">mapper=None</em>, <em class="sig-param">class_registry=None</em>, <em class="sig-param">metaclass=&lt;class 'sqlalchemy_unchained.base_model_metaclass.DeclarativeMeta'&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sqlalchemy_unchained.html#declarative_base"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sqlalchemy_unchained.declarative_base" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct a base class for declarative class definitions.</p>
<p>The new base class will be given a metaclass that produces
appropriate <a class="reference external" href="https://docs.sqlalchemy.org/en/13/core/metadata.html#sqlalchemy.schema.Table" title="(in SQLAlchemy v1.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Table</span></code></a> objects and makes
the appropriate <a class="reference external" href="https://docs.sqlalchemy.org/en/13/orm/mapping_api.html#sqlalchemy.orm.mapper" title="(in SQLAlchemy v1.3)"><code class="xref py py-func docutils literal notranslate"><span class="pre">mapper()</span></code></a> calls based on the
information provided declaratively in the class and any subclasses
of the class.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>bind</strong> – An optional <a class="reference external" href="https://docs.sqlalchemy.org/en/13/core/connections.html#sqlalchemy.engine.Connectable" title="(in SQLAlchemy v1.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Connectable</span></code></a>, will be assigned
the <code class="docutils literal notranslate"><span class="pre">bind</span></code> attribute on the <a class="reference external" href="https://docs.sqlalchemy.org/en/13/core/metadata.html#sqlalchemy.schema.MetaData" title="(in SQLAlchemy v1.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">MetaData</span></code></a>
instance.</p></li>
<li><p><strong>metadata</strong> – An optional <a class="reference external" href="https://docs.sqlalchemy.org/en/13/core/metadata.html#sqlalchemy.schema.MetaData" title="(in SQLAlchemy v1.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">MetaData</span></code></a> instance.  All
<a class="reference external" href="https://docs.sqlalchemy.org/en/13/core/metadata.html#sqlalchemy.schema.Table" title="(in SQLAlchemy v1.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Table</span></code></a> objects implicitly declared by
subclasses of the base will share this MetaData.  A MetaData instance
will be created if none is provided.  The
<a class="reference external" href="https://docs.sqlalchemy.org/en/13/core/metadata.html#sqlalchemy.schema.MetaData" title="(in SQLAlchemy v1.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">MetaData</span></code></a> instance will be available via the
<cite>metadata</cite> attribute of the generated declarative base class.</p></li>
<li><p><strong>mapper</strong> – An optional callable, defaults to <a class="reference external" href="https://docs.sqlalchemy.org/en/13/orm/mapping_api.html#sqlalchemy.orm.mapper" title="(in SQLAlchemy v1.3)"><code class="xref py py-func docutils literal notranslate"><span class="pre">mapper()</span></code></a>. Will
be used to map subclasses to their Tables.</p></li>
<li><p><strong>model</strong> – Defaults to <a class="reference internal" href="#sqlalchemy_unchained.BaseModel" title="sqlalchemy_unchained.BaseModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseModel</span></code></a>. A type to use as
the base for the generated declarative base class. May be a class or a
tuple of classes.</p></li>
<li><p><strong>name</strong> – Defaults to <code class="docutils literal notranslate"><span class="pre">Model</span></code>.  The display name for the generated class.
Customizing this is not required, but can improve clarity in
tracebacks and debugging.</p></li>
<li><p><strong>class_registry</strong> – An optional dictionary that will serve as the registry of
class names-&gt; mapped classes when string names are used to identify
classes inside of <code class="xref py py-func docutils literal notranslate"><span class="pre">relationship()</span></code> and others.  Allows two or
more declarative base classes to share the same registry of class
names for simplified inter-base relationships.</p></li>
<li><p><strong>metaclass</strong> – Defaults to <a class="reference internal" href="#sqlalchemy_unchained.DeclarativeMeta" title="sqlalchemy_unchained.DeclarativeMeta"><code class="xref py py-class docutils literal notranslate"><span class="pre">DeclarativeMeta</span></code></a>. The metaclass
to use as the meta type of the generated declarative base class. If you
want to customize this, your metaclass must extend
<a class="reference internal" href="#sqlalchemy_unchained.DeclarativeMeta" title="sqlalchemy_unchained.DeclarativeMeta"><code class="xref py py-class docutils literal notranslate"><span class="pre">DeclarativeMeta</span></code></a>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>


<h2 id="foreign-key">foreign_key<a class="headerlink" href="#foreign-key" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="sqlalchemy_unchained.foreign_key">
<code class="sig-prename descclassname">sqlalchemy_unchained.</code><code class="sig-name descname">foreign_key</code><span class="sig-paren">(</span><em class="sig-param">*args</em>, <em class="sig-param">fk_col: Optional[str] = None</em>, <em class="sig-param">primary_key: bool = False</em>, <em class="sig-param">nullable: bool = False</em>, <em class="sig-param">ondelete: Optional[str] = None</em>, <em class="sig-param">onupdate: Optional[str] = None</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span> → sqlalchemy.sql.schema.Column<a class="reference internal" href="_modules/sqlalchemy_unchained/foreign_key.html#foreign_key"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sqlalchemy_unchained.foreign_key" title="Permalink to this definition">¶</a></dt>
<dd><p>Helper method to add a foreign key column to a model.</p>
<p>For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Post</span><span class="p">(</span><span class="n">db</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">category_id</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">foreign_key</span><span class="p">(</span><span class="s1">'Category'</span><span class="p">)</span>
    <span class="n">category</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">relationship</span><span class="p">(</span><span class="s1">'Category'</span><span class="p">,</span> <span class="n">back_populates</span><span class="o">=</span><span class="s1">'posts'</span><span class="p">)</span>
</pre></div>
</div>
<p>Is equivalent to:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Post</span><span class="p">(</span><span class="n">db</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">category_id</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">Column</span><span class="p">(</span><span class="n">db</span><span class="o">.</span><span class="n">Integer</span><span class="p">,</span> <span class="n">db</span><span class="o">.</span><span class="n">ForeignKey</span><span class="p">(</span><span class="s1">'category.id'</span><span class="p">),</span>
                            <span class="n">nullable</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">category</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">relationship</span><span class="p">(</span><span class="s1">'Category'</span><span class="p">,</span> <span class="n">back_populates</span><span class="o">=</span><span class="s1">'posts'</span><span class="p">)</span>
</pre></div>
</div>
<p>Customizing all the things:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Post</span><span class="p">(</span><span class="n">db</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">_category_id</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">foreign_key</span><span class="p">(</span><span class="s1">'category_id'</span><span class="p">,</span>  <span class="c1"># db column name</span>
                                  <span class="n">db</span><span class="o">.</span><span class="n">String</span><span class="p">,</span>      <span class="c1"># db column type</span>
                                  <span class="s1">'categories'</span><span class="p">,</span>   <span class="c1"># foreign table name</span>
                                  <span class="n">fk_col</span><span class="o">=</span><span class="s1">'pk'</span><span class="p">)</span>    <span class="c1"># foreign key col name</span>
</pre></div>
</div>
<p>Would be equivalent to:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Post</span><span class="p">(</span><span class="n">db</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">_category_id</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">Column</span><span class="p">(</span><span class="s1">'category_id'</span><span class="p">,</span> <span class="n">db</span><span class="o">.</span><span class="n">String</span><span class="p">,</span>
                             <span class="n">db</span><span class="o">.</span><span class="n">ForeignKey</span><span class="p">(</span><span class="s1">'categories.pk'</span><span class="p">))</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>args</strong> – <a class="reference internal" href="#sqlalchemy_unchained.foreign_key" title="sqlalchemy_unchained.foreign_key"><code class="xref py py-func docutils literal notranslate"><span class="pre">foreign_key()</span></code></a> takes up to three positional arguments.</p>
</dd>
</dl>
<p>Most commonly, you will only pass one argument, which should be the table
name you’re linking to (or indirectly, the model class/name works too).
If you want to customize the column name the foreign key gets stored in
the database under, then it must be the first string argument, and you must
<em>also</em> supply the table name. You can customize the column type that gets
used by passing it too, eg <code class="docutils literal notranslate"><span class="pre">sa.Integer</span></code> or <code class="docutils literal notranslate"><span class="pre">sa.String(36)</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fk_col</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a>) – The column name of the primary key on the <em>opposite</em> side
of the relationship (defaults to
<code class="xref py py-attr docutils literal notranslate"><span class="pre">sqlalchemy_unchained._ModelRegistry.default_primary_key_column</span></code>).</p></li>
<li><p><strong>primary_key</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a>) – Whether or not this <code class="xref py py-class docutils literal notranslate"><span class="pre">Column</span></code> is
a primary key.</p></li>
<li><p><strong>nullable</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a>) – Whether or not this <code class="xref py py-class docutils literal notranslate"><span class="pre">Column</span></code> should
be nullable.</p></li>
<li><p><strong>ondelete</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a>) – The cascade operation for <cite>ON DELETE</cite>.</p></li>
<li><p><strong>onupdate</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a>) – The cascade operation for <cite>ON UPDATE</cite>.</p></li>
<li><p><strong>kwargs</strong> – Any other kwargs to pass the <code class="xref py py-class docutils literal notranslate"><span class="pre">Column</span></code>
constructor.</p></li>
</ul>
</dd>
</dl>
</dd></dl>


<h2 id="basemodel">BaseModel<a class="headerlink" href="#basemodel" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="sqlalchemy_unchained.BaseModel">
<em class="property">class </em><code class="sig-prename descclassname">sqlalchemy_unchained.</code><code class="sig-name descname">BaseModel</code><span class="sig-paren">(</span><em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sqlalchemy_unchained/base_model.html#BaseModel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sqlalchemy_unchained.BaseModel" title="Permalink to this definition">¶</a></dt>
<dd><p>Base model class for SQLAlchemy declarative base model.</p>
<dl class="method">
<dt id="sqlalchemy_unchained.BaseModel.update">
<code class="sig-name descname">update</code><span class="sig-paren">(</span><em class="sig-param">partial_validation=True</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sqlalchemy_unchained/base_model.html#BaseModel.update"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sqlalchemy_unchained.BaseModel.update" title="Permalink to this definition">¶</a></dt>
<dd><p>Update fields on the model.</p>
</dd></dl>
<dl class="method">
<dt id="sqlalchemy_unchained.BaseModel.validate">
<code class="sig-name descname">validate</code><span class="sig-paren">(</span><em class="sig-param">partial=False</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sqlalchemy_unchained/base_model.html#BaseModel.validate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sqlalchemy_unchained.BaseModel.validate" title="Permalink to this definition">¶</a></dt>
<dd><p>Validate kwargs before setting attributes on the model</p>
</dd></dl>
</dd></dl>


<h2 id="declarativemeta">DeclarativeMeta<a class="headerlink" href="#declarativemeta" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="sqlalchemy_unchained.DeclarativeMeta">
<em class="property">class </em><code class="sig-prename descclassname">sqlalchemy_unchained.</code><code class="sig-name descname">DeclarativeMeta</code><span class="sig-paren">(</span><em class="sig-param">name</em>, <em class="sig-param">bases</em>, <em class="sig-param">clsdict</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sqlalchemy_unchained/base_model_metaclass.html#DeclarativeMeta"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sqlalchemy_unchained.DeclarativeMeta" title="Permalink to this definition">¶</a></dt>
<dd><p>Base metaclass for models in SQLAlchemy Unchained. Sets up support for using
Meta options on models, automatically sets <code class="docutils literal notranslate"><span class="pre">__tablename__</span></code> if necessary,
and configures validation for concrete models.</p>
</dd></dl>


<h2 id="basequery">BaseQuery<a class="headerlink" href="#basequery" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="sqlalchemy_unchained.BaseQuery">
<em class="property">class </em><code class="sig-prename descclassname">sqlalchemy_unchained.</code><code class="sig-name descname">BaseQuery</code><span class="sig-paren">(</span><em class="sig-param">entities</em>, <em class="sig-param">session=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sqlalchemy_unchained/base_query.html#BaseQuery"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sqlalchemy_unchained.BaseQuery" title="Permalink to this definition">¶</a></dt>
<dd><p>Base class to use for the <a class="reference internal" href="#sqlalchemy_unchained.ModelManager.query" title="sqlalchemy_unchained.ModelManager.query"><code class="xref py py-attr docutils literal notranslate"><span class="pre">query</span></code></a>
attribute on model managers.</p>
<dl class="method">
<dt id="sqlalchemy_unchained.BaseQuery.add_column">
<code class="sig-name descname">add_column</code><span class="sig-paren">(</span><em class="sig-param">column</em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy_unchained.BaseQuery.add_column" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a column expression to the list of result columns to be
returned.</p>
<p>Pending deprecation: <a class="reference internal" href="#sqlalchemy_unchained.BaseQuery.add_column" title="sqlalchemy_unchained.BaseQuery.add_column"><code class="xref py py-meth docutils literal notranslate"><span class="pre">add_column()</span></code></a> will be superseded by
<a class="reference internal" href="#sqlalchemy_unchained.BaseQuery.add_columns" title="sqlalchemy_unchained.BaseQuery.add_columns"><code class="xref py py-meth docutils literal notranslate"><span class="pre">add_columns()</span></code></a>.</p>
</dd></dl>
<dl class="method">
<dt id="sqlalchemy_unchained.BaseQuery.add_columns">
<code class="sig-name descname">add_columns</code><span class="sig-paren">(</span><em class="sig-param">*column</em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy_unchained.BaseQuery.add_columns" title="Permalink to this definition">¶</a></dt>
<dd><p>Add one or more column expressions to the list
of result columns to be returned.</p>
</dd></dl>
<dl class="method">
<dt id="sqlalchemy_unchained.BaseQuery.add_entity">
<code class="sig-name descname">add_entity</code><span class="sig-paren">(</span><em class="sig-param">entity</em>, <em class="sig-param">alias=None</em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy_unchained.BaseQuery.add_entity" title="Permalink to this definition">¶</a></dt>
<dd><p>add a mapped entity to the list of result columns
to be returned.</p>
</dd></dl>
<dl class="method">
<dt id="sqlalchemy_unchained.BaseQuery.all">
<code class="sig-name descname">all</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy_unchained.BaseQuery.all" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the results represented by this <code class="xref py py-class docutils literal notranslate"><span class="pre">Query</span></code> as a list.</p>
<p>This results in an execution of the underlying SQL statement.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The <code class="xref py py-class docutils literal notranslate"><span class="pre">Query</span></code> object, when asked to return either
a sequence or iterator that consists of full ORM-mapped entities,
will <strong>deduplicate entries based on primary key</strong>.  See the FAQ for
more details.</p>
<blockquote>
<div><div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference external" href="https://docs.sqlalchemy.org/en/13/faq/sessions.html#faq-query-deduplicating" title="(in SQLAlchemy v1.3)"><span>My Query does not return the same number of objects as query.count() tells me - why?</span></a></p>
</div>
</div></blockquote>
</div>
</dd></dl>
<dl class="method">
<dt id="sqlalchemy_unchained.BaseQuery.as_scalar">
<code class="sig-name descname">as_scalar</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy_unchained.BaseQuery.as_scalar" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the full SELECT statement represented by this
<code class="xref py py-class docutils literal notranslate"><span class="pre">Query</span></code>, converted to a scalar subquery.</p>
<p>Analogous to <a class="reference external" href="https://docs.sqlalchemy.org/en/13/core/selectable.html#sqlalchemy.sql.expression.SelectBase.as_scalar" title="(in SQLAlchemy v1.3)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">sqlalchemy.sql.expression.SelectBase.as_scalar()</span></code></a>.</p>
</dd></dl>
<dl class="method">
<dt id="sqlalchemy_unchained.BaseQuery.autoflush">
<code class="sig-name descname">autoflush</code><span class="sig-paren">(</span><em class="sig-param">setting</em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy_unchained.BaseQuery.autoflush" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a Query with a specific ‘autoflush’ setting.</p>
<p>Note that a Session with autoflush=False will
not autoflush, even if this flag is set to True at the
Query level.  Therefore this flag is usually used only
to disable autoflush for a specific Query.</p>
</dd></dl>
<dl class="method">
<dt id="sqlalchemy_unchained.BaseQuery.column_descriptions">
<em class="property">property </em><code class="sig-name descname">column_descriptions</code><a class="headerlink" href="#sqlalchemy_unchained.BaseQuery.column_descriptions" title="Permalink to this definition">¶</a></dt>
<dd><p>Return metadata about the columns which would be
returned by this <code class="xref py py-class docutils literal notranslate"><span class="pre">Query</span></code>.</p>
<p>Format is a list of dictionaries:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">user_alias</span> <span class="o">=</span> <span class="n">aliased</span><span class="p">(</span><span class="n">User</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">'user2'</span><span class="p">)</span>
<span class="n">q</span> <span class="o">=</span> <span class="n">sess</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">User</span><span class="p">,</span> <span class="n">User</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">user_alias</span><span class="p">)</span>

<span class="c1"># this expression:</span>
<span class="n">q</span><span class="o">.</span><span class="n">column_descriptions</span>

<span class="c1"># would return:</span>
<span class="p">[</span>
    <span class="p">{</span>
        <span class="s1">'name'</span><span class="p">:</span><span class="s1">'User'</span><span class="p">,</span>
        <span class="s1">'type'</span><span class="p">:</span><span class="n">User</span><span class="p">,</span>
        <span class="s1">'aliased'</span><span class="p">:</span><span class="kc">False</span><span class="p">,</span>
        <span class="s1">'expr'</span><span class="p">:</span><span class="n">User</span><span class="p">,</span>
        <span class="s1">'entity'</span><span class="p">:</span> <span class="n">User</span>
    <span class="p">},</span>
    <span class="p">{</span>
        <span class="s1">'name'</span><span class="p">:</span><span class="s1">'id'</span><span class="p">,</span>
        <span class="s1">'type'</span><span class="p">:</span><span class="n">Integer</span><span class="p">(),</span>
        <span class="s1">'aliased'</span><span class="p">:</span><span class="kc">False</span><span class="p">,</span>
        <span class="s1">'expr'</span><span class="p">:</span><span class="n">User</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
        <span class="s1">'entity'</span><span class="p">:</span> <span class="n">User</span>
    <span class="p">},</span>
    <span class="p">{</span>
        <span class="s1">'name'</span><span class="p">:</span><span class="s1">'user2'</span><span class="p">,</span>
        <span class="s1">'type'</span><span class="p">:</span><span class="n">User</span><span class="p">,</span>
        <span class="s1">'aliased'</span><span class="p">:</span><span class="kc">True</span><span class="p">,</span>
        <span class="s1">'expr'</span><span class="p">:</span><span class="n">user_alias</span><span class="p">,</span>
        <span class="s1">'entity'</span><span class="p">:</span> <span class="n">user_alias</span>
    <span class="p">}</span>
<span class="p">]</span>
</pre></div>
</div>
</dd></dl>
<dl class="method">
<dt id="sqlalchemy_unchained.BaseQuery.correlate">
<code class="sig-name descname">correlate</code><span class="sig-paren">(</span><em class="sig-param">*args</em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy_unchained.BaseQuery.correlate" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a <code class="xref py py-class docutils literal notranslate"><span class="pre">Query</span></code> construct which will correlate the given
FROM clauses to that of an enclosing <code class="xref py py-class docutils literal notranslate"><span class="pre">Query</span></code> or
<code class="xref py py-func docutils literal notranslate"><span class="pre">select()</span></code>.</p>
<p>The method here accepts mapped classes, <code class="xref py py-func docutils literal notranslate"><span class="pre">aliased()</span></code> constructs,
and <code class="xref py py-func docutils literal notranslate"><span class="pre">mapper()</span></code> constructs as arguments, which are resolved into
expression constructs, in addition to appropriate expression
constructs.</p>
<p>The correlation arguments are ultimately passed to
<code class="xref py py-meth docutils literal notranslate"><span class="pre">Select.correlate()</span></code> after coercion to expression constructs.</p>
<p>The correlation arguments take effect in such cases
as when <code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.from_self()</span></code> is used, or when
a subquery as returned by <code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.subquery()</span></code> is
embedded in another <code class="xref py py-func docutils literal notranslate"><span class="pre">select()</span></code> construct.</p>
</dd></dl>
<dl class="method">
<dt id="sqlalchemy_unchained.BaseQuery.count">
<code class="sig-name descname">count</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy_unchained.BaseQuery.count" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a count of rows this the SQL formed by this <code class="xref py py-class docutils literal notranslate"><span class="pre">Query</span></code>
would return.</p>
<p>This generates the SQL for this Query as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SELECT</span> <span class="n">count</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="n">AS</span> <span class="n">count_1</span> <span class="n">FROM</span> <span class="p">(</span>
    <span class="n">SELECT</span> <span class="o">&lt;</span><span class="n">rest</span> <span class="n">of</span> <span class="n">query</span> <span class="n">follows</span><span class="o">...&gt;</span>
<span class="p">)</span> <span class="n">AS</span> <span class="n">anon_1</span>
</pre></div>
</div>
<p>The above SQL returns a single row, which is the aggregate value
of the count function; the <code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.count()</span></code> method then returns
that single integer value.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>It is important to note that the value returned by
count() is <strong>not the same as the number of ORM objects that this
Query would return from a method such as the .all() method</strong>.
The <code class="xref py py-class docutils literal notranslate"><span class="pre">Query</span></code> object, when asked to return full entities,
will <strong>deduplicate entries based on primary key</strong>, meaning if the
same primary key value would appear in the results more than once,
only one object of that primary key would be present.  This does
not apply to a query that is against individual columns.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference external" href="https://docs.sqlalchemy.org/en/13/faq/sessions.html#faq-query-deduplicating" title="(in SQLAlchemy v1.3)"><span>My Query does not return the same number of objects as query.count() tells me - why?</span></a></p>
<p><a class="reference external" href="https://docs.sqlalchemy.org/en/13/orm/tutorial.html#orm-tutorial-query-returning" title="(in SQLAlchemy v1.3)"><span>Returning Lists and Scalars</span></a></p>
</div>
</div>
<p>For fine grained control over specific columns to count, to skip the
usage of a subquery or otherwise control of the FROM clause, or to use
other aggregate functions, use <code class="xref py py-attr docutils literal notranslate"><span class="pre">func</span></code>
expressions in conjunction with <code class="xref py py-meth docutils literal notranslate"><span class="pre">query()</span></code>, i.e.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="k">import</span> <span class="n">func</span>

<span class="c1"># count User records, without</span>
<span class="c1"># using a subquery.</span>
<span class="n">session</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">func</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">User</span><span class="o">.</span><span class="n">id</span><span class="p">))</span>

<span class="c1"># return count of user "id" grouped</span>
<span class="c1"># by "name"</span>
<span class="n">session</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">func</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">User</span><span class="o">.</span><span class="n">id</span><span class="p">))</span><span class="o">.</span>\
        <span class="n">group_by</span><span class="p">(</span><span class="n">User</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>

<span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="k">import</span> <span class="n">distinct</span>

<span class="c1"># count distinct "name" values</span>
<span class="n">session</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">func</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">distinct</span><span class="p">(</span><span class="n">User</span><span class="o">.</span><span class="n">name</span><span class="p">)))</span>
</pre></div>
</div>
</dd></dl>
<dl class="method">
<dt id="sqlalchemy_unchained.BaseQuery.cte">
<code class="sig-name descname">cte</code><span class="sig-paren">(</span><em class="sig-param">name=None</em>, <em class="sig-param">recursive=False</em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy_unchained.BaseQuery.cte" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the full SELECT statement represented by this
<code class="xref py py-class docutils literal notranslate"><span class="pre">Query</span></code> represented as a common table expression (CTE).</p>
<p>Parameters and usage are the same as those of the
<code class="xref py py-meth docutils literal notranslate"><span class="pre">SelectBase.cte()</span></code> method; see that method for
further details.</p>
<p>Here is the <a class="reference external" href="http://www.postgresql.org/docs/8.4/static/queries-with.html">PostgreSQL WITH
RECURSIVE example</a>.
Note that, in this example, the <code class="docutils literal notranslate"><span class="pre">included_parts</span></code> cte and the
<code class="docutils literal notranslate"><span class="pre">incl_alias</span></code> alias of it are Core selectables, which
means the columns are accessed via the <code class="docutils literal notranslate"><span class="pre">.c.</span></code> attribute.  The
<code class="docutils literal notranslate"><span class="pre">parts_alias</span></code> object is an <code class="xref py py-func docutils literal notranslate"><span class="pre">orm.aliased()</span></code> instance of the
<code class="docutils literal notranslate"><span class="pre">Part</span></code> entity, so column-mapped attributes are available
directly:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sqlalchemy.orm</span> <span class="k">import</span> <span class="n">aliased</span>

<span class="k">class</span> <span class="nc">Part</span><span class="p">(</span><span class="n">Base</span><span class="p">):</span>
    <span class="n">__tablename__</span> <span class="o">=</span> <span class="s1">'part'</span>
    <span class="n">part</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">String</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">sub_part</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">String</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">quantity</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">Integer</span><span class="p">)</span>

<span class="n">included_parts</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">query</span><span class="p">(</span>
                <span class="n">Part</span><span class="o">.</span><span class="n">sub_part</span><span class="p">,</span>
                <span class="n">Part</span><span class="o">.</span><span class="n">part</span><span class="p">,</span>
                <span class="n">Part</span><span class="o">.</span><span class="n">quantity</span><span class="p">)</span><span class="o">.</span>\
                    <span class="nb">filter</span><span class="p">(</span><span class="n">Part</span><span class="o">.</span><span class="n">part</span><span class="o">==</span><span class="s2">"our part"</span><span class="p">)</span><span class="o">.</span>\
                    <span class="n">cte</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">"included_parts"</span><span class="p">,</span> <span class="n">recursive</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">incl_alias</span> <span class="o">=</span> <span class="n">aliased</span><span class="p">(</span><span class="n">included_parts</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">"pr"</span><span class="p">)</span>
<span class="n">parts_alias</span> <span class="o">=</span> <span class="n">aliased</span><span class="p">(</span><span class="n">Part</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">"p"</span><span class="p">)</span>
<span class="n">included_parts</span> <span class="o">=</span> <span class="n">included_parts</span><span class="o">.</span><span class="n">union_all</span><span class="p">(</span>
    <span class="n">session</span><span class="o">.</span><span class="n">query</span><span class="p">(</span>
        <span class="n">parts_alias</span><span class="o">.</span><span class="n">sub_part</span><span class="p">,</span>
        <span class="n">parts_alias</span><span class="o">.</span><span class="n">part</span><span class="p">,</span>
        <span class="n">parts_alias</span><span class="o">.</span><span class="n">quantity</span><span class="p">)</span><span class="o">.</span>\
            <span class="nb">filter</span><span class="p">(</span><span class="n">parts_alias</span><span class="o">.</span><span class="n">part</span><span class="o">==</span><span class="n">incl_alias</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">sub_part</span><span class="p">)</span>
    <span class="p">)</span>

<span class="n">q</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">query</span><span class="p">(</span>
        <span class="n">included_parts</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">sub_part</span><span class="p">,</span>
        <span class="n">func</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">included_parts</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">quantity</span><span class="p">)</span><span class="o">.</span>
            <span class="n">label</span><span class="p">(</span><span class="s1">'total_quantity'</span><span class="p">)</span>
    <span class="p">)</span><span class="o">.</span>\
    <span class="n">group_by</span><span class="p">(</span><span class="n">included_parts</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">sub_part</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><code class="xref py py-meth docutils literal notranslate"><span class="pre">HasCTE.cte()</span></code></p>
</div>
</dd></dl>
<dl class="method">
<dt id="sqlalchemy_unchained.BaseQuery.delete">
<code class="sig-name descname">delete</code><span class="sig-paren">(</span><em class="sig-param">synchronize_session='evaluate'</em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy_unchained.BaseQuery.delete" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform a bulk delete query.</p>
<p>Deletes rows matched by this query from the database.</p>
<p>E.g.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sess</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">User</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">User</span><span class="o">.</span><span class="n">age</span> <span class="o">==</span> <span class="mi">25</span><span class="p">)</span><span class="o">.</span>\
    <span class="n">delete</span><span class="p">(</span><span class="n">synchronize_session</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="n">sess</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">User</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">User</span><span class="o">.</span><span class="n">age</span> <span class="o">==</span> <span class="mi">25</span><span class="p">)</span><span class="o">.</span>\
    <span class="n">delete</span><span class="p">(</span><span class="n">synchronize_session</span><span class="o">=</span><span class="s1">'evaluate'</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The <code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.delete()</span></code> method is a “bulk” operation,
which bypasses ORM unit-of-work automation in favor of greater
performance.  <strong>Please read all caveats and warnings below.</strong></p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>synchronize_session</strong> – <p>chooses the strategy for the removal of
matched objects from the session. Valid values are:</p>
<p><code class="docutils literal notranslate"><span class="pre">False</span></code> - don’t synchronize the session. This option is the most
efficient and is reliable once the session is expired, which
typically occurs after a commit(), or explicitly using
expire_all(). Before the expiration, objects may still remain in
the session which were in fact deleted which can lead to confusing
results if they are accessed via get() or already loaded
collections.</p>
<p><code class="docutils literal notranslate"><span class="pre">'fetch'</span></code> - performs a select query before the delete to find
objects that are matched by the delete query and need to be
removed from the session. Matched objects are removed from the
session.</p>
<p><code class="docutils literal notranslate"><span class="pre">'evaluate'</span></code> - Evaluate the query’s criteria in Python straight
on the objects in the session. If evaluation of the criteria isn’t
implemented, an error is raised.</p>
<p>The expression evaluator currently doesn’t account for differing
string collations between the database and Python.</p>
</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the count of rows matched as returned by the database’s
“row count” feature.</p>
</dd>
</dl>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p><strong>Additional Caveats for bulk query deletes</strong></p>
<ul>
<li><p>This method does <strong>not work for joined
inheritance mappings</strong>, since the <strong>multiple table
deletes are not supported by SQL</strong> as well as that the
<strong>join condition of an inheritance mapper is not
automatically rendered</strong>.  Care must be taken in any
multiple-table delete to first accommodate via some other means
how the related table will be deleted, as well as to
explicitly include the joining
condition between those tables, even in mappings where
this is normally automatic. E.g. if a class <code class="docutils literal notranslate"><span class="pre">Engineer</span></code>
subclasses <code class="docutils literal notranslate"><span class="pre">Employee</span></code>, a DELETE against the <code class="docutils literal notranslate"><span class="pre">Employee</span></code>
table would look like:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">session</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">Engineer</span><span class="p">)</span><span class="o">.</span>\
    <span class="nb">filter</span><span class="p">(</span><span class="n">Engineer</span><span class="o">.</span><span class="n">id</span> <span class="o">==</span> <span class="n">Employee</span><span class="o">.</span><span class="n">id</span><span class="p">)</span><span class="o">.</span>\
    <span class="nb">filter</span><span class="p">(</span><span class="n">Employee</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">'dilbert'</span><span class="p">)</span><span class="o">.</span>\
    <span class="n">delete</span><span class="p">()</span>
</pre></div>
</div>
<p>However the above SQL will not delete from the Engineer table,
unless an ON DELETE CASCADE rule is established in the database
to handle it.</p>
<p>Short story, <strong>do not use this method for joined inheritance
mappings unless you have taken the additional steps to make
this feasible</strong>.</p>
</li>
<li><p>The polymorphic identity WHERE criteria is <strong>not</strong> included
for single- or
joined- table updates - this must be added <strong>manually</strong> even
for single table inheritance.</p></li>
<li><p>The method does <strong>not</strong> offer in-Python cascading of
relationships - it is assumed that ON DELETE CASCADE/SET
NULL/etc. is configured for any foreign key references
which require it, otherwise the database may emit an
integrity violation if foreign key references are being
enforced.</p>
<p>After the DELETE, dependent objects in the
<code class="xref py py-class docutils literal notranslate"><span class="pre">Session</span></code> which were impacted by an ON DELETE
may not contain the current state, or may have been
deleted. This issue is resolved once the
<code class="xref py py-class docutils literal notranslate"><span class="pre">Session</span></code> is expired, which normally occurs upon
<code class="xref py py-meth docutils literal notranslate"><span class="pre">Session.commit()</span></code> or can be forced by using
<code class="xref py py-meth docutils literal notranslate"><span class="pre">Session.expire_all()</span></code>.  Accessing an expired
object whose row has been deleted will invoke a SELECT
to locate the row; when the row is not found, an
<a class="reference external" href="https://docs.sqlalchemy.org/en/13/orm/exceptions.html#sqlalchemy.orm.exc.ObjectDeletedError" title="(in SQLAlchemy v1.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ObjectDeletedError</span></code></a> is
raised.</p>
</li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">'fetch'</span></code> strategy results in an additional
SELECT statement emitted and will significantly reduce
performance.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">'evaluate'</span></code> strategy performs a scan of
all matching objects within the <code class="xref py py-class docutils literal notranslate"><span class="pre">Session</span></code>; if the
contents of the <code class="xref py py-class docutils literal notranslate"><span class="pre">Session</span></code> are expired, such as
via a proceeding <code class="xref py py-meth docutils literal notranslate"><span class="pre">Session.commit()</span></code> call, <strong>this will
result in SELECT queries emitted for every matching object</strong>.</p></li>
<li><p>The <code class="xref py py-meth docutils literal notranslate"><span class="pre">MapperEvents.before_delete()</span></code> and
<code class="xref py py-meth docutils literal notranslate"><span class="pre">MapperEvents.after_delete()</span></code>
events <strong>are not invoked</strong> from this method.  Instead, the
<code class="xref py py-meth docutils literal notranslate"><span class="pre">SessionEvents.after_bulk_delete()</span></code> method is provided to
act upon a mass DELETE of entity rows.</p></li>
</ul>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.update()</span></code></p>
<p><a class="reference external" href="https://docs.sqlalchemy.org/en/13/core/tutorial.html#inserts-and-updates" title="(in SQLAlchemy v1.3)"><span>Inserts, Updates and Deletes</span></a> - Core SQL tutorial</p>
</div>
</dd></dl>
<dl class="method">
<dt id="sqlalchemy_unchained.BaseQuery.distinct">
<code class="sig-name descname">distinct</code><span class="sig-paren">(</span><em class="sig-param">*expr</em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy_unchained.BaseQuery.distinct" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply a <code class="docutils literal notranslate"><span class="pre">DISTINCT</span></code> to the query and return the newly resulting
<code class="docutils literal notranslate"><span class="pre">Query</span></code>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <a class="reference internal" href="#sqlalchemy_unchained.BaseQuery.distinct" title="sqlalchemy_unchained.BaseQuery.distinct"><code class="xref py py-meth docutils literal notranslate"><span class="pre">distinct()</span></code></a> call includes logic that will automatically
add columns from the ORDER BY of the query to the columns
clause of the SELECT statement, to satisfy the common need
of the database backend that ORDER BY columns be part of the
SELECT list when DISTINCT is used.   These columns <em>are not</em>
added to the list of columns actually fetched by the
<code class="xref py py-class docutils literal notranslate"><span class="pre">Query</span></code>, however, so would not affect results.
The columns are passed through when using the
<code class="xref py py-attr docutils literal notranslate"><span class="pre">Query.statement</span></code> accessor, however.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>*expr</strong> – optional column expressions.  When present,
the PostgreSQL dialect will render a <code class="docutils literal notranslate"><span class="pre">DISTINCT</span> <span class="pre">ON</span> <span class="pre">(&lt;expressions&gt;)</span></code>
construct.</p>
</dd>
</dl>
</dd></dl>
<dl class="method">
<dt id="sqlalchemy_unchained.BaseQuery.enable_assertions">
<code class="sig-name descname">enable_assertions</code><span class="sig-paren">(</span><em class="sig-param">value</em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy_unchained.BaseQuery.enable_assertions" title="Permalink to this definition">¶</a></dt>
<dd><p>Control whether assertions are generated.</p>
<p>When set to False, the returned Query will
not assert its state before certain operations,
including that LIMIT/OFFSET has not been applied
when filter() is called, no criterion exists
when get() is called, and no “from_statement()”
exists when filter()/order_by()/group_by() etc.
is called.  This more permissive mode is used by
custom Query subclasses to specify criterion or
other modifiers outside of the usual usage patterns.</p>
<p>Care should be taken to ensure that the usage
pattern is even possible.  A statement applied
by from_statement() will override any criterion
set by filter() or order_by(), for example.</p>
</dd></dl>
<dl class="method">
<dt id="sqlalchemy_unchained.BaseQuery.enable_eagerloads">
<code class="sig-name descname">enable_eagerloads</code><span class="sig-paren">(</span><em class="sig-param">value</em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy_unchained.BaseQuery.enable_eagerloads" title="Permalink to this definition">¶</a></dt>
<dd><p>Control whether or not eager joins and subqueries are
rendered.</p>
<p>When set to False, the returned Query will not render
eager joins regardless of <a class="reference external" href="https://docs.sqlalchemy.org/en/13/orm/loading_relationships.html#sqlalchemy.orm.joinedload" title="(in SQLAlchemy v1.3)"><code class="xref py py-func docutils literal notranslate"><span class="pre">joinedload()</span></code></a>,
<a class="reference external" href="https://docs.sqlalchemy.org/en/13/orm/loading_relationships.html#sqlalchemy.orm.subqueryload" title="(in SQLAlchemy v1.3)"><code class="xref py py-func docutils literal notranslate"><span class="pre">subqueryload()</span></code></a> options
or mapper-level <code class="docutils literal notranslate"><span class="pre">lazy='joined'</span></code>/<code class="docutils literal notranslate"><span class="pre">lazy='subquery'</span></code>
configurations.</p>
<p>This is used primarily when nesting the Query’s
statement into a subquery or other
selectable, or when using <code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.yield_per()</span></code>.</p>
</dd></dl>
<dl class="method">
<dt id="sqlalchemy_unchained.BaseQuery.except_">
<code class="sig-name descname">except_</code><span class="sig-paren">(</span><em class="sig-param">*q</em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy_unchained.BaseQuery.except_" title="Permalink to this definition">¶</a></dt>
<dd><p>Produce an EXCEPT of this Query against one or more queries.</p>
<p>Works the same way as <a class="reference external" href="https://docs.sqlalchemy.org/en/13/orm/query.html#sqlalchemy.orm.query.Query.union" title="(in SQLAlchemy v1.3)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">union()</span></code></a>. See
that method for usage examples.</p>
</dd></dl>
<dl class="method">
<dt id="sqlalchemy_unchained.BaseQuery.except_all">
<code class="sig-name descname">except_all</code><span class="sig-paren">(</span><em class="sig-param">*q</em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy_unchained.BaseQuery.except_all" title="Permalink to this definition">¶</a></dt>
<dd><p>Produce an EXCEPT ALL of this Query against one or more queries.</p>
<p>Works the same way as <a class="reference external" href="https://docs.sqlalchemy.org/en/13/orm/query.html#sqlalchemy.orm.query.Query.union" title="(in SQLAlchemy v1.3)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">union()</span></code></a>. See
that method for usage examples.</p>
</dd></dl>
<dl class="method">
<dt id="sqlalchemy_unchained.BaseQuery.execution_options">
<code class="sig-name descname">execution_options</code><span class="sig-paren">(</span><em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy_unchained.BaseQuery.execution_options" title="Permalink to this definition">¶</a></dt>
<dd><p>Set non-SQL options which take effect during execution.</p>
<p>The options are the same as those accepted by
<code class="xref py py-meth docutils literal notranslate"><span class="pre">Connection.execution_options()</span></code>.</p>
<p>Note that the <code class="docutils literal notranslate"><span class="pre">stream_results</span></code> execution option is enabled
automatically if the <a class="reference external" href="https://docs.sqlalchemy.org/en/13/orm/query.html#sqlalchemy.orm.query.Query.yield_per" title="(in SQLAlchemy v1.3)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">yield_per()</span></code></a>
method is used.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.get_execution_options()</span></code></p>
</div>
</dd></dl>
<dl class="method">
<dt id="sqlalchemy_unchained.BaseQuery.exists">
<code class="sig-name descname">exists</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy_unchained.BaseQuery.exists" title="Permalink to this definition">¶</a></dt>
<dd><p>A convenience method that turns a query into an EXISTS subquery
of the form EXISTS (SELECT 1 FROM … WHERE …).</p>
<p>e.g.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">q</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">User</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">User</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">'fred'</span><span class="p">)</span>
<span class="n">session</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">q</span><span class="o">.</span><span class="n">exists</span><span class="p">())</span>
</pre></div>
</div>
<p>Producing SQL similar to:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SELECT</span> <span class="n">EXISTS</span> <span class="p">(</span>
    <span class="n">SELECT</span> <span class="mi">1</span> <span class="n">FROM</span> <span class="n">users</span> <span class="n">WHERE</span> <span class="n">users</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="p">:</span><span class="n">name_1</span>
<span class="p">)</span> <span class="n">AS</span> <span class="n">anon_1</span>
</pre></div>
</div>
<p>The EXISTS construct is usually used in the WHERE clause:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">session</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">User</span><span class="o">.</span><span class="n">id</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">q</span><span class="o">.</span><span class="n">exists</span><span class="p">())</span><span class="o">.</span><span class="n">scalar</span><span class="p">()</span>
</pre></div>
</div>
<p>Note that some databases such as SQL Server don’t allow an
EXISTS expression to be present in the columns clause of a
SELECT.    To select a simple boolean value based on the exists
as a WHERE, use <code class="xref py py-func docutils literal notranslate"><span class="pre">literal()</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="k">import</span> <span class="n">literal</span>

<span class="n">session</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">literal</span><span class="p">(</span><span class="kc">True</span><span class="p">))</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">q</span><span class="o">.</span><span class="n">exists</span><span class="p">())</span><span class="o">.</span><span class="n">scalar</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>
<dl class="method">
<dt id="sqlalchemy_unchained.BaseQuery.filter">
<code class="sig-name descname">filter</code><span class="sig-paren">(</span><em class="sig-param">*criterion</em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy_unchained.BaseQuery.filter" title="Permalink to this definition">¶</a></dt>
<dd><p>apply the given filtering criterion to a copy
of this <code class="xref py py-class docutils literal notranslate"><span class="pre">Query</span></code>, using SQL expressions.</p>
<p>e.g.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">session</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">MyClass</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">MyClass</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">'some name'</span><span class="p">)</span>
</pre></div>
</div>
<p>Multiple criteria may be specified as comma separated; the effect
is that they will be joined together using the <code class="xref py py-func docutils literal notranslate"><span class="pre">and_()</span></code>
function:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">session</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">MyClass</span><span class="p">)</span><span class="o">.</span>\
    <span class="nb">filter</span><span class="p">(</span><span class="n">MyClass</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">'some name'</span><span class="p">,</span> <span class="n">MyClass</span><span class="o">.</span><span class="n">id</span> <span class="o">&gt;</span> <span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
<p>The criterion is any SQL expression object applicable to the
WHERE clause of a select.   String expressions are coerced
into SQL expression constructs via the <code class="xref py py-func docutils literal notranslate"><span class="pre">text()</span></code> construct.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.filter_by()</span></code> - filter on keyword expressions.</p>
</div>
</dd></dl>
<dl class="method">
<dt id="sqlalchemy_unchained.BaseQuery.filter_by">
<code class="sig-name descname">filter_by</code><span class="sig-paren">(</span><em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy_unchained.BaseQuery.filter_by" title="Permalink to this definition">¶</a></dt>
<dd><p>apply the given filtering criterion to a copy
of this <code class="xref py py-class docutils literal notranslate"><span class="pre">Query</span></code>, using keyword expressions.</p>
<p>e.g.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">session</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">MyClass</span><span class="p">)</span><span class="o">.</span><span class="n">filter_by</span><span class="p">(</span><span class="n">name</span> <span class="o">=</span> <span class="s1">'some name'</span><span class="p">)</span>
</pre></div>
</div>
<p>Multiple criteria may be specified as comma separated; the effect
is that they will be joined together using the <code class="xref py py-func docutils literal notranslate"><span class="pre">and_()</span></code>
function:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">session</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">MyClass</span><span class="p">)</span><span class="o">.</span>\
    <span class="n">filter_by</span><span class="p">(</span><span class="n">name</span> <span class="o">=</span> <span class="s1">'some name'</span><span class="p">,</span> <span class="nb">id</span> <span class="o">=</span> <span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
<p>The keyword expressions are extracted from the primary
entity of the query, or the last entity that was the
target of a call to <code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.join()</span></code>.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.filter()</span></code> - filter on SQL expressions.</p>
</div>
</dd></dl>
<dl class="method">
<dt id="sqlalchemy_unchained.BaseQuery.first">
<code class="sig-name descname">first</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy_unchained.BaseQuery.first" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the first result of this <code class="docutils literal notranslate"><span class="pre">Query</span></code> or
None if the result doesn’t contain any row.</p>
<p>first() applies a limit of one within the generated SQL, so that
only one primary entity row is generated on the server side
(note this may consist of multiple result rows if join-loaded
collections are present).</p>
<p>Calling <code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.first()</span></code> results in an execution of the underlying
query.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.one()</span></code></p>
<p><code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.one_or_none()</span></code></p>
</div>
</dd></dl>
<dl class="method">
<dt id="sqlalchemy_unchained.BaseQuery.from_self">
<code class="sig-name descname">from_self</code><span class="sig-paren">(</span><em class="sig-param">*entities</em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy_unchained.BaseQuery.from_self" title="Permalink to this definition">¶</a></dt>
<dd><p>return a Query that selects from this Query’s
SELECT statement.</p>
<p><code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.from_self()</span></code> essentially turns the SELECT statement
into a SELECT of itself.  Given a query such as:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">q</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">User</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">User</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">like</span><span class="p">(</span><span class="s1">'e%'</span><span class="p">))</span>
</pre></div>
</div>
<p>Given the <code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.from_self()</span></code> version:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">q</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">User</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">User</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">like</span><span class="p">(</span><span class="s1">'e%'</span><span class="p">))</span><span class="o">.</span><span class="n">from_self</span><span class="p">()</span>
</pre></div>
</div>
<p>This query renders as:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span> <span class="n">anon_1</span><span class="p">.</span><span class="n">user_id</span> <span class="k">AS</span> <span class="n">anon_1_user_id</span><span class="p">,</span>
       <span class="n">anon_1</span><span class="p">.</span><span class="n">user_name</span> <span class="k">AS</span> <span class="n">anon_1_user_name</span>
<span class="k">FROM</span> <span class="p">(</span><span class="k">SELECT</span> <span class="ss">"user"</span><span class="p">.</span><span class="n">id</span> <span class="k">AS</span> <span class="n">user_id</span><span class="p">,</span> <span class="ss">"user"</span><span class="p">.</span><span class="n">name</span> <span class="k">AS</span> <span class="n">user_name</span>
<span class="k">FROM</span> <span class="ss">"user"</span>
<span class="k">WHERE</span> <span class="ss">"user"</span><span class="p">.</span><span class="n">name</span> <span class="k">LIKE</span> <span class="p">:</span><span class="n">name_1</span><span class="p">)</span> <span class="k">AS</span> <span class="n">anon_1</span>
</pre></div>
</div>
<p>There are lots of cases where <code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.from_self()</span></code> may be useful.
A simple one is where above, we may want to apply a row LIMIT to
the set of user objects we query against, and then apply additional
joins against that row-limited set:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">q</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">User</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">User</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">like</span><span class="p">(</span><span class="s1">'e%'</span><span class="p">))</span><span class="o">.</span>\
    <span class="n">limit</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">from_self</span><span class="p">()</span><span class="o">.</span>\
    <span class="n">join</span><span class="p">(</span><span class="n">User</span><span class="o">.</span><span class="n">addresses</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">Address</span><span class="o">.</span><span class="n">email</span><span class="o">.</span><span class="n">like</span><span class="p">(</span><span class="s1">'q%'</span><span class="p">))</span>
</pre></div>
</div>
<p>The above query joins to the <code class="docutils literal notranslate"><span class="pre">Address</span></code> entity but only against the
first five results of the <code class="docutils literal notranslate"><span class="pre">User</span></code> query:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span> <span class="n">anon_1</span><span class="p">.</span><span class="n">user_id</span> <span class="k">AS</span> <span class="n">anon_1_user_id</span><span class="p">,</span>
       <span class="n">anon_1</span><span class="p">.</span><span class="n">user_name</span> <span class="k">AS</span> <span class="n">anon_1_user_name</span>
<span class="k">FROM</span> <span class="p">(</span><span class="k">SELECT</span> <span class="ss">"user"</span><span class="p">.</span><span class="n">id</span> <span class="k">AS</span> <span class="n">user_id</span><span class="p">,</span> <span class="ss">"user"</span><span class="p">.</span><span class="n">name</span> <span class="k">AS</span> <span class="n">user_name</span>
<span class="k">FROM</span> <span class="ss">"user"</span>
<span class="k">WHERE</span> <span class="ss">"user"</span><span class="p">.</span><span class="n">name</span> <span class="k">LIKE</span> <span class="p">:</span><span class="n">name_1</span>
 <span class="k">LIMIT</span> <span class="p">:</span><span class="n">param_1</span><span class="p">)</span> <span class="k">AS</span> <span class="n">anon_1</span>
<span class="k">JOIN</span> <span class="n">address</span> <span class="k">ON</span> <span class="n">anon_1</span><span class="p">.</span><span class="n">user_id</span> <span class="o">=</span> <span class="n">address</span><span class="p">.</span><span class="n">user_id</span>
<span class="k">WHERE</span> <span class="n">address</span><span class="p">.</span><span class="n">email</span> <span class="k">LIKE</span> <span class="p">:</span><span class="n">email_1</span>
</pre></div>
</div>
<p><strong>Automatic Aliasing</strong></p>
<p>Another key behavior of <code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.from_self()</span></code> is that it applies
<strong>automatic aliasing</strong> to the entities inside the subquery, when
they are referenced on the outside.  Above, if we continue to
refer to the <code class="docutils literal notranslate"><span class="pre">User</span></code> entity without any additional aliasing applied
to it, those references wil be in terms of the subquery:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">q</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">User</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">User</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">like</span><span class="p">(</span><span class="s1">'e%'</span><span class="p">))</span><span class="o">.</span>\
    <span class="n">limit</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">from_self</span><span class="p">()</span><span class="o">.</span>\
    <span class="n">join</span><span class="p">(</span><span class="n">User</span><span class="o">.</span><span class="n">addresses</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">Address</span><span class="o">.</span><span class="n">email</span><span class="o">.</span><span class="n">like</span><span class="p">(</span><span class="s1">'q%'</span><span class="p">))</span><span class="o">.</span>\
    <span class="n">order_by</span><span class="p">(</span><span class="n">User</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</pre></div>
</div>
<p>The ORDER BY against <code class="docutils literal notranslate"><span class="pre">User.name</span></code> is aliased to be in terms of the
inner subquery:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span> <span class="n">anon_1</span><span class="p">.</span><span class="n">user_id</span> <span class="k">AS</span> <span class="n">anon_1_user_id</span><span class="p">,</span>
       <span class="n">anon_1</span><span class="p">.</span><span class="n">user_name</span> <span class="k">AS</span> <span class="n">anon_1_user_name</span>
<span class="k">FROM</span> <span class="p">(</span><span class="k">SELECT</span> <span class="ss">"user"</span><span class="p">.</span><span class="n">id</span> <span class="k">AS</span> <span class="n">user_id</span><span class="p">,</span> <span class="ss">"user"</span><span class="p">.</span><span class="n">name</span> <span class="k">AS</span> <span class="n">user_name</span>
<span class="k">FROM</span> <span class="ss">"user"</span>
<span class="k">WHERE</span> <span class="ss">"user"</span><span class="p">.</span><span class="n">name</span> <span class="k">LIKE</span> <span class="p">:</span><span class="n">name_1</span>
 <span class="k">LIMIT</span> <span class="p">:</span><span class="n">param_1</span><span class="p">)</span> <span class="k">AS</span> <span class="n">anon_1</span>
<span class="k">JOIN</span> <span class="n">address</span> <span class="k">ON</span> <span class="n">anon_1</span><span class="p">.</span><span class="n">user_id</span> <span class="o">=</span> <span class="n">address</span><span class="p">.</span><span class="n">user_id</span>
<span class="k">WHERE</span> <span class="n">address</span><span class="p">.</span><span class="n">email</span> <span class="k">LIKE</span> <span class="p">:</span><span class="n">email_1</span> <span class="k">ORDER</span> <span class="k">BY</span> <span class="n">anon_1</span><span class="p">.</span><span class="n">user_name</span>
</pre></div>
</div>
<p>The automatic aliasing feature only works in a <strong>limited</strong> way,
for simple filters and orderings.   More ambitious constructions
such as referring to the entity in joins should prefer to use
explicit subquery objects, typically making use of the
<code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.subquery()</span></code> method to produce an explicit subquery object.
Always test the structure of queries by viewing the SQL to ensure
a particular structure does what’s expected!</p>
<p><strong>Changing the Entities</strong></p>
<p><code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.from_self()</span></code> also includes the ability to modify what
columns are being queried.   In our example, we want <code class="docutils literal notranslate"><span class="pre">User.id</span></code>
to be queried by the inner query, so that we can join to the
<code class="docutils literal notranslate"><span class="pre">Address</span></code> entity on the outside, but we only wanted the outer
query to return the <code class="docutils literal notranslate"><span class="pre">Address.email</span></code> column:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">q</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">User</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">User</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">like</span><span class="p">(</span><span class="s1">'e%'</span><span class="p">))</span><span class="o">.</span>\
    <span class="n">limit</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">from_self</span><span class="p">(</span><span class="n">Address</span><span class="o">.</span><span class="n">email</span><span class="p">)</span><span class="o">.</span>\
    <span class="n">join</span><span class="p">(</span><span class="n">User</span><span class="o">.</span><span class="n">addresses</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">Address</span><span class="o">.</span><span class="n">email</span><span class="o">.</span><span class="n">like</span><span class="p">(</span><span class="s1">'q%'</span><span class="p">))</span>
</pre></div>
</div>
<p>yielding:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span> <span class="n">address</span><span class="p">.</span><span class="n">email</span> <span class="k">AS</span> <span class="n">address_email</span>
<span class="k">FROM</span> <span class="p">(</span><span class="k">SELECT</span> <span class="ss">"user"</span><span class="p">.</span><span class="n">id</span> <span class="k">AS</span> <span class="n">user_id</span><span class="p">,</span> <span class="ss">"user"</span><span class="p">.</span><span class="n">name</span> <span class="k">AS</span> <span class="n">user_name</span>
<span class="k">FROM</span> <span class="ss">"user"</span>
<span class="k">WHERE</span> <span class="ss">"user"</span><span class="p">.</span><span class="n">name</span> <span class="k">LIKE</span> <span class="p">:</span><span class="n">name_1</span>
 <span class="k">LIMIT</span> <span class="p">:</span><span class="n">param_1</span><span class="p">)</span> <span class="k">AS</span> <span class="n">anon_1</span>
<span class="k">JOIN</span> <span class="n">address</span> <span class="k">ON</span> <span class="n">anon_1</span><span class="p">.</span><span class="n">user_id</span> <span class="o">=</span> <span class="n">address</span><span class="p">.</span><span class="n">user_id</span>
<span class="k">WHERE</span> <span class="n">address</span><span class="p">.</span><span class="n">email</span> <span class="k">LIKE</span> <span class="p">:</span><span class="n">email_1</span>
</pre></div>
</div>
<p><strong>Looking out for Inner / Outer Columns</strong></p>
<p>Keep in mind that when referring to columns that originate from
inside the subquery, we need to ensure they are present in the
columns clause of the subquery itself; this is an ordinary aspect of
SQL.  For example, if we wanted to load from a joined entity inside
the subquery using <code class="xref py py-func docutils literal notranslate"><span class="pre">contains_eager()</span></code>, we need to add those
columns.   Below illustrates a join of <code class="docutils literal notranslate"><span class="pre">Address</span></code> to <code class="docutils literal notranslate"><span class="pre">User</span></code>,
then a subquery, and then we’d like <code class="xref py py-func docutils literal notranslate"><span class="pre">contains_eager()</span></code> to access
the <code class="docutils literal notranslate"><span class="pre">User</span></code> columns:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">q</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">Address</span><span class="p">)</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">Address</span><span class="o">.</span><span class="n">user</span><span class="p">)</span><span class="o">.</span>\
    <span class="nb">filter</span><span class="p">(</span><span class="n">User</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">like</span><span class="p">(</span><span class="s1">'e%'</span><span class="p">))</span>

<span class="n">q</span> <span class="o">=</span> <span class="n">q</span><span class="o">.</span><span class="n">add_entity</span><span class="p">(</span><span class="n">User</span><span class="p">)</span><span class="o">.</span><span class="n">from_self</span><span class="p">()</span><span class="o">.</span>\
    <span class="n">options</span><span class="p">(</span><span class="n">contains_eager</span><span class="p">(</span><span class="n">Address</span><span class="o">.</span><span class="n">user</span><span class="p">))</span>
</pre></div>
</div>
<p>We use <code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.add_entity()</span></code> above <strong>before</strong> we call
<code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.from_self()</span></code> so that the <code class="docutils literal notranslate"><span class="pre">User</span></code> columns are present
in the inner subquery, so that they are available to the
<code class="xref py py-func docutils literal notranslate"><span class="pre">contains_eager()</span></code> modifier we are using on the outside,
producing:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span> <span class="n">anon_1</span><span class="p">.</span><span class="n">address_id</span> <span class="k">AS</span> <span class="n">anon_1_address_id</span><span class="p">,</span>
       <span class="n">anon_1</span><span class="p">.</span><span class="n">address_email</span> <span class="k">AS</span> <span class="n">anon_1_address_email</span><span class="p">,</span>
       <span class="n">anon_1</span><span class="p">.</span><span class="n">address_user_id</span> <span class="k">AS</span> <span class="n">anon_1_address_user_id</span><span class="p">,</span>
       <span class="n">anon_1</span><span class="p">.</span><span class="n">user_id</span> <span class="k">AS</span> <span class="n">anon_1_user_id</span><span class="p">,</span>
       <span class="n">anon_1</span><span class="p">.</span><span class="n">user_name</span> <span class="k">AS</span> <span class="n">anon_1_user_name</span>
<span class="k">FROM</span> <span class="p">(</span>
    <span class="k">SELECT</span> <span class="n">address</span><span class="p">.</span><span class="n">id</span> <span class="k">AS</span> <span class="n">address_id</span><span class="p">,</span>
    <span class="n">address</span><span class="p">.</span><span class="n">email</span> <span class="k">AS</span> <span class="n">address_email</span><span class="p">,</span>
    <span class="n">address</span><span class="p">.</span><span class="n">user_id</span> <span class="k">AS</span> <span class="n">address_user_id</span><span class="p">,</span>
    <span class="ss">"user"</span><span class="p">.</span><span class="n">id</span> <span class="k">AS</span> <span class="n">user_id</span><span class="p">,</span>
    <span class="ss">"user"</span><span class="p">.</span><span class="n">name</span> <span class="k">AS</span> <span class="n">user_name</span>
<span class="k">FROM</span> <span class="n">address</span> <span class="k">JOIN</span> <span class="ss">"user"</span> <span class="k">ON</span> <span class="ss">"user"</span><span class="p">.</span><span class="n">id</span> <span class="o">=</span> <span class="n">address</span><span class="p">.</span><span class="n">user_id</span>
<span class="k">WHERE</span> <span class="ss">"user"</span><span class="p">.</span><span class="n">name</span> <span class="k">LIKE</span> <span class="p">:</span><span class="n">name_1</span><span class="p">)</span> <span class="k">AS</span> <span class="n">anon_1</span>
</pre></div>
</div>
<p>If we didn’t call <code class="docutils literal notranslate"><span class="pre">add_entity(User)</span></code>, but still asked
<code class="xref py py-func docutils literal notranslate"><span class="pre">contains_eager()</span></code> to load the <code class="docutils literal notranslate"><span class="pre">User</span></code> entity, it would be
forced to add the table on the outside without the correct
join criteria - note the <code class="docutils literal notranslate"><span class="pre">anon1,</span> <span class="pre">"user"</span></code> phrase at
the end:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="c1">-- incorrect query</span>
<span class="k">SELECT</span> <span class="n">anon_1</span><span class="p">.</span><span class="n">address_id</span> <span class="k">AS</span> <span class="n">anon_1_address_id</span><span class="p">,</span>
       <span class="n">anon_1</span><span class="p">.</span><span class="n">address_email</span> <span class="k">AS</span> <span class="n">anon_1_address_email</span><span class="p">,</span>
       <span class="n">anon_1</span><span class="p">.</span><span class="n">address_user_id</span> <span class="k">AS</span> <span class="n">anon_1_address_user_id</span><span class="p">,</span>
       <span class="ss">"user"</span><span class="p">.</span><span class="n">id</span> <span class="k">AS</span> <span class="n">user_id</span><span class="p">,</span>
       <span class="ss">"user"</span><span class="p">.</span><span class="n">name</span> <span class="k">AS</span> <span class="n">user_name</span>
<span class="k">FROM</span> <span class="p">(</span>
    <span class="k">SELECT</span> <span class="n">address</span><span class="p">.</span><span class="n">id</span> <span class="k">AS</span> <span class="n">address_id</span><span class="p">,</span>
    <span class="n">address</span><span class="p">.</span><span class="n">email</span> <span class="k">AS</span> <span class="n">address_email</span><span class="p">,</span>
    <span class="n">address</span><span class="p">.</span><span class="n">user_id</span> <span class="k">AS</span> <span class="n">address_user_id</span>
<span class="k">FROM</span> <span class="n">address</span> <span class="k">JOIN</span> <span class="ss">"user"</span> <span class="k">ON</span> <span class="ss">"user"</span><span class="p">.</span><span class="n">id</span> <span class="o">=</span> <span class="n">address</span><span class="p">.</span><span class="n">user_id</span>
<span class="k">WHERE</span> <span class="ss">"user"</span><span class="p">.</span><span class="n">name</span> <span class="k">LIKE</span> <span class="p">:</span><span class="n">name_1</span><span class="p">)</span> <span class="k">AS</span> <span class="n">anon_1</span><span class="p">,</span> <span class="ss">"user"</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>*entities</strong> – optional list of entities which will replace
those being selected.</p>
</dd>
</dl>
</dd></dl>
<dl class="method">
<dt id="sqlalchemy_unchained.BaseQuery.from_statement">
<code class="sig-name descname">from_statement</code><span class="sig-paren">(</span><em class="sig-param">statement</em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy_unchained.BaseQuery.from_statement" title="Permalink to this definition">¶</a></dt>
<dd><p>Execute the given SELECT statement and return results.</p>
<p>This method bypasses all internal statement compilation, and the
statement is executed without modification.</p>
<p>The statement is typically either a <code class="xref py py-func docutils literal notranslate"><span class="pre">text()</span></code>
or <code class="xref py py-func docutils literal notranslate"><span class="pre">select()</span></code> construct, and should return the set
of columns
appropriate to the entity class represented by this <code class="xref py py-class docutils literal notranslate"><span class="pre">Query</span></code>.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference external" href="https://docs.sqlalchemy.org/en/13/orm/tutorial.html#orm-tutorial-literal-sql" title="(in SQLAlchemy v1.3)"><span>Using Textual SQL</span></a> - usage examples in the
ORM tutorial</p>
</div>
</dd></dl>
<dl class="method">
<dt id="sqlalchemy_unchained.BaseQuery.get">
<code class="sig-name descname">get</code><span class="sig-paren">(</span><em class="sig-param">id: Union[int, str, Tuple[int, ...], Tuple[str, ...]]</em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy_unchained.BaseQuery.get" title="Permalink to this definition">¶</a></dt>
<dd><p>Return an instance based on the given primary key identifier,
or <code class="docutils literal notranslate"><span class="pre">None</span></code> if not found.</p>
<p>For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">my_user</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">User</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>

<span class="n">some_object</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">VersionedFoo</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">((</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
</pre></div>
</div>
<p><code class="xref py py-meth docutils literal notranslate"><span class="pre">get()</span></code> is special in that it provides direct
access to the identity map of the owning <code class="xref py py-class docutils literal notranslate"><span class="pre">Session</span></code>.
If the given primary key identifier is present
in the local identity map, the object is returned
directly from this collection and no SQL is emitted,
unless the object has been marked fully expired.
If not present,
a SELECT is performed in order to locate the object.</p>
<p><code class="xref py py-meth docutils literal notranslate"><span class="pre">get()</span></code> also will perform a check if
the object is present in the identity map and
marked as expired - a SELECT
is emitted to refresh the object as well as to
ensure that the row is still present.
If not, <a class="reference external" href="https://docs.sqlalchemy.org/en/13/orm/exceptions.html#sqlalchemy.orm.exc.ObjectDeletedError" title="(in SQLAlchemy v1.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ObjectDeletedError</span></code></a> is raised.</p>
<p><code class="xref py py-meth docutils literal notranslate"><span class="pre">get()</span></code> is only used to return a single
mapped instance, not multiple instances or
individual column constructs, and strictly
on a single primary key value.  The originating
<code class="xref py py-class docutils literal notranslate"><span class="pre">Query</span></code> must be constructed in this way,
i.e. against a single mapped entity,
with no additional filtering criterion.  Loading
options via <code class="xref py py-meth docutils literal notranslate"><span class="pre">options()</span></code> may be applied
however, and will be used if the object is not
yet locally present.</p>
<p>A lazy-loading, many-to-one attribute configured
by <code class="xref py py-func docutils literal notranslate"><span class="pre">relationship()</span></code>, using a simple
foreign-key-to-primary-key criterion, will also use an
operation equivalent to <code class="xref py py-meth docutils literal notranslate"><span class="pre">get()</span></code> in order to retrieve
the target value from the local identity map
before querying the database.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>id</strong> – A scalar or tuple value representing
the primary key.   For a composite primary key,
the order of identifiers corresponds in most cases
to that of the mapped <code class="xref py py-class docutils literal notranslate"><span class="pre">Table</span></code> object’s
primary key columns.  For a <code class="xref py py-func docutils literal notranslate"><span class="pre">mapper()</span></code> that
was given the <code class="docutils literal notranslate"><span class="pre">primary</span> <span class="pre">key</span></code> argument during
construction, the order of identifiers corresponds
to the elements present in this collection.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The object instance, or <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p>
</dd>
</dl>
</dd></dl>
<dl class="method">
<dt id="sqlalchemy_unchained.BaseQuery.get_by">
<code class="sig-name descname">get_by</code><span class="sig-paren">(</span><em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy_unchained.BaseQuery.get_by" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a single model filtering by <code class="docutils literal notranslate"><span class="pre">kwargs</span></code>, only if a single model
was found, otherwise it returns <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>kwargs</strong> – column names and their values to filter by</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>An instance of the model</p>
</dd>
</dl>
</dd></dl>
<dl class="method">
<dt id="sqlalchemy_unchained.BaseQuery.get_execution_options">
<code class="sig-name descname">get_execution_options</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy_unchained.BaseQuery.get_execution_options" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the non-SQL options which will take effect during execution.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version 1.3.</span></p>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.execution_options()</span></code></p>
</div>
</dd></dl>
<dl class="method">
<dt id="sqlalchemy_unchained.BaseQuery.group_by">
<code class="sig-name descname">group_by</code><span class="sig-paren">(</span><em class="sig-param">*criterion</em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy_unchained.BaseQuery.group_by" title="Permalink to this definition">¶</a></dt>
<dd><p>apply one or more GROUP BY criterion to the query and return
the newly resulting <code class="xref py py-class docutils literal notranslate"><span class="pre">Query</span></code></p>
<p>All existing GROUP BY settings can be suppressed by
passing <code class="docutils literal notranslate"><span class="pre">None</span></code> - this will suppress any GROUP BY configured
on mappers as well.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version 1.1: </span>GROUP BY can be cancelled by passing None,
in the same way as ORDER BY.</p>
</div>
</dd></dl>
<dl class="method">
<dt id="sqlalchemy_unchained.BaseQuery.having">
<code class="sig-name descname">having</code><span class="sig-paren">(</span><em class="sig-param">criterion</em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy_unchained.BaseQuery.having" title="Permalink to this definition">¶</a></dt>
<dd><p>apply a HAVING criterion to the query and return the
newly resulting <code class="xref py py-class docutils literal notranslate"><span class="pre">Query</span></code>.</p>
<p><code class="xref py py-meth docutils literal notranslate"><span class="pre">having()</span></code> is used in conjunction with
<code class="xref py py-meth docutils literal notranslate"><span class="pre">group_by()</span></code>.</p>
<p>HAVING criterion makes it possible to use filters on aggregate
functions like COUNT, SUM, AVG, MAX, and MIN, eg.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">q</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">User</span><span class="o">.</span><span class="n">id</span><span class="p">)</span><span class="o">.</span>\
            <span class="n">join</span><span class="p">(</span><span class="n">User</span><span class="o">.</span><span class="n">addresses</span><span class="p">)</span><span class="o">.</span>\
            <span class="n">group_by</span><span class="p">(</span><span class="n">User</span><span class="o">.</span><span class="n">id</span><span class="p">)</span><span class="o">.</span>\
            <span class="n">having</span><span class="p">(</span><span class="n">func</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">Address</span><span class="o">.</span><span class="n">id</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>
<dl class="method">
<dt id="sqlalchemy_unchained.BaseQuery.instances">
<code class="sig-name descname">instances</code><span class="sig-paren">(</span><em class="sig-param">cursor</em>, <em class="sig-param">_Query__context=None</em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy_unchained.BaseQuery.instances" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a ResultProxy cursor as returned by connection.execute(),
return an ORM result as an iterator.</p>
<p>e.g.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">result</span> <span class="o">=</span> <span class="n">engine</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">"select * from users"</span><span class="p">)</span>
<span class="k">for</span> <span class="n">u</span> <span class="ow">in</span> <span class="n">session</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">User</span><span class="p">)</span><span class="o">.</span><span class="n">instances</span><span class="p">(</span><span class="n">result</span><span class="p">):</span>
    <span class="nb">print</span> <span class="n">u</span>
</pre></div>
</div>
</dd></dl>
<dl class="method">
<dt id="sqlalchemy_unchained.BaseQuery.intersect">
<code class="sig-name descname">intersect</code><span class="sig-paren">(</span><em class="sig-param">*q</em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy_unchained.BaseQuery.intersect" title="Permalink to this definition">¶</a></dt>
<dd><p>Produce an INTERSECT of this Query against one or more queries.</p>
<p>Works the same way as <a class="reference external" href="https://docs.sqlalchemy.org/en/13/orm/query.html#sqlalchemy.orm.query.Query.union" title="(in SQLAlchemy v1.3)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">union()</span></code></a>. See
that method for usage examples.</p>
</dd></dl>
<dl class="method">
<dt id="sqlalchemy_unchained.BaseQuery.intersect_all">
<code class="sig-name descname">intersect_all</code><span class="sig-paren">(</span><em class="sig-param">*q</em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy_unchained.BaseQuery.intersect_all" title="Permalink to this definition">¶</a></dt>
<dd><p>Produce an INTERSECT ALL of this Query against one or more queries.</p>
<p>Works the same way as <a class="reference external" href="https://docs.sqlalchemy.org/en/13/orm/query.html#sqlalchemy.orm.query.Query.union" title="(in SQLAlchemy v1.3)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">union()</span></code></a>. See
that method for usage examples.</p>
</dd></dl>
<dl class="method">
<dt id="sqlalchemy_unchained.BaseQuery.is_single_entity">
<em class="property">property </em><code class="sig-name descname">is_single_entity</code><a class="headerlink" href="#sqlalchemy_unchained.BaseQuery.is_single_entity" title="Permalink to this definition">¶</a></dt>
<dd><p>Indicates if this <code class="xref py py-class docutils literal notranslate"><span class="pre">Query</span></code> returns tuples or single entities.</p>
<p>Returns True if this query returns a single entity for each instance
in its result list, and False if this query returns a tuple of entities
for each result.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version 1.3.11.</span></p>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.only_return_tuples()</span></code></p>
</div>
</dd></dl>
<dl class="method">
<dt id="sqlalchemy_unchained.BaseQuery.join">
<code class="sig-name descname">join</code><span class="sig-paren">(</span><em class="sig-param">*props</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy_unchained.BaseQuery.join" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a SQL JOIN against this <code class="xref py py-class docutils literal notranslate"><span class="pre">Query</span></code> object’s criterion
and apply generatively, returning the newly resulting <code class="xref py py-class docutils literal notranslate"><span class="pre">Query</span></code>.</p>
<p><strong>Simple Relationship Joins</strong></p>
<p>Consider a mapping between two classes <code class="docutils literal notranslate"><span class="pre">User</span></code> and <code class="docutils literal notranslate"><span class="pre">Address</span></code>,
with a relationship <code class="docutils literal notranslate"><span class="pre">User.addresses</span></code> representing a collection
of <code class="docutils literal notranslate"><span class="pre">Address</span></code> objects associated with each <code class="docutils literal notranslate"><span class="pre">User</span></code>.   The most
common usage of <code class="xref py py-meth docutils literal notranslate"><span class="pre">join()</span></code> is to create a JOIN along this
relationship, using the <code class="docutils literal notranslate"><span class="pre">User.addresses</span></code> attribute as an indicator
for how this should occur:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">q</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">User</span><span class="p">)</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">User</span><span class="o">.</span><span class="n">addresses</span><span class="p">)</span>
</pre></div>
</div>
<p>Where above, the call to <code class="xref py py-meth docutils literal notranslate"><span class="pre">join()</span></code> along <code class="docutils literal notranslate"><span class="pre">User.addresses</span></code>
will result in SQL equivalent to:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SELECT</span> <span class="n">user</span><span class="o">.*</span> <span class="n">FROM</span> <span class="n">user</span> <span class="n">JOIN</span> <span class="n">address</span> <span class="n">ON</span> <span class="n">user</span><span class="o">.</span><span class="n">id</span> <span class="o">=</span> <span class="n">address</span><span class="o">.</span><span class="n">user_id</span>
</pre></div>
</div>
<p>In the above example we refer to <code class="docutils literal notranslate"><span class="pre">User.addresses</span></code> as passed to
<code class="xref py py-meth docutils literal notranslate"><span class="pre">join()</span></code> as the <em>on clause</em>, that is, it indicates
how the “ON” portion of the JOIN should be constructed.  For a
single-entity query such as the one above (i.e. we start by selecting
only from <code class="docutils literal notranslate"><span class="pre">User</span></code> and nothing else), the relationship can also be
specified by its string name:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">q</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">User</span><span class="p">)</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s2">"addresses"</span><span class="p">)</span>
</pre></div>
</div>
<p><code class="xref py py-meth docutils literal notranslate"><span class="pre">join()</span></code> can also accommodate multiple
“on clause” arguments to produce a chain of joins, such as below
where a join across four related entities is constructed:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">q</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">User</span><span class="p">)</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s2">"orders"</span><span class="p">,</span> <span class="s2">"items"</span><span class="p">,</span> <span class="s2">"keywords"</span><span class="p">)</span>
</pre></div>
</div>
<p>The above would be shorthand for three separate calls to
<code class="xref py py-meth docutils literal notranslate"><span class="pre">join()</span></code>, each using an explicit attribute to indicate
the source entity:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">q</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">User</span><span class="p">)</span><span class="o">.</span>\
        <span class="n">join</span><span class="p">(</span><span class="n">User</span><span class="o">.</span><span class="n">orders</span><span class="p">)</span><span class="o">.</span>\
        <span class="n">join</span><span class="p">(</span><span class="n">Order</span><span class="o">.</span><span class="n">items</span><span class="p">)</span><span class="o">.</span>\
        <span class="n">join</span><span class="p">(</span><span class="n">Item</span><span class="o">.</span><span class="n">keywords</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Joins to a Target Entity or Selectable</strong></p>
<p>A second form of <code class="xref py py-meth docutils literal notranslate"><span class="pre">join()</span></code> allows any mapped entity
or core selectable construct as a target.   In this usage,
<code class="xref py py-meth docutils literal notranslate"><span class="pre">join()</span></code> will attempt
to create a JOIN along the natural foreign key relationship between
two entities:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">q</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">User</span><span class="p">)</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">Address</span><span class="p">)</span>
</pre></div>
</div>
<p>The above calling form of <code class="xref py py-meth docutils literal notranslate"><span class="pre">join()</span></code> will raise an error if
either there are no foreign keys between the two entities, or if
there are multiple foreign key linkages between them.   In the
above calling form, <code class="xref py py-meth docutils literal notranslate"><span class="pre">join()</span></code> is called upon to
create the “on clause” automatically for us.  The target can
be any mapped entity or selectable, such as a <code class="xref py py-class docutils literal notranslate"><span class="pre">Table</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">q</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">User</span><span class="p">)</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">addresses_table</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Joins to a Target with an ON Clause</strong></p>
<p>The third calling form allows both the target entity as well
as the ON clause to be passed explicitly.   Suppose for
example we wanted to join to <code class="docutils literal notranslate"><span class="pre">Address</span></code> twice, using
an alias the second time.  We use <a class="reference external" href="https://docs.sqlalchemy.org/en/13/orm/query.html#sqlalchemy.orm.aliased" title="(in SQLAlchemy v1.3)"><code class="xref py py-func docutils literal notranslate"><span class="pre">aliased()</span></code></a>
to create a distinct alias of <code class="docutils literal notranslate"><span class="pre">Address</span></code>, and join
to it using the <code class="docutils literal notranslate"><span class="pre">target,</span> <span class="pre">onclause</span></code> form, so that the
alias can be specified explicitly as the target along with
the relationship to instruct how the ON clause should proceed:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">a_alias</span> <span class="o">=</span> <span class="n">aliased</span><span class="p">(</span><span class="n">Address</span><span class="p">)</span>

<span class="n">q</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">User</span><span class="p">)</span><span class="o">.</span>\
        <span class="n">join</span><span class="p">(</span><span class="n">User</span><span class="o">.</span><span class="n">addresses</span><span class="p">)</span><span class="o">.</span>\
        <span class="n">join</span><span class="p">(</span><span class="n">a_alias</span><span class="p">,</span> <span class="n">User</span><span class="o">.</span><span class="n">addresses</span><span class="p">)</span><span class="o">.</span>\
        <span class="nb">filter</span><span class="p">(</span><span class="n">Address</span><span class="o">.</span><span class="n">email_address</span><span class="o">==</span><span class="s1">'ed@foo.com'</span><span class="p">)</span><span class="o">.</span>\
        <span class="nb">filter</span><span class="p">(</span><span class="n">a_alias</span><span class="o">.</span><span class="n">email_address</span><span class="o">==</span><span class="s1">'ed@bar.com'</span><span class="p">)</span>
</pre></div>
</div>
<p>Where above, the generated SQL would be similar to:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SELECT</span> <span class="n">user</span><span class="o">.*</span> <span class="n">FROM</span> <span class="n">user</span>
    <span class="n">JOIN</span> <span class="n">address</span> <span class="n">ON</span> <span class="n">user</span><span class="o">.</span><span class="n">id</span> <span class="o">=</span> <span class="n">address</span><span class="o">.</span><span class="n">user_id</span>
    <span class="n">JOIN</span> <span class="n">address</span> <span class="n">AS</span> <span class="n">address_1</span> <span class="n">ON</span> <span class="n">user</span><span class="o">.</span><span class="n">id</span><span class="o">=</span><span class="n">address_1</span><span class="o">.</span><span class="n">user_id</span>
    <span class="n">WHERE</span> <span class="n">address</span><span class="o">.</span><span class="n">email_address</span> <span class="o">=</span> <span class="p">:</span><span class="n">email_address_1</span>
    <span class="n">AND</span> <span class="n">address_1</span><span class="o">.</span><span class="n">email_address</span> <span class="o">=</span> <span class="p">:</span><span class="n">email_address_2</span>
</pre></div>
</div>
<p>The two-argument calling form of <code class="xref py py-meth docutils literal notranslate"><span class="pre">join()</span></code>
also allows us to construct arbitrary joins with SQL-oriented
“on clause” expressions, not relying upon configured relationships
at all.  Any SQL expression can be passed as the ON clause
when using the two-argument form, which should refer to the target
entity in some way as well as an applicable source entity:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">q</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">User</span><span class="p">)</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">Address</span><span class="p">,</span> <span class="n">User</span><span class="o">.</span><span class="n">id</span><span class="o">==</span><span class="n">Address</span><span class="o">.</span><span class="n">user_id</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Advanced Join Targeting and Adaption</strong></p>
<p>There is a lot of flexibility in what the “target” can be when using
<code class="xref py py-meth docutils literal notranslate"><span class="pre">join()</span></code>.   As noted previously, it also accepts
<code class="xref py py-class docutils literal notranslate"><span class="pre">Table</span></code> constructs and other selectables such as
<code class="xref py py-func docutils literal notranslate"><span class="pre">alias()</span></code> and <code class="xref py py-func docutils literal notranslate"><span class="pre">select()</span></code> constructs, with either the one
or two-argument forms:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">addresses_q</span> <span class="o">=</span> <span class="n">select</span><span class="p">([</span><span class="n">Address</span><span class="o">.</span><span class="n">user_id</span><span class="p">])</span><span class="o">.</span>\
            <span class="n">where</span><span class="p">(</span><span class="n">Address</span><span class="o">.</span><span class="n">email_address</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">"@bar.com"</span><span class="p">))</span><span class="o">.</span>\
            <span class="n">alias</span><span class="p">()</span>

<span class="n">q</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">User</span><span class="p">)</span><span class="o">.</span>\
            <span class="n">join</span><span class="p">(</span><span class="n">addresses_q</span><span class="p">,</span> <span class="n">addresses_q</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">user_id</span><span class="o">==</span><span class="n">User</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
</pre></div>
</div>
<p><code class="xref py py-meth docutils literal notranslate"><span class="pre">join()</span></code> also features the ability to <em>adapt</em> a
<code class="xref py py-meth docutils literal notranslate"><span class="pre">relationship()</span></code> -driven ON clause to the target
selectable. Below we construct a JOIN from <code class="docutils literal notranslate"><span class="pre">User</span></code> to a subquery
against <code class="docutils literal notranslate"><span class="pre">Address</span></code>, allowing the relationship denoted by
<code class="docutils literal notranslate"><span class="pre">User.addresses</span></code> to <em>adapt</em> itself to the altered target:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">address_subq</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">Address</span><span class="p">)</span><span class="o">.</span>\
                <span class="nb">filter</span><span class="p">(</span><span class="n">Address</span><span class="o">.</span><span class="n">email_address</span> <span class="o">==</span> <span class="s1">'ed@foo.com'</span><span class="p">)</span><span class="o">.</span>\
                <span class="n">subquery</span><span class="p">()</span>

<span class="n">q</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">User</span><span class="p">)</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">address_subq</span><span class="p">,</span> <span class="n">User</span><span class="o">.</span><span class="n">addresses</span><span class="p">)</span>
</pre></div>
</div>
<p>Producing SQL similar to:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SELECT</span> <span class="n">user</span><span class="o">.*</span> <span class="n">FROM</span> <span class="n">user</span>
    <span class="n">JOIN</span> <span class="p">(</span>
        <span class="n">SELECT</span> <span class="n">address</span><span class="o">.</span><span class="n">id</span> <span class="n">AS</span> <span class="nb">id</span><span class="p">,</span>
                <span class="n">address</span><span class="o">.</span><span class="n">user_id</span> <span class="n">AS</span> <span class="n">user_id</span><span class="p">,</span>
                <span class="n">address</span><span class="o">.</span><span class="n">email_address</span> <span class="n">AS</span> <span class="n">email_address</span>
        <span class="n">FROM</span> <span class="n">address</span>
        <span class="n">WHERE</span> <span class="n">address</span><span class="o">.</span><span class="n">email_address</span> <span class="o">=</span> <span class="p">:</span><span class="n">email_address_1</span>
    <span class="p">)</span> <span class="n">AS</span> <span class="n">anon_1</span> <span class="n">ON</span> <span class="n">user</span><span class="o">.</span><span class="n">id</span> <span class="o">=</span> <span class="n">anon_1</span><span class="o">.</span><span class="n">user_id</span>
</pre></div>
</div>
<p>The above form allows one to fall back onto an explicit ON
clause at any time:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">q</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">User</span><span class="p">)</span><span class="o">.</span>\
        <span class="n">join</span><span class="p">(</span><span class="n">address_subq</span><span class="p">,</span> <span class="n">User</span><span class="o">.</span><span class="n">id</span><span class="o">==</span><span class="n">address_subq</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">user_id</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Controlling what to Join From</strong></p>
<p>While <code class="xref py py-meth docutils literal notranslate"><span class="pre">join()</span></code> exclusively deals with the “right”
side of the JOIN, we can also control the “left” side, in those
cases where it’s needed, using <code class="xref py py-meth docutils literal notranslate"><span class="pre">select_from()</span></code>.
Below we construct a query against <code class="docutils literal notranslate"><span class="pre">Address</span></code> but can still
make usage of <code class="docutils literal notranslate"><span class="pre">User.addresses</span></code> as our ON clause by instructing
the <code class="xref py py-class docutils literal notranslate"><span class="pre">Query</span></code> to select first from the <code class="docutils literal notranslate"><span class="pre">User</span></code>
entity:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">q</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">Address</span><span class="p">)</span><span class="o">.</span><span class="n">select_from</span><span class="p">(</span><span class="n">User</span><span class="p">)</span><span class="o">.</span>\
                <span class="n">join</span><span class="p">(</span><span class="n">User</span><span class="o">.</span><span class="n">addresses</span><span class="p">)</span><span class="o">.</span>\
                <span class="nb">filter</span><span class="p">(</span><span class="n">User</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">'ed'</span><span class="p">)</span>
</pre></div>
</div>
<p>Which will produce SQL similar to:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SELECT</span> <span class="n">address</span><span class="o">.*</span> <span class="n">FROM</span> <span class="n">user</span>
    <span class="n">JOIN</span> <span class="n">address</span> <span class="n">ON</span> <span class="n">user</span><span class="o">.</span><span class="n">id</span><span class="o">=</span><span class="n">address</span><span class="o">.</span><span class="n">user_id</span>
    <span class="n">WHERE</span> <span class="n">user</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="p">:</span><span class="n">name_1</span>
</pre></div>
</div>
<p><strong>Constructing Aliases Anonymously</strong></p>
<p><code class="xref py py-meth docutils literal notranslate"><span class="pre">join()</span></code> can construct anonymous aliases
using the <code class="docutils literal notranslate"><span class="pre">aliased=True</span></code> flag.  This feature is useful
when a query is being joined algorithmically, such as
when querying self-referentially to an arbitrary depth:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">q</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">Node</span><span class="p">)</span><span class="o">.</span>\
        <span class="n">join</span><span class="p">(</span><span class="s2">"children"</span><span class="p">,</span> <span class="s2">"children"</span><span class="p">,</span> <span class="n">aliased</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>When <code class="docutils literal notranslate"><span class="pre">aliased=True</span></code> is used, the actual “alias” construct
is not explicitly available.  To work with it, methods such as
<code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.filter()</span></code> will adapt the incoming entity to
the last join point:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">q</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">Node</span><span class="p">)</span><span class="o">.</span>\
        <span class="n">join</span><span class="p">(</span><span class="s2">"children"</span><span class="p">,</span> <span class="s2">"children"</span><span class="p">,</span> <span class="n">aliased</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span>\
        <span class="nb">filter</span><span class="p">(</span><span class="n">Node</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">'grandchild 1'</span><span class="p">)</span>
</pre></div>
</div>
<p>When using automatic aliasing, the <code class="docutils literal notranslate"><span class="pre">from_joinpoint=True</span></code>
argument can allow a multi-node join to be broken into
multiple calls to <code class="xref py py-meth docutils literal notranslate"><span class="pre">join()</span></code>, so that
each path along the way can be further filtered:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">q</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">Node</span><span class="p">)</span><span class="o">.</span>\
        <span class="n">join</span><span class="p">(</span><span class="s2">"children"</span><span class="p">,</span> <span class="n">aliased</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span>\
        <span class="nb">filter</span><span class="p">(</span><span class="n">Node</span><span class="o">.</span><span class="n">name</span><span class="o">=</span><span class="s1">'child 1'</span><span class="p">)</span><span class="o">.</span>\
        <span class="n">join</span><span class="p">(</span><span class="s2">"children"</span><span class="p">,</span> <span class="n">aliased</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">from_joinpoint</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span>\
        <span class="nb">filter</span><span class="p">(</span><span class="n">Node</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">'grandchild 1'</span><span class="p">)</span>
</pre></div>
</div>
<p>The filtering aliases above can then be reset back to the
original <code class="docutils literal notranslate"><span class="pre">Node</span></code> entity using <code class="xref py py-meth docutils literal notranslate"><span class="pre">reset_joinpoint()</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">q</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">Node</span><span class="p">)</span><span class="o">.</span>\
        <span class="n">join</span><span class="p">(</span><span class="s2">"children"</span><span class="p">,</span> <span class="s2">"children"</span><span class="p">,</span> <span class="n">aliased</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span>\
        <span class="nb">filter</span><span class="p">(</span><span class="n">Node</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">'grandchild 1'</span><span class="p">)</span><span class="o">.</span>\
        <span class="n">reset_joinpoint</span><span class="p">()</span><span class="o">.</span>\
        <span class="nb">filter</span><span class="p">(</span><span class="n">Node</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">'parent 1)</span>
</pre></div>
</div>
<p>For an example of <code class="docutils literal notranslate"><span class="pre">aliased=True</span></code>, see the distribution
example <a class="reference external" href="https://docs.sqlalchemy.org/en/13/orm/examples.html#examples-xmlpersistence" title="(in SQLAlchemy v1.3)"><span>XML Persistence</span></a> which illustrates
an XPath-like query system using algorithmic joins.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>*props</strong> – A collection of one or more join conditions,
each consisting of a relationship-bound attribute or string
relationship name representing an “on clause”, or a single
target entity, or a tuple in the form of <code class="docutils literal notranslate"><span class="pre">(target,</span> <span class="pre">onclause)</span></code>.
A special two-argument calling form of the form <code class="docutils literal notranslate"><span class="pre">target,</span> <span class="pre">onclause</span></code>
is also accepted.</p></li>
<li><p><strong>aliased=False</strong> – If True, indicate that the JOIN target should be
anonymously aliased.  Subsequent calls to <code class="xref py py-meth docutils literal notranslate"><span class="pre">filter()</span></code>
and similar will adapt the incoming criterion to the target
alias, until <code class="xref py py-meth docutils literal notranslate"><span class="pre">reset_joinpoint()</span></code> is called.</p></li>
<li><p><strong>isouter=False</strong> – <p>If True, the join used will be a left outer join,
just as if the <code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.outerjoin()</span></code> method were called.  This
flag is here to maintain consistency with the same flag as accepted
by <code class="xref py py-meth docutils literal notranslate"><span class="pre">FromClause.join()</span></code> and other Core constructs.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version 1.0.0.</span></p>
</div>
</p></li>
<li><p><strong>full=False</strong> – <p>render FULL OUTER JOIN; implies <code class="docutils literal notranslate"><span class="pre">isouter</span></code>.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version 1.1.</span></p>
</div>
</p></li>
<li><p><strong>from_joinpoint=False</strong> – When using <code class="docutils literal notranslate"><span class="pre">aliased=True</span></code>, a setting
of True here will cause the join to be from the most recent
joined target, rather than starting back from the original
FROM clauses of the query.</p></li>
</ul>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference external" href="https://docs.sqlalchemy.org/en/13/orm/tutorial.html#ormtutorial-joins" title="(in SQLAlchemy v1.3)"><span>Querying with Joins</span></a> in the ORM tutorial.</p>
<p><a class="reference external" href="https://docs.sqlalchemy.org/en/13/orm/inheritance.html#inheritance-toplevel" title="(in SQLAlchemy v1.3)"><span>Mapping Class Inheritance Hierarchies</span></a> for details on how
<code class="xref py py-meth docutils literal notranslate"><span class="pre">join()</span></code> is used for inheritance relationships.</p>
<p><code class="xref py py-func docutils literal notranslate"><span class="pre">orm.join()</span></code> - a standalone ORM-level join function,
used internally by <code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.join()</span></code>, which in previous
SQLAlchemy versions was the primary ORM-level joining interface.</p>
</div>
</dd></dl>
<dl class="method">
<dt id="sqlalchemy_unchained.BaseQuery.label">
<code class="sig-name descname">label</code><span class="sig-paren">(</span><em class="sig-param">name</em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy_unchained.BaseQuery.label" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the full SELECT statement represented by this
<code class="xref py py-class docutils literal notranslate"><span class="pre">Query</span></code>, converted
to a scalar subquery with a label of the given name.</p>
<p>Analogous to <a class="reference external" href="https://docs.sqlalchemy.org/en/13/core/selectable.html#sqlalchemy.sql.expression.SelectBase.label" title="(in SQLAlchemy v1.3)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">sqlalchemy.sql.expression.SelectBase.label()</span></code></a>.</p>
</dd></dl>
<dl class="method">
<dt id="sqlalchemy_unchained.BaseQuery.limit">
<code class="sig-name descname">limit</code><span class="sig-paren">(</span><em class="sig-param">limit</em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy_unchained.BaseQuery.limit" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply a <code class="docutils literal notranslate"><span class="pre">LIMIT</span></code> to the query and return the newly resulting
<code class="docutils literal notranslate"><span class="pre">Query</span></code>.</p>
</dd></dl>
<dl class="method">
<dt id="sqlalchemy_unchained.BaseQuery.merge_result">
<code class="sig-name descname">merge_result</code><span class="sig-paren">(</span><em class="sig-param">iterator</em>, <em class="sig-param">load=True</em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy_unchained.BaseQuery.merge_result" title="Permalink to this definition">¶</a></dt>
<dd><p>Merge a result into this <code class="xref py py-class docutils literal notranslate"><span class="pre">Query</span></code> object’s Session.</p>
<p>Given an iterator returned by a <code class="xref py py-class docutils literal notranslate"><span class="pre">Query</span></code> of the same structure
as this one, return an identical iterator of results, with all mapped
instances merged into the session using <code class="xref py py-meth docutils literal notranslate"><span class="pre">Session.merge()</span></code>. This
is an optimized method which will merge all mapped instances,
preserving the structure of the result rows and unmapped columns with
less method overhead than that of calling <code class="xref py py-meth docutils literal notranslate"><span class="pre">Session.merge()</span></code>
explicitly for each value.</p>
<p>The structure of the results is determined based on the column list of
this <code class="xref py py-class docutils literal notranslate"><span class="pre">Query</span></code> - if these do not correspond, unchecked errors
will occur.</p>
<p>The ‘load’ argument is the same as that of <code class="xref py py-meth docutils literal notranslate"><span class="pre">Session.merge()</span></code>.</p>
<p>For an example of how <code class="xref py py-meth docutils literal notranslate"><span class="pre">merge_result()</span></code> is used, see
the source code for the example <a class="reference external" href="https://docs.sqlalchemy.org/en/13/orm/examples.html#examples-caching" title="(in SQLAlchemy v1.3)"><span>Dogpile Caching</span></a>, where
<code class="xref py py-meth docutils literal notranslate"><span class="pre">merge_result()</span></code> is used to efficiently restore state
from a cache back into a target <code class="xref py py-class docutils literal notranslate"><span class="pre">Session</span></code>.</p>
</dd></dl>
<dl class="method">
<dt id="sqlalchemy_unchained.BaseQuery.offset">
<code class="sig-name descname">offset</code><span class="sig-paren">(</span><em class="sig-param">offset</em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy_unchained.BaseQuery.offset" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply an <code class="docutils literal notranslate"><span class="pre">OFFSET</span></code> to the query and return the newly resulting
<code class="docutils literal notranslate"><span class="pre">Query</span></code>.</p>
</dd></dl>
<dl class="method">
<dt id="sqlalchemy_unchained.BaseQuery.one">
<code class="sig-name descname">one</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy_unchained.BaseQuery.one" title="Permalink to this definition">¶</a></dt>
<dd><p>Return exactly one result or raise an exception.</p>
<p>Raises <code class="docutils literal notranslate"><span class="pre">sqlalchemy.orm.exc.NoResultFound</span></code> if the query selects
no rows.  Raises <code class="docutils literal notranslate"><span class="pre">sqlalchemy.orm.exc.MultipleResultsFound</span></code>
if multiple object identities are returned, or if multiple
rows are returned for a query that returns only scalar values
as opposed to full identity-mapped entities.</p>
<p>Calling <a class="reference internal" href="#sqlalchemy_unchained.BaseQuery.one" title="sqlalchemy_unchained.BaseQuery.one"><code class="xref py py-meth docutils literal notranslate"><span class="pre">one()</span></code></a> results in an execution of the underlying query.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.first()</span></code></p>
<p><code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.one_or_none()</span></code></p>
</div>
</dd></dl>
<dl class="method">
<dt id="sqlalchemy_unchained.BaseQuery.one_or_none">
<code class="sig-name descname">one_or_none</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy_unchained.BaseQuery.one_or_none" title="Permalink to this definition">¶</a></dt>
<dd><p>Return at most one result or raise an exception.</p>
<p>Returns <code class="docutils literal notranslate"><span class="pre">None</span></code> if the query selects
no rows.  Raises <code class="docutils literal notranslate"><span class="pre">sqlalchemy.orm.exc.MultipleResultsFound</span></code>
if multiple object identities are returned, or if multiple
rows are returned for a query that returns only scalar values
as opposed to full identity-mapped entities.</p>
<p>Calling <code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.one_or_none()</span></code> results in an execution of the
underlying query.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version 1.0.9: </span>Added <code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.one_or_none()</span></code></p>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.first()</span></code></p>
<p><code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.one()</span></code></p>
</div>
</dd></dl>
<dl class="method">
<dt id="sqlalchemy_unchained.BaseQuery.only_return_tuples">
<code class="sig-name descname">only_return_tuples</code><span class="sig-paren">(</span><em class="sig-param">value</em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy_unchained.BaseQuery.only_return_tuples" title="Permalink to this definition">¶</a></dt>
<dd><p>When set to True, the query results will always be a tuple.</p>
<p>This is specifically for single element queries. The default is False.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version 1.2.5.</span></p>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.is_single_entity()</span></code></p>
</div>
</dd></dl>
<dl class="method">
<dt id="sqlalchemy_unchained.BaseQuery.options">
<code class="sig-name descname">options</code><span class="sig-paren">(</span><em class="sig-param">*args</em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy_unchained.BaseQuery.options" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a new <code class="xref py py-class docutils literal notranslate"><span class="pre">Query</span></code> object, applying the given list of
mapper options.</p>
<p>Most supplied options regard changing how column- and
relationship-mapped attributes are loaded.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference external" href="https://docs.sqlalchemy.org/en/13/orm/loading_columns.html#deferred-options" title="(in SQLAlchemy v1.3)"><span>Deferred Column Loader Query Options</span></a></p>
<p><a class="reference external" href="https://docs.sqlalchemy.org/en/13/orm/loading_relationships.html#relationship-loader-options" title="(in SQLAlchemy v1.3)"><span>Relationship Loading with Loader Options</span></a></p>
</div>
</dd></dl>
<dl class="method">
<dt id="sqlalchemy_unchained.BaseQuery.order_by">
<code class="sig-name descname">order_by</code><span class="sig-paren">(</span><em class="sig-param">*criterion</em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy_unchained.BaseQuery.order_by" title="Permalink to this definition">¶</a></dt>
<dd><p>apply one or more ORDER BY criterion to the query and return
the newly resulting <code class="docutils literal notranslate"><span class="pre">Query</span></code></p>
<p>All existing ORDER BY settings can be suppressed by
passing <code class="docutils literal notranslate"><span class="pre">None</span></code> - this will suppress any ordering configured
on the <code class="xref py py-func docutils literal notranslate"><span class="pre">mapper()</span></code> object using the deprecated
<a href="#id1"><span class="problematic" id="id2">:paramref:`.mapper.order_by`</span></a> parameter.</p>
</dd></dl>
<dl class="method">
<dt id="sqlalchemy_unchained.BaseQuery.outerjoin">
<code class="sig-name descname">outerjoin</code><span class="sig-paren">(</span><em class="sig-param">*props</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy_unchained.BaseQuery.outerjoin" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a left outer join against this <code class="docutils literal notranslate"><span class="pre">Query</span></code> object’s criterion
and apply generatively, returning the newly resulting <code class="docutils literal notranslate"><span class="pre">Query</span></code>.</p>
<p>Usage is the same as the <code class="docutils literal notranslate"><span class="pre">join()</span></code> method.</p>
</dd></dl>
<dl class="method">
<dt id="sqlalchemy_unchained.BaseQuery.params">
<code class="sig-name descname">params</code><span class="sig-paren">(</span><em class="sig-param">*args</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy_unchained.BaseQuery.params" title="Permalink to this definition">¶</a></dt>
<dd><p>add values for bind parameters which may have been
specified in filter().</p>
<p>parameters may be specified using **kwargs, or optionally a single
dictionary as the first positional argument. The reason for both is
that **kwargs is convenient, however some parameter dictionaries
contain unicode keys in which case **kwargs cannot be used.</p>
</dd></dl>
<dl class="method">
<dt id="sqlalchemy_unchained.BaseQuery.populate_existing">
<code class="sig-name descname">populate_existing</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy_unchained.BaseQuery.populate_existing" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a <code class="xref py py-class docutils literal notranslate"><span class="pre">Query</span></code> that will expire and refresh all instances
as they are loaded, or reused from the current <code class="xref py py-class docutils literal notranslate"><span class="pre">Session</span></code>.</p>
<p><a class="reference internal" href="#sqlalchemy_unchained.BaseQuery.populate_existing" title="sqlalchemy_unchained.BaseQuery.populate_existing"><code class="xref py py-meth docutils literal notranslate"><span class="pre">populate_existing()</span></code></a> does not improve behavior when
the ORM is used normally - the <code class="xref py py-class docutils literal notranslate"><span class="pre">Session</span></code> object’s usual
behavior of maintaining a transaction and expiring all attributes
after rollback or commit handles object state automatically.
This method is not intended for general use.</p>
</dd></dl>
<dl class="method">
<dt id="sqlalchemy_unchained.BaseQuery.prefix_with">
<code class="sig-name descname">prefix_with</code><span class="sig-paren">(</span><em class="sig-param">*prefixes</em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy_unchained.BaseQuery.prefix_with" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply the prefixes to the query and return the newly resulting
<code class="docutils literal notranslate"><span class="pre">Query</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>*prefixes</strong> – optional prefixes, typically strings,
not using any commas.   In particular is useful for MySQL keywords
and optimizer hints:</p>
</dd>
</dl>
<p>e.g.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">query</span> <span class="o">=</span> <span class="n">sess</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">User</span><span class="o">.</span><span class="n">name</span><span class="p">)</span><span class="o">.</span>\
    <span class="n">prefix_with</span><span class="p">(</span><span class="s1">'HIGH_PRIORITY'</span><span class="p">)</span><span class="o">.</span>\
    <span class="n">prefix_with</span><span class="p">(</span><span class="s1">'SQL_SMALL_RESULT'</span><span class="p">,</span> <span class="s1">'ALL'</span><span class="p">)</span><span class="o">.</span>\
    <span class="n">prefix_with</span><span class="p">(</span><span class="s1">'/*+ BKA(user) */'</span><span class="p">)</span>
</pre></div>
</div>
<p>Would render:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SELECT</span> <span class="n">HIGH_PRIORITY</span> <span class="n">SQL_SMALL_RESULT</span> <span class="n">ALL</span> <span class="o">/*+</span> <span class="n">BKA</span><span class="p">(</span><span class="n">user</span><span class="p">)</span> <span class="o">*/</span>
<span class="n">users</span><span class="o">.</span><span class="n">name</span> <span class="n">AS</span> <span class="n">users_name</span> <span class="n">FROM</span> <span class="n">users</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><code class="xref py py-meth docutils literal notranslate"><span class="pre">HasPrefixes.prefix_with()</span></code></p>
</div>
</dd></dl>
<dl class="method">
<dt id="sqlalchemy_unchained.BaseQuery.reset_joinpoint">
<code class="sig-name descname">reset_joinpoint</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy_unchained.BaseQuery.reset_joinpoint" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a new <code class="xref py py-class docutils literal notranslate"><span class="pre">Query</span></code>, where the “join point” has
been reset back to the base FROM entities of the query.</p>
<p>This method is usually used in conjunction with the
<code class="docutils literal notranslate"><span class="pre">aliased=True</span></code> feature of the <code class="xref py py-meth docutils literal notranslate"><span class="pre">join()</span></code>
method.  See the example in <code class="xref py py-meth docutils literal notranslate"><span class="pre">join()</span></code> for how
this is used.</p>
</dd></dl>
<dl class="method">
<dt id="sqlalchemy_unchained.BaseQuery.scalar">
<code class="sig-name descname">scalar</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy_unchained.BaseQuery.scalar" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the first element of the first result or None
if no rows present.  If multiple rows are returned,
raises MultipleResultsFound.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">session</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">Item</span><span class="p">)</span><span class="o">.</span><span class="n">scalar</span><span class="p">()</span>
<span class="go">&lt;Item&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">session</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">Item</span><span class="o">.</span><span class="n">id</span><span class="p">)</span><span class="o">.</span><span class="n">scalar</span><span class="p">()</span>
<span class="go">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">session</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">Item</span><span class="o">.</span><span class="n">id</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">Item</span><span class="o">.</span><span class="n">id</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">scalar</span><span class="p">()</span>
<span class="go">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">session</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">Item</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">Item</span><span class="o">.</span><span class="n">name</span><span class="p">)</span><span class="o">.</span><span class="n">scalar</span><span class="p">()</span>
<span class="go">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">session</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">func</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">Parent</span><span class="o">.</span><span class="n">id</span><span class="p">))</span><span class="o">.</span><span class="n">scalar</span><span class="p">()</span>
<span class="go">20</span>
</pre></div>
</div>
<p>This results in an execution of the underlying query.</p>
</dd></dl>
<dl class="method">
<dt id="sqlalchemy_unchained.BaseQuery.select_entity_from">
<code class="sig-name descname">select_entity_from</code><span class="sig-paren">(</span><em class="sig-param">from_obj</em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy_unchained.BaseQuery.select_entity_from" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the FROM clause of this <code class="xref py py-class docutils literal notranslate"><span class="pre">Query</span></code> to a
core selectable, applying it as a replacement FROM clause
for corresponding mapped entities.</p>
<p>The <code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.select_entity_from()</span></code> method supplies an alternative
approach to the use case of applying an <code class="xref py py-func docutils literal notranslate"><span class="pre">aliased()</span></code> construct
explicitly throughout a query.  Instead of referring to the
<code class="xref py py-func docutils literal notranslate"><span class="pre">aliased()</span></code> construct explicitly,
<code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.select_entity_from()</span></code> automatically <em>adapts</em> all
occurrences of the entity to the target selectable.</p>
<p>Given a case for <code class="xref py py-func docutils literal notranslate"><span class="pre">aliased()</span></code> such as selecting <code class="docutils literal notranslate"><span class="pre">User</span></code>
objects from a SELECT statement:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">select_stmt</span> <span class="o">=</span> <span class="n">select</span><span class="p">([</span><span class="n">User</span><span class="p">])</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">User</span><span class="o">.</span><span class="n">id</span> <span class="o">==</span> <span class="mi">7</span><span class="p">)</span>
<span class="n">user_alias</span> <span class="o">=</span> <span class="n">aliased</span><span class="p">(</span><span class="n">User</span><span class="p">,</span> <span class="n">select_stmt</span><span class="p">)</span>

<span class="n">q</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">user_alias</span><span class="p">)</span><span class="o">.</span>\
    <span class="nb">filter</span><span class="p">(</span><span class="n">user_alias</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">'ed'</span><span class="p">)</span>
</pre></div>
</div>
<p>Above, we apply the <code class="docutils literal notranslate"><span class="pre">user_alias</span></code> object explicitly throughout the
query.  When it’s not feasible for <code class="docutils literal notranslate"><span class="pre">user_alias</span></code> to be referenced
explicitly in many places, <code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.select_entity_from()</span></code> may be
used at the start of the query to adapt the existing <code class="docutils literal notranslate"><span class="pre">User</span></code> entity:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">q</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">User</span><span class="p">)</span><span class="o">.</span>\
    <span class="n">select_entity_from</span><span class="p">(</span><span class="n">select_stmt</span><span class="p">)</span><span class="o">.</span>\
    <span class="nb">filter</span><span class="p">(</span><span class="n">User</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">'ed'</span><span class="p">)</span>
</pre></div>
</div>
<p>Above, the generated SQL will show that the <code class="docutils literal notranslate"><span class="pre">User</span></code> entity is
adapted to our statement, even in the case of the WHERE clause:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span> <span class="n">anon_1</span><span class="p">.</span><span class="n">id</span> <span class="k">AS</span> <span class="n">anon_1_id</span><span class="p">,</span> <span class="n">anon_1</span><span class="p">.</span><span class="n">name</span> <span class="k">AS</span> <span class="n">anon_1_name</span>
<span class="k">FROM</span> <span class="p">(</span><span class="k">SELECT</span> <span class="ss">"user"</span><span class="p">.</span><span class="n">id</span> <span class="k">AS</span> <span class="n">id</span><span class="p">,</span> <span class="ss">"user"</span><span class="p">.</span><span class="n">name</span> <span class="k">AS</span> <span class="n">name</span>
<span class="k">FROM</span> <span class="ss">"user"</span>
<span class="k">WHERE</span> <span class="ss">"user"</span><span class="p">.</span><span class="n">id</span> <span class="o">=</span> <span class="p">:</span><span class="n">id_1</span><span class="p">)</span> <span class="k">AS</span> <span class="n">anon_1</span>
<span class="k">WHERE</span> <span class="n">anon_1</span><span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="p">:</span><span class="n">name_1</span>
</pre></div>
</div>
<p>The <code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.select_entity_from()</span></code> method is similar to the
<code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.select_from()</span></code> method, in that it sets the FROM clause
of the query.  The difference is that it additionally applies
adaptation to the other parts of the query that refer to the
primary entity.  If above we had used <code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.select_from()</span></code>
instead, the SQL generated would have been:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="c1">-- uses plain select_from(), not select_entity_from()</span>
<span class="k">SELECT</span> <span class="ss">"user"</span><span class="p">.</span><span class="n">id</span> <span class="k">AS</span> <span class="n">user_id</span><span class="p">,</span> <span class="ss">"user"</span><span class="p">.</span><span class="n">name</span> <span class="k">AS</span> <span class="n">user_name</span>
<span class="k">FROM</span> <span class="ss">"user"</span><span class="p">,</span> <span class="p">(</span><span class="k">SELECT</span> <span class="ss">"user"</span><span class="p">.</span><span class="n">id</span> <span class="k">AS</span> <span class="n">id</span><span class="p">,</span> <span class="ss">"user"</span><span class="p">.</span><span class="n">name</span> <span class="k">AS</span> <span class="n">name</span>
<span class="k">FROM</span> <span class="ss">"user"</span>
<span class="k">WHERE</span> <span class="ss">"user"</span><span class="p">.</span><span class="n">id</span> <span class="o">=</span> <span class="p">:</span><span class="n">id_1</span><span class="p">)</span> <span class="k">AS</span> <span class="n">anon_1</span>
<span class="k">WHERE</span> <span class="ss">"user"</span><span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="p">:</span><span class="n">name_1</span>
</pre></div>
</div>
<p>To supply textual SQL to the <code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.select_entity_from()</span></code> method,
we can make use of the <code class="xref py py-func docutils literal notranslate"><span class="pre">text()</span></code> construct.  However, the
<code class="xref py py-func docutils literal notranslate"><span class="pre">text()</span></code> construct needs to be aligned with the columns of our
entity, which is achieved by making use of the
<code class="xref py py-meth docutils literal notranslate"><span class="pre">TextClause.columns()</span></code> method:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">text_stmt</span> <span class="o">=</span> <span class="n">text</span><span class="p">(</span><span class="s2">"select id, name from user"</span><span class="p">)</span><span class="o">.</span><span class="n">columns</span><span class="p">(</span>
    <span class="n">User</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">User</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
<span class="n">q</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">User</span><span class="p">)</span><span class="o">.</span><span class="n">select_entity_from</span><span class="p">(</span><span class="n">text_stmt</span><span class="p">)</span>
</pre></div>
</div>
<p><code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.select_entity_from()</span></code> itself accepts an <code class="xref py py-func docutils literal notranslate"><span class="pre">aliased()</span></code>
object, so that the special options of <code class="xref py py-func docutils literal notranslate"><span class="pre">aliased()</span></code> such as
<a href="#id3"><span class="problematic" id="id4">:paramref:`.aliased.adapt_on_names`</span></a> may be used within the
scope of the <code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.select_entity_from()</span></code> method’s adaptation
services.  Suppose
a view <code class="docutils literal notranslate"><span class="pre">user_view</span></code> also returns rows from <code class="docutils literal notranslate"><span class="pre">user</span></code>.    If
we reflect this view into a <code class="xref py py-class docutils literal notranslate"><span class="pre">Table</span></code>, this view has no
relationship to the <code class="xref py py-class docutils literal notranslate"><span class="pre">Table</span></code> to which we are mapped, however
we can use name matching to select from it:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">user_view</span> <span class="o">=</span> <span class="n">Table</span><span class="p">(</span><span class="s1">'user_view'</span><span class="p">,</span> <span class="n">metadata</span><span class="p">,</span>
                  <span class="n">autoload_with</span><span class="o">=</span><span class="n">engine</span><span class="p">)</span>
<span class="n">user_view_alias</span> <span class="o">=</span> <span class="n">aliased</span><span class="p">(</span>
    <span class="n">User</span><span class="p">,</span> <span class="n">user_view</span><span class="p">,</span> <span class="n">adapt_on_names</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">q</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">User</span><span class="p">)</span><span class="o">.</span>\
    <span class="n">select_entity_from</span><span class="p">(</span><span class="n">user_view_alias</span><span class="p">)</span><span class="o">.</span>\
    <span class="n">order_by</span><span class="p">(</span><span class="n">User</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</pre></div>
</div>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 1.1.7: </span>The <code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.select_entity_from()</span></code>
method now accepts an <code class="xref py py-func docutils literal notranslate"><span class="pre">aliased()</span></code> object as an alternative
to a <code class="xref py py-class docutils literal notranslate"><span class="pre">FromClause</span></code> object.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>from_obj</strong> – a <code class="xref py py-class docutils literal notranslate"><span class="pre">FromClause</span></code> object that will replace
the FROM clause of this <code class="xref py py-class docutils literal notranslate"><span class="pre">Query</span></code>.  It also may be an instance
of <code class="xref py py-func docutils literal notranslate"><span class="pre">aliased()</span></code>.</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.select_from()</span></code></p>
</div>
</dd></dl>
<dl class="method">
<dt id="sqlalchemy_unchained.BaseQuery.select_from">
<code class="sig-name descname">select_from</code><span class="sig-paren">(</span><em class="sig-param">*from_obj</em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy_unchained.BaseQuery.select_from" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the FROM clause of this <code class="xref py py-class docutils literal notranslate"><span class="pre">Query</span></code> explicitly.</p>
<p><code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.select_from()</span></code> is often used in conjunction with
<code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.join()</span></code> in order to control which entity is selected
from on the “left” side of the join.</p>
<p>The entity or selectable object here effectively replaces the
“left edge” of any calls to <code class="xref py py-meth docutils literal notranslate"><span class="pre">join()</span></code>, when no
joinpoint is otherwise established - usually, the default “join
point” is the leftmost entity in the <code class="xref py py-class docutils literal notranslate"><span class="pre">Query</span></code> object’s
list of entities to be selected.</p>
<p>A typical example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">q</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">Address</span><span class="p">)</span><span class="o">.</span><span class="n">select_from</span><span class="p">(</span><span class="n">User</span><span class="p">)</span><span class="o">.</span>\
    <span class="n">join</span><span class="p">(</span><span class="n">User</span><span class="o">.</span><span class="n">addresses</span><span class="p">)</span><span class="o">.</span>\
    <span class="nb">filter</span><span class="p">(</span><span class="n">User</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">'ed'</span><span class="p">)</span>
</pre></div>
</div>
<p>Which produces SQL equivalent to:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SELECT</span> <span class="n">address</span><span class="o">.*</span> <span class="n">FROM</span> <span class="n">user</span>
<span class="n">JOIN</span> <span class="n">address</span> <span class="n">ON</span> <span class="n">user</span><span class="o">.</span><span class="n">id</span><span class="o">=</span><span class="n">address</span><span class="o">.</span><span class="n">user_id</span>
<span class="n">WHERE</span> <span class="n">user</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="p">:</span><span class="n">name_1</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>*from_obj</strong> – collection of one or more entities to apply
to the FROM clause.  Entities can be mapped classes,
<code class="xref py py-class docutils literal notranslate"><span class="pre">AliasedClass</span></code> objects, <code class="xref py py-class docutils literal notranslate"><span class="pre">Mapper</span></code> objects
as well as core <code class="xref py py-class docutils literal notranslate"><span class="pre">FromClause</span></code> elements like subqueries.</p>
</dd>
</dl>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 0.9: </span>This method no longer applies the given FROM object
to be the selectable from which matching entities
select from; the <a class="reference internal" href="#sqlalchemy_unchained.BaseQuery.select_entity_from" title="sqlalchemy_unchained.BaseQuery.select_entity_from"><code class="xref py py-meth docutils literal notranslate"><span class="pre">select_entity_from()</span></code></a> method
now accomplishes this.  See that method for a description
of this behavior.</p>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><code class="xref py py-meth docutils literal notranslate"><span class="pre">join()</span></code></p>
<p><code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.select_entity_from()</span></code></p>
</div>
</dd></dl>
<dl class="method">
<dt id="sqlalchemy_unchained.BaseQuery.selectable">
<em class="property">property </em><code class="sig-name descname">selectable</code><a class="headerlink" href="#sqlalchemy_unchained.BaseQuery.selectable" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the <code class="xref py py-class docutils literal notranslate"><span class="pre">Select</span></code> object emitted by this <code class="xref py py-class docutils literal notranslate"><span class="pre">Query</span></code>.</p>
<p>Used for <code class="xref py py-func docutils literal notranslate"><span class="pre">inspect()</span></code> compatibility, this is equivalent to:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">query</span><span class="o">.</span><span class="n">enable_eagerloads</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">with_labels</span><span class="p">()</span><span class="o">.</span><span class="n">statement</span>
</pre></div>
</div>
</dd></dl>
<dl class="method">
<dt id="sqlalchemy_unchained.BaseQuery.slice">
<code class="sig-name descname">slice</code><span class="sig-paren">(</span><em class="sig-param">start</em>, <em class="sig-param">stop</em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy_unchained.BaseQuery.slice" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the “slice” of the <code class="xref py py-class docutils literal notranslate"><span class="pre">Query</span></code> represented by
the given indices and returns the resulting <code class="xref py py-class docutils literal notranslate"><span class="pre">Query</span></code>.</p>
<p>The start and stop indices behave like the argument to Python’s
built-in <code class="xref py py-func docutils literal notranslate"><span class="pre">range()</span></code> function. This method provides an
alternative to using <code class="docutils literal notranslate"><span class="pre">LIMIT</span></code>/<code class="docutils literal notranslate"><span class="pre">OFFSET</span></code> to get a slice of the
query.</p>
<p>For example,</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">session</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">User</span><span class="p">)</span><span class="o">.</span><span class="n">order_by</span><span class="p">(</span><span class="n">User</span><span class="o">.</span><span class="n">id</span><span class="p">)</span><span class="o">.</span><span class="n">slice</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
<p>renders as</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span> <span class="n">users</span><span class="p">.</span><span class="n">id</span> <span class="k">AS</span> <span class="n">users_id</span><span class="p">,</span>
       <span class="n">users</span><span class="p">.</span><span class="n">name</span> <span class="k">AS</span> <span class="n">users_name</span>
<span class="k">FROM</span> <span class="n">users</span> <span class="k">ORDER</span> <span class="k">BY</span> <span class="n">users</span><span class="p">.</span><span class="n">id</span>
<span class="k">LIMIT</span> <span class="o">?</span> <span class="k">OFFSET</span> <span class="o">?</span>
<span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.limit()</span></code></p>
<p><code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.offset()</span></code></p>
</div>
</dd></dl>
<dl class="method">
<dt id="sqlalchemy_unchained.BaseQuery.statement">
<em class="property">property </em><code class="sig-name descname">statement</code><a class="headerlink" href="#sqlalchemy_unchained.BaseQuery.statement" title="Permalink to this definition">¶</a></dt>
<dd><p>The full SELECT statement represented by this Query.</p>
<p>The statement by default will not have disambiguating labels
applied to the construct unless with_labels(True) is called
first.</p>
</dd></dl>
<dl class="method">
<dt id="sqlalchemy_unchained.BaseQuery.subquery">
<code class="sig-name descname">subquery</code><span class="sig-paren">(</span><em class="sig-param">name=None</em>, <em class="sig-param">with_labels=False</em>, <em class="sig-param">reduce_columns=False</em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy_unchained.BaseQuery.subquery" title="Permalink to this definition">¶</a></dt>
<dd><p>return the full SELECT statement represented by
this <code class="xref py py-class docutils literal notranslate"><span class="pre">Query</span></code>, embedded within an <code class="xref py py-class docutils literal notranslate"><span class="pre">Alias</span></code>.</p>
<p>Eager JOIN generation within the query is disabled.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> – string name to be assigned as the alias;
this is passed through to <code class="xref py py-meth docutils literal notranslate"><span class="pre">FromClause.alias()</span></code>.
If <code class="docutils literal notranslate"><span class="pre">None</span></code>, a name will be deterministically generated
at compile time.</p></li>
<li><p><strong>with_labels</strong> – if True, <a class="reference internal" href="#sqlalchemy_unchained.BaseQuery.with_labels" title="sqlalchemy_unchained.BaseQuery.with_labels"><code class="xref py py-meth docutils literal notranslate"><span class="pre">with_labels()</span></code></a> will be called
on the <code class="xref py py-class docutils literal notranslate"><span class="pre">Query</span></code> first to apply table-qualified labels
to all columns.</p></li>
<li><p><strong>reduce_columns</strong> – if True, <code class="xref py py-meth docutils literal notranslate"><span class="pre">Select.reduce_columns()</span></code> will
be called on the resulting <code class="xref py py-func docutils literal notranslate"><span class="pre">select()</span></code> construct,
to remove same-named columns where one also refers to the other
via foreign key or WHERE clause equivalence.</p></li>
</ul>
</dd>
</dl>
</dd></dl>
<dl class="method">
<dt id="sqlalchemy_unchained.BaseQuery.suffix_with">
<code class="sig-name descname">suffix_with</code><span class="sig-paren">(</span><em class="sig-param">*suffixes</em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy_unchained.BaseQuery.suffix_with" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply the suffix to the query and return the newly resulting
<code class="docutils literal notranslate"><span class="pre">Query</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>*suffixes</strong> – optional suffixes, typically strings,
not using any commas.</p>
</dd>
</dl>
<div class="versionadded">
<p><span class="versionmodified added">New in version 1.0.0.</span></p>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.prefix_with()</span></code></p>
<p><code class="xref py py-meth docutils literal notranslate"><span class="pre">HasSuffixes.suffix_with()</span></code></p>
</div>
</dd></dl>
<dl class="method">
<dt id="sqlalchemy_unchained.BaseQuery.union">
<code class="sig-name descname">union</code><span class="sig-paren">(</span><em class="sig-param">*q</em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy_unchained.BaseQuery.union" title="Permalink to this definition">¶</a></dt>
<dd><p>Produce a UNION of this Query against one or more queries.</p>
<p>e.g.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">q1</span> <span class="o">=</span> <span class="n">sess</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">SomeClass</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">SomeClass</span><span class="o">.</span><span class="n">foo</span><span class="o">==</span><span class="s1">'bar'</span><span class="p">)</span>
<span class="n">q2</span> <span class="o">=</span> <span class="n">sess</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">SomeClass</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">SomeClass</span><span class="o">.</span><span class="n">bar</span><span class="o">==</span><span class="s1">'foo'</span><span class="p">)</span>

<span class="n">q3</span> <span class="o">=</span> <span class="n">q1</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="n">q2</span><span class="p">)</span>
</pre></div>
</div>
<p>The method accepts multiple Query objects so as to control
the level of nesting.  A series of <code class="docutils literal notranslate"><span class="pre">union()</span></code> calls such as:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="n">z</span><span class="p">)</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
</pre></div>
</div>
<p>will nest on each <code class="docutils literal notranslate"><span class="pre">union()</span></code>, and produces:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SELECT</span> <span class="o">*</span> <span class="n">FROM</span> <span class="p">(</span><span class="n">SELECT</span> <span class="o">*</span> <span class="n">FROM</span> <span class="p">(</span><span class="n">SELECT</span> <span class="o">*</span> <span class="n">FROM</span> <span class="n">X</span> <span class="n">UNION</span>
                <span class="n">SELECT</span> <span class="o">*</span> <span class="n">FROM</span> <span class="n">y</span><span class="p">)</span> <span class="n">UNION</span> <span class="n">SELECT</span> <span class="o">*</span> <span class="n">FROM</span> <span class="n">Z</span><span class="p">)</span>
</pre></div>
</div>
<p>Whereas:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">)</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
</pre></div>
</div>
<p>produces:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SELECT</span> <span class="o">*</span> <span class="n">FROM</span> <span class="p">(</span><span class="n">SELECT</span> <span class="o">*</span> <span class="n">FROM</span> <span class="n">X</span> <span class="n">UNION</span> <span class="n">SELECT</span> <span class="o">*</span> <span class="n">FROM</span> <span class="n">y</span> <span class="n">UNION</span>
                <span class="n">SELECT</span> <span class="o">*</span> <span class="n">FROM</span> <span class="n">Z</span><span class="p">)</span>
</pre></div>
</div>
<p>Note that many database backends do not allow ORDER BY to
be rendered on a query called within UNION, EXCEPT, etc.
To disable all ORDER BY clauses including those configured
on mappers, issue <code class="docutils literal notranslate"><span class="pre">query.order_by(None)</span></code> - the resulting
<code class="xref py py-class docutils literal notranslate"><span class="pre">Query</span></code> object will not render ORDER BY within
its SELECT statement.</p>
</dd></dl>
<dl class="method">
<dt id="sqlalchemy_unchained.BaseQuery.union_all">
<code class="sig-name descname">union_all</code><span class="sig-paren">(</span><em class="sig-param">*q</em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy_unchained.BaseQuery.union_all" title="Permalink to this definition">¶</a></dt>
<dd><p>Produce a UNION ALL of this Query against one or more queries.</p>
<p>Works the same way as <a class="reference external" href="https://docs.sqlalchemy.org/en/13/orm/query.html#sqlalchemy.orm.query.Query.union" title="(in SQLAlchemy v1.3)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">union()</span></code></a>. See
that method for usage examples.</p>
</dd></dl>
<dl class="method">
<dt id="sqlalchemy_unchained.BaseQuery.update">
<code class="sig-name descname">update</code><span class="sig-paren">(</span><em class="sig-param">values</em>, <em class="sig-param">synchronize_session='evaluate'</em>, <em class="sig-param">update_args=None</em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy_unchained.BaseQuery.update" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform a bulk update query.</p>
<p>Updates rows matched by this query in the database.</p>
<p>E.g.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sess</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">User</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">User</span><span class="o">.</span><span class="n">age</span> <span class="o">==</span> <span class="mi">25</span><span class="p">)</span><span class="o">.</span>\
    <span class="n">update</span><span class="p">({</span><span class="n">User</span><span class="o">.</span><span class="n">age</span><span class="p">:</span> <span class="n">User</span><span class="o">.</span><span class="n">age</span> <span class="o">-</span> <span class="mi">10</span><span class="p">},</span> <span class="n">synchronize_session</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="n">sess</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">User</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">User</span><span class="o">.</span><span class="n">age</span> <span class="o">==</span> <span class="mi">25</span><span class="p">)</span><span class="o">.</span>\
    <span class="n">update</span><span class="p">({</span><span class="s2">"age"</span><span class="p">:</span> <span class="n">User</span><span class="o">.</span><span class="n">age</span> <span class="o">-</span> <span class="mi">10</span><span class="p">},</span> <span class="n">synchronize_session</span><span class="o">=</span><span class="s1">'evaluate'</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The <code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.update()</span></code> method is a “bulk” operation,
which bypasses ORM unit-of-work automation in favor of greater
performance.  <strong>Please read all caveats and warnings below.</strong></p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>values</strong> – <p>a dictionary with attributes names, or alternatively
mapped attributes or SQL expressions, as keys, and literal
values or sql expressions as values.   If <a class="reference external" href="https://docs.sqlalchemy.org/en/13/core/tutorial.html#updates-order-parameters" title="(in SQLAlchemy v1.3)"><span class="xref std std-ref">parameter-ordered
mode</span></a> is desired, the values can be
passed as a list of 2-tuples;
this requires that the
<a href="#id5"><span class="problematic" id="id6">:paramref:`~sqlalchemy.sql.expression.update.preserve_parameter_order`</span></a>
flag is passed to the <a href="#id7"><span class="problematic" id="id8">:paramref:`.Query.update.update_args`</span></a> dictionary
as well.</p>
<blockquote>
<div><div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 1.0.0: </span>- string names in the values dictionary
are now resolved against the mapped entity; previously, these
strings were passed as literal column names with no mapper-level
translation.</p>
</div>
</div></blockquote>
</p></li>
<li><p><strong>synchronize_session</strong> – <p>chooses the strategy to update the
attributes on objects in the session. Valid values are:</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">False</span></code> - don’t synchronize the session. This option is the most
efficient and is reliable once the session is expired, which
typically occurs after a commit(), or explicitly using
expire_all(). Before the expiration, updated objects may still
remain in the session with stale values on their attributes, which
can lead to confusing results.</p>
<p><code class="docutils literal notranslate"><span class="pre">'fetch'</span></code> - performs a select query before the update to find
objects that are matched by the update query. The updated
attributes are expired on matched objects.</p>
<p><code class="docutils literal notranslate"><span class="pre">'evaluate'</span></code> - Evaluate the Query’s criteria in Python straight
on the objects in the session. If evaluation of the criteria isn’t
implemented, an exception is raised.</p>
<p>The expression evaluator currently doesn’t account for differing
string collations between the database and Python.</p>
</div></blockquote>
</p></li>
<li><p><strong>update_args</strong> – <p>Optional dictionary, if present will be passed
to the underlying <code class="xref py py-func docutils literal notranslate"><span class="pre">update()</span></code> construct as the <code class="docutils literal notranslate"><span class="pre">**kw</span></code> for
the object.  May be used to pass dialect-specific arguments such
as <code class="docutils literal notranslate"><span class="pre">mysql_limit</span></code>, as well as other special arguments such as
<a href="#id9"><span class="problematic" id="id10">:paramref:`~sqlalchemy.sql.expression.update.preserve_parameter_order`</span></a>.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version 1.0.0.</span></p>
</div>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the count of rows matched as returned by the database’s
“row count” feature.</p>
</dd>
</dl>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p><strong>Additional Caveats for bulk query updates</strong></p>
<ul>
<li><p>The method does <strong>not</strong> offer in-Python cascading of
relationships - it is assumed that ON UPDATE CASCADE is
configured for any foreign key references which require
it, otherwise the database may emit an integrity
violation if foreign key references are being enforced.</p>
<p>After the UPDATE, dependent objects in the
<code class="xref py py-class docutils literal notranslate"><span class="pre">Session</span></code> which were impacted by an ON UPDATE
CASCADE may not contain the current state; this issue is
resolved once the <code class="xref py py-class docutils literal notranslate"><span class="pre">Session</span></code> is expired, which
normally occurs upon <code class="xref py py-meth docutils literal notranslate"><span class="pre">Session.commit()</span></code> or can be
forced by using <code class="xref py py-meth docutils literal notranslate"><span class="pre">Session.expire_all()</span></code>.</p>
</li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">'fetch'</span></code> strategy results in an additional
SELECT statement emitted and will significantly reduce
performance.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">'evaluate'</span></code> strategy performs a scan of
all matching objects within the <code class="xref py py-class docutils literal notranslate"><span class="pre">Session</span></code>; if the
contents of the <code class="xref py py-class docutils literal notranslate"><span class="pre">Session</span></code> are expired, such as
via a proceeding <code class="xref py py-meth docutils literal notranslate"><span class="pre">Session.commit()</span></code> call, <strong>this will
result in SELECT queries emitted for every matching object</strong>.</p></li>
<li><p>The method supports multiple table updates, as detailed
in <a class="reference external" href="https://docs.sqlalchemy.org/en/13/core/tutorial.html#multi-table-updates" title="(in SQLAlchemy v1.3)"><span>Multiple Table Updates</span></a>, and this behavior does
extend to support updates of joined-inheritance and
other multiple table mappings.  However, the <strong>join
condition of an inheritance mapper is not
automatically rendered</strong>. Care must be taken in any
multiple-table update to explicitly include the joining
condition between those tables, even in mappings where
this is normally automatic. E.g. if a class <code class="docutils literal notranslate"><span class="pre">Engineer</span></code>
subclasses <code class="docutils literal notranslate"><span class="pre">Employee</span></code>, an UPDATE of the <code class="docutils literal notranslate"><span class="pre">Engineer</span></code>
local table using criteria against the <code class="docutils literal notranslate"><span class="pre">Employee</span></code>
local table might look like:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">session</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">Engineer</span><span class="p">)</span><span class="o">.</span>\
    <span class="nb">filter</span><span class="p">(</span><span class="n">Engineer</span><span class="o">.</span><span class="n">id</span> <span class="o">==</span> <span class="n">Employee</span><span class="o">.</span><span class="n">id</span><span class="p">)</span><span class="o">.</span>\
    <span class="nb">filter</span><span class="p">(</span><span class="n">Employee</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">'dilbert'</span><span class="p">)</span><span class="o">.</span>\
    <span class="n">update</span><span class="p">({</span><span class="s2">"engineer_type"</span><span class="p">:</span> <span class="s2">"programmer"</span><span class="p">})</span>
</pre></div>
</div>
</li>
<li><p>The polymorphic identity WHERE criteria is <strong>not</strong> included
for single- or
joined- table updates - this must be added <strong>manually</strong>, even
for single table inheritance.</p></li>
<li><p>The <code class="xref py py-meth docutils literal notranslate"><span class="pre">MapperEvents.before_update()</span></code> and
<code class="xref py py-meth docutils literal notranslate"><span class="pre">MapperEvents.after_update()</span></code>
events <strong>are not invoked from this method</strong>.  Instead, the
<code class="xref py py-meth docutils literal notranslate"><span class="pre">SessionEvents.after_bulk_update()</span></code> method is provided to
act upon a mass UPDATE of entity rows.</p></li>
</ul>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.delete()</span></code></p>
<p><a class="reference external" href="https://docs.sqlalchemy.org/en/13/core/tutorial.html#inserts-and-updates" title="(in SQLAlchemy v1.3)"><span>Inserts, Updates and Deletes</span></a> - Core SQL tutorial</p>
</div>
</dd></dl>
<dl class="method">
<dt id="sqlalchemy_unchained.BaseQuery.value">
<code class="sig-name descname">value</code><span class="sig-paren">(</span><em class="sig-param">column</em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy_unchained.BaseQuery.value" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a scalar result corresponding to the given
column expression.</p>
</dd></dl>
<dl class="method">
<dt id="sqlalchemy_unchained.BaseQuery.values">
<code class="sig-name descname">values</code><span class="sig-paren">(</span><em class="sig-param">*columns</em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy_unchained.BaseQuery.values" title="Permalink to this definition">¶</a></dt>
<dd><p>Return an iterator yielding result tuples corresponding
to the given list of columns</p>
</dd></dl>
<dl class="method">
<dt id="sqlalchemy_unchained.BaseQuery.whereclause">
<em class="property">property </em><code class="sig-name descname">whereclause</code><a class="headerlink" href="#sqlalchemy_unchained.BaseQuery.whereclause" title="Permalink to this definition">¶</a></dt>
<dd><p>A readonly attribute which returns the current WHERE criterion for
this Query.</p>
<p>This returned value is a SQL expression construct, or <code class="docutils literal notranslate"><span class="pre">None</span></code> if no
criterion has been established.</p>
</dd></dl>
<dl class="method">
<dt id="sqlalchemy_unchained.BaseQuery.with_entities">
<code class="sig-name descname">with_entities</code><span class="sig-paren">(</span><em class="sig-param">*entities</em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy_unchained.BaseQuery.with_entities" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a new <code class="xref py py-class docutils literal notranslate"><span class="pre">Query</span></code> replacing the SELECT list with the
given entities.</p>
<p>e.g.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Users, filtered on some arbitrary criterion</span>
<span class="c1"># and then ordered by related email address</span>
<span class="n">q</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">User</span><span class="p">)</span><span class="o">.</span>\
            <span class="n">join</span><span class="p">(</span><span class="n">User</span><span class="o">.</span><span class="n">address</span><span class="p">)</span><span class="o">.</span>\
            <span class="nb">filter</span><span class="p">(</span><span class="n">User</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">like</span><span class="p">(</span><span class="s1">'</span><span class="si">%e</span><span class="s1">d%'</span><span class="p">))</span><span class="o">.</span>\
            <span class="n">order_by</span><span class="p">(</span><span class="n">Address</span><span class="o">.</span><span class="n">email</span><span class="p">)</span>

<span class="c1"># given *only* User.id==5, Address.email, and 'q', what</span>
<span class="c1"># would the *next* User in the result be ?</span>
<span class="n">subq</span> <span class="o">=</span> <span class="n">q</span><span class="o">.</span><span class="n">with_entities</span><span class="p">(</span><span class="n">Address</span><span class="o">.</span><span class="n">email</span><span class="p">)</span><span class="o">.</span>\
            <span class="n">order_by</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span><span class="o">.</span>\
            <span class="nb">filter</span><span class="p">(</span><span class="n">User</span><span class="o">.</span><span class="n">id</span><span class="o">==</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span>\
            <span class="n">subquery</span><span class="p">()</span>
<span class="n">q</span> <span class="o">=</span> <span class="n">q</span><span class="o">.</span><span class="n">join</span><span class="p">((</span><span class="n">subq</span><span class="p">,</span> <span class="n">subq</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">email</span> <span class="o">&lt;</span> <span class="n">Address</span><span class="o">.</span><span class="n">email</span><span class="p">))</span><span class="o">.</span>\
            <span class="n">limit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>
<dl class="method">
<dt id="sqlalchemy_unchained.BaseQuery.with_for_update">
<code class="sig-name descname">with_for_update</code><span class="sig-paren">(</span><em class="sig-param">read=False</em>, <em class="sig-param">nowait=False</em>, <em class="sig-param">of=None</em>, <em class="sig-param">skip_locked=False</em>, <em class="sig-param">key_share=False</em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy_unchained.BaseQuery.with_for_update" title="Permalink to this definition">¶</a></dt>
<dd><p>return a new <code class="xref py py-class docutils literal notranslate"><span class="pre">Query</span></code> with the specified options for the
<code class="docutils literal notranslate"><span class="pre">FOR</span> <span class="pre">UPDATE</span></code> clause.</p>
<p>The behavior of this method is identical to that of
<code class="xref py py-meth docutils literal notranslate"><span class="pre">SelectBase.with_for_update()</span></code>.  When called with no arguments,
the resulting <code class="docutils literal notranslate"><span class="pre">SELECT</span></code> statement will have a <code class="docutils literal notranslate"><span class="pre">FOR</span> <span class="pre">UPDATE</span></code> clause
appended.  When additional arguments are specified, backend-specific
options such as <code class="docutils literal notranslate"><span class="pre">FOR</span> <span class="pre">UPDATE</span> <span class="pre">NOWAIT</span></code> or <code class="docutils literal notranslate"><span class="pre">LOCK</span> <span class="pre">IN</span> <span class="pre">SHARE</span> <span class="pre">MODE</span></code>
can take effect.</p>
<p>E.g.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">q</span> <span class="o">=</span> <span class="n">sess</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">User</span><span class="p">)</span><span class="o">.</span><span class="n">with_for_update</span><span class="p">(</span><span class="n">nowait</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">of</span><span class="o">=</span><span class="n">User</span><span class="p">)</span>
</pre></div>
</div>
<p>The above query on a PostgreSQL backend will render like:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SELECT</span> <span class="n">users</span><span class="o">.</span><span class="n">id</span> <span class="n">AS</span> <span class="n">users_id</span> <span class="n">FROM</span> <span class="n">users</span> <span class="n">FOR</span> <span class="n">UPDATE</span> <span class="n">OF</span> <span class="n">users</span> <span class="n">NOWAIT</span>
</pre></div>
</div>
<div class="versionadded">
<p><span class="versionmodified added">New in version 0.9.0: </span><code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.with_for_update()</span></code> supersedes
the <code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.with_lockmode()</span></code> method.</p>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><code class="xref py py-meth docutils literal notranslate"><span class="pre">GenerativeSelect.with_for_update()</span></code> - Core level method with
full argument and behavioral description.</p>
</div>
</dd></dl>
<dl class="method">
<dt id="sqlalchemy_unchained.BaseQuery.with_hint">
<code class="sig-name descname">with_hint</code><span class="sig-paren">(</span><em class="sig-param">selectable</em>, <em class="sig-param">text</em>, <em class="sig-param">dialect_name='*'</em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy_unchained.BaseQuery.with_hint" title="Permalink to this definition">¶</a></dt>
<dd><p>Add an indexing or other executional context
hint for the given entity or selectable to
this <code class="xref py py-class docutils literal notranslate"><span class="pre">Query</span></code>.</p>
<p>Functionality is passed straight through to
<a class="reference external" href="https://docs.sqlalchemy.org/en/13/core/selectable.html#sqlalchemy.sql.expression.Select.with_hint" title="(in SQLAlchemy v1.3)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">with_hint()</span></code></a>,
with the addition that <code class="docutils literal notranslate"><span class="pre">selectable</span></code> can be a
<code class="xref py py-class docutils literal notranslate"><span class="pre">Table</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Alias</span></code>, or ORM entity / mapped class
/etc.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.with_statement_hint()</span></code></p>
<p>:meth:.`.Query.prefix_with` - generic SELECT prefixing which also
can suit some database-specific HINT syntaxes such as MySQL
optimizer hints</p>
</div>
</dd></dl>
<dl class="method">
<dt id="sqlalchemy_unchained.BaseQuery.with_labels">
<code class="sig-name descname">with_labels</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy_unchained.BaseQuery.with_labels" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply column labels to the return value of Query.statement.</p>
<p>Indicates that this Query’s <cite>statement</cite> accessor should return
a SELECT statement that applies labels to all columns in the
form &lt;tablename&gt;_&lt;columnname&gt;; this is commonly used to
disambiguate columns from multiple tables which have the same
name.</p>
<p>When the <cite>Query</cite> actually issues SQL to load rows, it always
uses column labeling.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.with_labels()</span></code> method <em>only</em> applies
the output of <code class="xref py py-attr docutils literal notranslate"><span class="pre">Query.statement</span></code>, and <em>not</em> to any of
the result-row invoking systems of <code class="xref py py-class docutils literal notranslate"><span class="pre">Query</span></code> itself, e.g.
<code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.first()</span></code>, <code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.all()</span></code>, etc.   To execute
a query using <code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.with_labels()</span></code>, invoke the
<code class="xref py py-attr docutils literal notranslate"><span class="pre">Query.statement</span></code> using <code class="xref py py-meth docutils literal notranslate"><span class="pre">Session.execute()</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">result</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">query</span><span class="o">.</span><span class="n">with_labels</span><span class="p">()</span><span class="o">.</span><span class="n">statement</span><span class="p">)</span>
</pre></div>
</div>
</div>
</dd></dl>
<dl class="method">
<dt id="sqlalchemy_unchained.BaseQuery.with_lockmode">
<code class="sig-name descname">with_lockmode</code><span class="sig-paren">(</span><em class="sig-param">mode</em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy_unchained.BaseQuery.with_lockmode" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a new <code class="xref py py-class docutils literal notranslate"><span class="pre">Query</span></code> object with the specified “locking mode”,
which essentially refers to the <code class="docutils literal notranslate"><span class="pre">FOR</span> <span class="pre">UPDATE</span></code> clause.</p>
<div class="deprecated">
<p><span class="versionmodified deprecated">Deprecated since version 0.9: </span>The <code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.with_lockmode()</span></code> method is deprecated and will be removed in a future release.  Please refer to <code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.with_for_update()</span></code>. </p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>mode</strong> – <p>a string representing the desired locking mode.
Valid values are:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">None</span></code> - translates to no lockmode</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'update'</span></code> - translates to <code class="docutils literal notranslate"><span class="pre">FOR</span> <span class="pre">UPDATE</span></code>
(standard SQL, supported by most dialects)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'update_nowait'</span></code> - translates to <code class="docutils literal notranslate"><span class="pre">FOR</span> <span class="pre">UPDATE</span> <span class="pre">NOWAIT</span></code>
(supported by Oracle, PostgreSQL 8.1 upwards)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'read'</span></code> - translates to <code class="docutils literal notranslate"><span class="pre">LOCK</span> <span class="pre">IN</span> <span class="pre">SHARE</span> <span class="pre">MODE</span></code> (for MySQL),
and <code class="docutils literal notranslate"><span class="pre">FOR</span> <span class="pre">SHARE</span></code> (for PostgreSQL)</p></li>
</ul>
</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.with_for_update()</span></code> - improved API for
specifying the <code class="docutils literal notranslate"><span class="pre">FOR</span> <span class="pre">UPDATE</span></code> clause.</p>
</div>
</dd></dl>
<dl class="method">
<dt id="sqlalchemy_unchained.BaseQuery.with_parent">
<code class="sig-name descname">with_parent</code><span class="sig-paren">(</span><em class="sig-param">instance</em>, <em class="sig-param">property=None</em>, <em class="sig-param">from_entity=None</em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy_unchained.BaseQuery.with_parent" title="Permalink to this definition">¶</a></dt>
<dd><p>Add filtering criterion that relates the given instance
to a child object or collection, using its attribute state
as well as an established <code class="xref py py-func docutils literal notranslate"><span class="pre">relationship()</span></code>
configuration.</p>
<p>The method uses the <code class="xref py py-func docutils literal notranslate"><span class="pre">with_parent()</span></code> function to generate
the clause, the result of which is passed to <code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.filter()</span></code>.</p>
<p>Parameters are the same as <code class="xref py py-func docutils literal notranslate"><span class="pre">with_parent()</span></code>, with the exception
that the given property can be None, in which case a search is
performed against this <code class="xref py py-class docutils literal notranslate"><span class="pre">Query</span></code> object’s target mapper.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>instance</strong> – An instance which has some <code class="xref py py-func docutils literal notranslate"><span class="pre">relationship()</span></code>.</p></li>
<li><p><strong>property</strong> – String property name, or class-bound attribute, which indicates
what relationship from the instance should be used to reconcile the
parent/child relationship.</p></li>
<li><p><strong>from_entity</strong> – Entity in which to consider as the left side.  This defaults to the
“zero” entity of the <code class="xref py py-class docutils literal notranslate"><span class="pre">Query</span></code> itself.</p></li>
</ul>
</dd>
</dl>
</dd></dl>
<dl class="method">
<dt id="sqlalchemy_unchained.BaseQuery.with_polymorphic">
<code class="sig-name descname">with_polymorphic</code><span class="sig-paren">(</span><em class="sig-param">cls_or_mappers</em>, <em class="sig-param">selectable=None</em>, <em class="sig-param">polymorphic_on=None</em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy_unchained.BaseQuery.with_polymorphic" title="Permalink to this definition">¶</a></dt>
<dd><p>Load columns for inheriting classes.</p>
<p><code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.with_polymorphic()</span></code> applies transformations
to the “main” mapped class represented by this <code class="xref py py-class docutils literal notranslate"><span class="pre">Query</span></code>.
The “main” mapped class here means the <code class="xref py py-class docutils literal notranslate"><span class="pre">Query</span></code>
object’s first argument is a full class, i.e.
<code class="docutils literal notranslate"><span class="pre">session.query(SomeClass)</span></code>. These transformations allow additional
tables to be present in the FROM clause so that columns for a
joined-inheritance subclass are available in the query, both for the
purposes of load-time efficiency as well as the ability to use
these columns at query time.</p>
<p>See the documentation section <a class="reference external" href="https://docs.sqlalchemy.org/en/13/orm/inheritance_loading.html#with-polymorphic" title="(in SQLAlchemy v1.3)"><span>Using with_polymorphic</span></a> for
details on how this method is used.</p>
</dd></dl>
<dl class="method">
<dt id="sqlalchemy_unchained.BaseQuery.with_session">
<code class="sig-name descname">with_session</code><span class="sig-paren">(</span><em class="sig-param">session</em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy_unchained.BaseQuery.with_session" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a <code class="xref py py-class docutils literal notranslate"><span class="pre">Query</span></code> that will use the given <code class="xref py py-class docutils literal notranslate"><span class="pre">Session</span></code>.</p>
<p>While the <code class="xref py py-class docutils literal notranslate"><span class="pre">Query</span></code> object is normally instantiated using the
<code class="xref py py-meth docutils literal notranslate"><span class="pre">Session.query()</span></code> method, it is legal to build the <code class="xref py py-class docutils literal notranslate"><span class="pre">Query</span></code>
directly without necessarily using a <code class="xref py py-class docutils literal notranslate"><span class="pre">Session</span></code>.  Such a
<code class="xref py py-class docutils literal notranslate"><span class="pre">Query</span></code> object, or any <code class="xref py py-class docutils literal notranslate"><span class="pre">Query</span></code> already associated
with a different <code class="xref py py-class docutils literal notranslate"><span class="pre">Session</span></code>, can produce a new <code class="xref py py-class docutils literal notranslate"><span class="pre">Query</span></code>
object associated with a target session using this method:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sqlalchemy.orm</span> <span class="k">import</span> <span class="n">Query</span>

<span class="n">query</span> <span class="o">=</span> <span class="n">Query</span><span class="p">([</span><span class="n">MyClass</span><span class="p">])</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">MyClass</span><span class="o">.</span><span class="n">id</span> <span class="o">==</span> <span class="mi">5</span><span class="p">)</span>

<span class="n">result</span> <span class="o">=</span> <span class="n">query</span><span class="o">.</span><span class="n">with_session</span><span class="p">(</span><span class="n">my_session</span><span class="p">)</span><span class="o">.</span><span class="n">one</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>
<dl class="method">
<dt id="sqlalchemy_unchained.BaseQuery.with_statement_hint">
<code class="sig-name descname">with_statement_hint</code><span class="sig-paren">(</span><em class="sig-param">text</em>, <em class="sig-param">dialect_name='*'</em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy_unchained.BaseQuery.with_statement_hint" title="Permalink to this definition">¶</a></dt>
<dd><p>add a statement hint to this <code class="xref py py-class docutils literal notranslate"><span class="pre">Select</span></code>.</p>
<p>This method is similar to <code class="xref py py-meth docutils literal notranslate"><span class="pre">Select.with_hint()</span></code> except that
it does not require an individual table, and instead applies to the
statement as a whole.</p>
<p>This feature calls down into <code class="xref py py-meth docutils literal notranslate"><span class="pre">Select.with_statement_hint()</span></code>.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version 1.0.0.</span></p>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.with_hint()</span></code></p>
</div>
</dd></dl>
<dl class="method">
<dt id="sqlalchemy_unchained.BaseQuery.with_transformation">
<code class="sig-name descname">with_transformation</code><span class="sig-paren">(</span><em class="sig-param">fn</em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy_unchained.BaseQuery.with_transformation" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a new <code class="xref py py-class docutils literal notranslate"><span class="pre">Query</span></code> object transformed by
the given function.</p>
<p>E.g.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">filter_something</span><span class="p">(</span><span class="n">criterion</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">transform</span><span class="p">(</span><span class="n">q</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">q</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">criterion</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">transform</span>

<span class="n">q</span> <span class="o">=</span> <span class="n">q</span><span class="o">.</span><span class="n">with_transformation</span><span class="p">(</span><span class="n">filter_something</span><span class="p">(</span><span class="n">x</span><span class="o">==</span><span class="mi">5</span><span class="p">))</span>
</pre></div>
</div>
<p>This allows ad-hoc recipes to be created for <code class="xref py py-class docutils literal notranslate"><span class="pre">Query</span></code>
objects.  See the example at <a class="reference external" href="https://docs.sqlalchemy.org/en/13/orm/extensions/hybrid.html#hybrid-transformers" title="(in SQLAlchemy v1.3)"><span>Building Transformers</span></a>.</p>
</dd></dl>
<dl class="method">
<dt id="sqlalchemy_unchained.BaseQuery.yield_per">
<code class="sig-name descname">yield_per</code><span class="sig-paren">(</span><em class="sig-param">count</em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy_unchained.BaseQuery.yield_per" title="Permalink to this definition">¶</a></dt>
<dd><p>Yield only <code class="docutils literal notranslate"><span class="pre">count</span></code> rows at a time.</p>
<p>The purpose of this method is when fetching very large result sets
(&gt; 10K rows), to batch results in sub-collections and yield them
out partially, so that the Python interpreter doesn’t need to declare
very large areas of memory which is both time consuming and leads
to excessive memory use.   The performance from fetching hundreds of
thousands of rows can often double when a suitable yield-per setting
(e.g. approximately 1000) is used, even with DBAPIs that buffer
rows (which are most).</p>
<p>The <code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.yield_per()</span></code> method <strong>is not compatible
subqueryload eager loading or joinedload eager loading when
using collections</strong>.  It is potentially compatible with “select in”
eager loading, <strong>provided the database driver supports multiple,
independent cursors</strong> (pysqlite and psycopg2 are known to work,
MySQL and SQL Server ODBC drivers do not).</p>
<p>Therefore in some cases, it may be helpful to disable
eager loads, either unconditionally with
<code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.enable_eagerloads()</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">q</span> <span class="o">=</span> <span class="n">sess</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">Object</span><span class="p">)</span><span class="o">.</span><span class="n">yield_per</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span><span class="o">.</span><span class="n">enable_eagerloads</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
<p>Or more selectively using <code class="xref py py-func docutils literal notranslate"><span class="pre">lazyload()</span></code>; such as with
an asterisk to specify the default loader scheme:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">q</span> <span class="o">=</span> <span class="n">sess</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">Object</span><span class="p">)</span><span class="o">.</span><span class="n">yield_per</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span><span class="o">.</span>\
    <span class="n">options</span><span class="p">(</span><span class="n">lazyload</span><span class="p">(</span><span class="s1">'*'</span><span class="p">),</span> <span class="n">joinedload</span><span class="p">(</span><span class="n">Object</span><span class="o">.</span><span class="n">some_related</span><span class="p">))</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Use this method with caution; if the same instance is
present in more than one batch of rows, end-user changes
to attributes will be overwritten.</p>
<p>In particular, it’s usually impossible to use this setting
with eagerly loaded collections (i.e. any lazy=’joined’ or
‘subquery’) since those collections will be cleared for a
new load when encountered in a subsequent result batch.
In the case of ‘subquery’ loading, the full result for all
rows is fetched which generally defeats the purpose of
<a class="reference external" href="https://docs.sqlalchemy.org/en/13/orm/query.html#sqlalchemy.orm.query.Query.yield_per" title="(in SQLAlchemy v1.3)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">yield_per()</span></code></a>.</p>
<p>Also note that while
<a class="reference external" href="https://docs.sqlalchemy.org/en/13/orm/query.html#sqlalchemy.orm.query.Query.yield_per" title="(in SQLAlchemy v1.3)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">yield_per()</span></code></a> will set the
<code class="docutils literal notranslate"><span class="pre">stream_results</span></code> execution option to True, currently
this is only understood by
<a class="reference external" href="https://docs.sqlalchemy.org/en/13/dialects/postgresql.html#module-sqlalchemy.dialects.postgresql.psycopg2" title="(in SQLAlchemy v1.3)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">psycopg2</span></code></a>,
<a class="reference external" href="https://docs.sqlalchemy.org/en/13/dialects/mysql.html#module-sqlalchemy.dialects.mysql.mysqldb" title="(in SQLAlchemy v1.3)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">mysqldb</span></code></a> and
<a class="reference external" href="https://docs.sqlalchemy.org/en/13/dialects/mysql.html#module-sqlalchemy.dialects.mysql.pymysql" title="(in SQLAlchemy v1.3)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pymysql</span></code></a> dialects
which will stream results using server side cursors
instead of pre-buffer all rows for this query. Other
DBAPIs <strong>pre-buffer all rows</strong> before making them
available.  The memory use of raw database rows is much less
than that of an ORM-mapped object, but should still be taken into
consideration when benchmarking.</p>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.enable_eagerloads()</span></code></p>
</div>
</dd></dl>
</dd></dl>


<h2 id="sessionmanager">SessionManager<a class="headerlink" href="#sessionmanager" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="sqlalchemy_unchained.SessionManager">
<em class="property">class </em><code class="sig-prename descclassname">sqlalchemy_unchained.</code><code class="sig-name descname">SessionManager</code><a class="reference internal" href="_modules/sqlalchemy_unchained/session_manager.html#SessionManager"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sqlalchemy_unchained.SessionManager" title="Permalink to this definition">¶</a></dt>
<dd><p>The session manager for SQLAlchemy Unchained.</p>
<dl class="method">
<dt id="sqlalchemy_unchained.SessionManager.set_session_factory">
<em class="property">classmethod </em><code class="sig-name descname">set_session_factory</code><span class="sig-paren">(</span><em class="sig-param">session_factory</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sqlalchemy_unchained/session_manager.html#SessionManager.set_session_factory"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sqlalchemy_unchained.SessionManager.set_session_factory" title="Permalink to this definition">¶</a></dt>
<dd><p>Classmethod to set the session factory
<a class="reference internal" href="#sqlalchemy_unchained.SessionManager" title="sqlalchemy_unchained.SessionManager"><code class="xref py py-class docutils literal notranslate"><span class="pre">SessionManager</span></code></a> should use.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>session_factory</strong> – The session factory callable.</p>
</dd>
</dl>
</dd></dl>
<dl class="method">
<dt id="sqlalchemy_unchained.SessionManager.save">
<code class="sig-name descname">save</code><span class="sig-paren">(</span><em class="sig-param">instance: sqlalchemy_unchained.base_model.BaseModel</em>, <em class="sig-param">commit: bool = False</em><span class="sig-paren">)</span> → sqlalchemy_unchained.base_model.BaseModel<a class="reference internal" href="_modules/sqlalchemy_unchained/session_manager.html#SessionManager.save"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sqlalchemy_unchained.SessionManager.save" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a model instance to the session, optionally committing the current
transaction immediately.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>instance</strong> – The model instance to save.</p></li>
<li><p><strong>commit</strong> – Whether or not to immediately commit. <strong>WARNING:</strong> This
will commit the <em>entire</em> session, including any other model
instances that may have been added to the session but not
yet committed.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The model instance.</p>
</dd>
</dl>
</dd></dl>
<dl class="method">
<dt id="sqlalchemy_unchained.SessionManager.save_all">
<code class="sig-name descname">save_all</code><span class="sig-paren">(</span><em class="sig-param">instances: List[sqlalchemy_unchained.base_model.BaseModel], commit: bool = False</em><span class="sig-paren">)</span> → List[sqlalchemy_unchained.base_model.BaseModel]<a class="reference internal" href="_modules/sqlalchemy_unchained/session_manager.html#SessionManager.save_all"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sqlalchemy_unchained.SessionManager.save_all" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds a list of model instances to the session, optionally committing the
current transaction immediately.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>instances</strong> – The list of model instance to save.</p></li>
<li><p><strong>commit</strong> – Whether or not to immediately commit. <strong>WARNING:</strong> This
will commit the <em>entire</em> session, including any other model
instances that may have been added to the session but not
yet committed.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The list of model instances.</p>
</dd>
</dl>
</dd></dl>
<dl class="method">
<dt id="sqlalchemy_unchained.SessionManager.commit">
<code class="sig-name descname">commit</code><span class="sig-paren">(</span><span class="sig-paren">)</span> → None<a class="reference internal" href="_modules/sqlalchemy_unchained/session_manager.html#SessionManager.commit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sqlalchemy_unchained.SessionManager.commit" title="Permalink to this definition">¶</a></dt>
<dd><p>Commits the current transaction.</p>
</dd></dl>
<dl class="method">
<dt id="sqlalchemy_unchained.SessionManager.no_autoflush">
<em class="property">property </em><code class="sig-name descname">no_autoflush</code><a class="headerlink" href="#sqlalchemy_unchained.SessionManager.no_autoflush" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a context manager that disables autoflush.</p>
<p>e.g.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">session</span><span class="o">.</span><span class="n">no_autoflush</span><span class="p">:</span>

    <span class="n">some_object</span> <span class="o">=</span> <span class="n">SomeClass</span><span class="p">()</span>
    <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">some_object</span><span class="p">)</span>
    <span class="c1"># won't autoflush</span>
    <span class="n">some_object</span><span class="o">.</span><span class="n">related_thing</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">SomeRelated</span><span class="p">)</span><span class="o">.</span><span class="n">first</span><span class="p">()</span>
</pre></div>
</div>
<p>Operations that proceed within the <code class="docutils literal notranslate"><span class="pre">with:</span></code> block will not be subject to
flushes occurring upon query access.  This is useful when initializing a
series of objects which involve existing database queries, where the
uncompleted object should not yet be flushed.</p>
</dd></dl>
</dd></dl>


<h2 id="modelmanager">ModelManager<a class="headerlink" href="#modelmanager" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="sqlalchemy_unchained.ModelManager">
<em class="property">class </em><code class="sig-prename descclassname">sqlalchemy_unchained.</code><code class="sig-name descname">ModelManager</code><a class="reference internal" href="_modules/sqlalchemy_unchained/model_manager.html#ModelManager"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sqlalchemy_unchained.ModelManager" title="Permalink to this definition">¶</a></dt>
<dd><p>Base class for model managers. This is the <strong>strongly</strong> preferred pattern for
managing all interactions with the database for models when using an ORM that
implements the Data Mapper pattern (which SQLAlchemy does). You should create a
subclass of <code class="docutils literal notranslate"><span class="pre">ModelManager</span></code> for every model in your app, customizing the
<a class="reference internal" href="#sqlalchemy_unchained.ModelManager.create" title="sqlalchemy_unchained.ModelManager.create"><code class="xref py py-meth docutils literal notranslate"><span class="pre">create()</span></code></a> method, and add any custom
query methods you may need <em>here</em>, instead of on the model class as popularized
by the Active Record pattern (which SQLAlchemy is <em>not</em>).</p>
<p>For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">your_package</span> <span class="k">import</span> <span class="n">db</span>


<span class="k">class</span> <span class="nc">Foobar</span><span class="p">(</span><span class="n">db</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">Column</span><span class="p">(</span><span class="n">db</span><span class="o">.</span><span class="n">String</span><span class="p">,</span> <span class="n">nullable</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">optional</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">Column</span><span class="p">(</span><span class="n">db</span><span class="o">.</span><span class="n">String</span><span class="p">,</span> <span class="n">nullable</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">FoobarManager</span><span class="p">(</span><span class="n">db</span><span class="o">.</span><span class="n">ModelManager</span><span class="p">):</span>
    <span class="k">class</span> <span class="nc">Meta</span><span class="p">:</span>
        <span class="n">model</span> <span class="o">=</span> <span class="n">Foobar</span>

    <span class="k">def</span> <span class="nf">create</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">optional</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">commit</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="n">optional</span><span class="o">=</span><span class="n">optional</span><span class="p">,</span> <span class="n">commit</span><span class="o">=</span><span class="n">commit</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">find_by_name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_by</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
</pre></div>
</div>
<p>Subclasses of <a class="reference internal" href="#sqlalchemy_unchained.ModelManager" title="sqlalchemy_unchained.ModelManager"><code class="xref py py-class docutils literal notranslate"><span class="pre">ModelManager</span></code></a> are singletons, and as
such, anytime you call <code class="docutils literal notranslate"><span class="pre">YourModelManager()</span></code>, you will get the same instance
back.</p>
<table id="id11">
<caption><span class="caption-text">Available <a class="reference internal" href="#sqlalchemy_unchained.ModelManager" title="sqlalchemy_unchained.ModelManager"><code class="xref py py-class docutils literal notranslate"><span class="pre">ModelManager</span></code></a> Meta options</span><a class="headerlink" href="#id11" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 33%"/>
<col style="width: 33%"/>
<col style="width: 33%"/>
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Meta option name</p></th>
<th class="head"><p>type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>abstract</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">bool</span></code></p></td>
<td><p>Whether or not this class should be considered abstract.</p></td>
</tr>
<tr class="row-odd"><td><p>model</p></td>
<td><p>Type[db.Model]</p></td>
<td><p>The model class this manager is for. Required, unless the class is marked abstract.</p></td>
</tr>
</tbody>
</table>
<dl class="attribute">
<dt id="sqlalchemy_unchained.ModelManager.query">
<code class="sig-name descname">query</code><a class="headerlink" href="#sqlalchemy_unchained.ModelManager.query" title="Permalink to this definition">¶</a></dt>
<dd><p>The <a class="reference internal" href="#sqlalchemy_unchained.BaseQuery" title="sqlalchemy_unchained.BaseQuery"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseQuery</span></code></a> for this manager’s model.</p>
</dd></dl>
<dl class="attribute">
<dt id="sqlalchemy_unchained.ModelManager.q">
<code class="sig-name descname">q</code><a class="headerlink" href="#sqlalchemy_unchained.ModelManager.q" title="Permalink to this definition">¶</a></dt>
<dd><p>An alias for <a class="reference internal" href="#sqlalchemy_unchained.ModelManager.query" title="sqlalchemy_unchained.ModelManager.query"><code class="xref py py-attr docutils literal notranslate"><span class="pre">query</span></code></a>.</p>
</dd></dl>
<dl class="method">
<dt id="sqlalchemy_unchained.ModelManager.create">
<code class="sig-name descname">create</code><span class="sig-paren">(</span><em class="sig-param">commit: bool = False</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span> → sqlalchemy_unchained.base_model.BaseModel<a class="reference internal" href="_modules/sqlalchemy_unchained/model_manager.html#ModelManager.create"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sqlalchemy_unchained.ModelManager.create" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates an instance of <code class="docutils literal notranslate"><span class="pre">self.Meta.model</span></code>, optionally committing the
current session transaction.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>commit</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a>) – Whether or not to commit the current session transaction.</p></li>
<li><p><strong>kwargs</strong> – The data to initialize the model with.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The created model instance.</p>
</dd>
</dl>
</dd></dl>
<dl class="method">
<dt id="sqlalchemy_unchained.ModelManager.get_or_create">
<code class="sig-name descname">get_or_create</code><span class="sig-paren">(</span><em class="sig-param">defaults: dict = None</em>, <em class="sig-param">commit: bool = False</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span> → Tuple[sqlalchemy_unchained.base_model.BaseModel, bool]<a class="reference internal" href="_modules/sqlalchemy_unchained/model_manager.html#ModelManager.get_or_create"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sqlalchemy_unchained.ModelManager.get_or_create" title="Permalink to this definition">¶</a></dt>
<dd><p>Get or create an instance of <code class="docutils literal notranslate"><span class="pre">self.Meta.model</span></code> by <code class="docutils literal notranslate"><span class="pre">kwargs</span></code> and
<code class="docutils literal notranslate"><span class="pre">defaults</span></code>, optionally committing te current session transaction.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>defaults</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.8)"><em>dict</em></a>) – Extra values to create the model with, if not found</p></li>
<li><p><strong>commit</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a>) – Whether or not to commit the current session transaction.</p></li>
<li><p><strong>kwargs</strong> – The values to filter by and create the model with</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Tuple[the_model_instance, did_create_bool]</p>
</dd>
</dl>
</dd></dl>
<dl class="method">
<dt id="sqlalchemy_unchained.ModelManager.update">
<code class="sig-name descname">update</code><span class="sig-paren">(</span><em class="sig-param">instance: sqlalchemy_unchained.base_model.BaseModel</em>, <em class="sig-param">commit: bool = False</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span> → sqlalchemy_unchained.base_model.BaseModel<a class="reference internal" href="_modules/sqlalchemy_unchained/model_manager.html#ModelManager.update"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sqlalchemy_unchained.ModelManager.update" title="Permalink to this definition">¶</a></dt>
<dd><p>Update <code class="docutils literal notranslate"><span class="pre">kwargs</span></code> on an instance, optionally committing the current session
transaction.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>instance</strong> – The model instance to update.</p></li>
<li><p><strong>commit</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a>) – Whether or not to commit the current session transaction.</p></li>
<li><p><strong>kwargs</strong> – The data to update on the model.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The updated model instance.</p>
</dd>
</dl>
</dd></dl>
<dl class="method">
<dt id="sqlalchemy_unchained.ModelManager.update_or_create">
<code class="sig-name descname">update_or_create</code><span class="sig-paren">(</span><em class="sig-param">defaults: dict = None</em>, <em class="sig-param">commit: bool = False</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span> → Tuple[sqlalchemy_unchained.base_model.BaseModel, bool]<a class="reference internal" href="_modules/sqlalchemy_unchained/model_manager.html#ModelManager.update_or_create"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sqlalchemy_unchained.ModelManager.update_or_create" title="Permalink to this definition">¶</a></dt>
<dd><p>Update or create an instance of <code class="docutils literal notranslate"><span class="pre">self.Meta.model</span></code> by <code class="docutils literal notranslate"><span class="pre">kwargs</span></code> and
<code class="docutils literal notranslate"><span class="pre">defaults</span></code>, optionally committing te current session transaction.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>defaults</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.8)"><em>dict</em></a>) – Extra values to update on the model</p></li>
<li><p><strong>commit</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a>) – Whether or not to commit the current session transaction.</p></li>
<li><p><strong>kwargs</strong> – The values to filter by and update on the model</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Tuple[the_model_instance, did_create_bool]</p>
</dd>
</dl>
</dd></dl>
<dl class="method">
<dt id="sqlalchemy_unchained.ModelManager.all">
<code class="sig-name descname">all</code><span class="sig-paren">(</span><span class="sig-paren">)</span> → List[sqlalchemy_unchained.base_model.BaseModel]<a class="reference internal" href="_modules/sqlalchemy_unchained/model_manager.html#ModelManager.all"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sqlalchemy_unchained.ModelManager.all" title="Permalink to this definition">¶</a></dt>
<dd><p>Query the database for all records of <code class="docutils literal notranslate"><span class="pre">self.Meta.model</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A list of all model instances (may be empty).</p>
</dd>
</dl>
</dd></dl>
<dl class="method">
<dt id="sqlalchemy_unchained.ModelManager.get">
<code class="sig-name descname">get</code><span class="sig-paren">(</span><em class="sig-param">id: Union[int, str, Tuple[int, ...], Tuple[str, ...]]</em><span class="sig-paren">)</span> → Optional[sqlalchemy_unchained.base_model.BaseModel]<a class="reference internal" href="_modules/sqlalchemy_unchained/model_manager.html#ModelManager.get"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sqlalchemy_unchained.ModelManager.get" title="Permalink to this definition">¶</a></dt>
<dd><p>Return an instance based on the given primary key identifier,
or <code class="docutils literal notranslate"><span class="pre">None</span></code> if not found.</p>
<p>E.g.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">my_user</span> <span class="o">=</span> <span class="n">UserManager</span><span class="p">()</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>

<span class="n">some_object</span> <span class="o">=</span> <span class="n">SomeObjectManager</span><span class="p">()</span><span class="o">.</span><span class="n">get</span><span class="p">((</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
</pre></div>
</div>
<p><code class="xref py py-meth docutils literal notranslate"><span class="pre">get()</span></code> is special in that it provides direct
access to the identity map of the owning <code class="xref py py-class docutils literal notranslate"><span class="pre">Session</span></code>.
If the given primary key identifier is present
in the local identity map, the object is returned
directly from this collection and no SQL is emitted,
unless the object has been marked fully expired.
If not present,
a SELECT is performed in order to locate the object.</p>
<p><code class="xref py py-meth docutils literal notranslate"><span class="pre">get()</span></code> also will perform a check if
the object is present in the identity map and
marked as expired - a SELECT
is emitted to refresh the object as well as to
ensure that the row is still present.
If not, <a class="reference external" href="https://docs.sqlalchemy.org/en/13/orm/exceptions.html#sqlalchemy.orm.exc.ObjectDeletedError" title="(in SQLAlchemy v1.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ObjectDeletedError</span></code></a> is raised.</p>
<p><code class="xref py py-meth docutils literal notranslate"><span class="pre">get()</span></code> is only used to return a single
mapped instance, not multiple instances or
individual column constructs, and strictly
on a single primary key value.  The originating
<code class="xref py py-class docutils literal notranslate"><span class="pre">Query</span></code> must be constructed in this way,
i.e. against a single mapped entity,
with no additional filtering criterion.  Loading
options via <code class="xref py py-meth docutils literal notranslate"><span class="pre">options()</span></code> may be applied
however, and will be used if the object is not
yet locally present.</p>
<p>A lazy-loading, many-to-one attribute configured
by <code class="xref py py-func docutils literal notranslate"><span class="pre">relationship()</span></code>, using a simple
foreign-key-to-primary-key criterion, will also use an
operation equivalent to <code class="xref py py-meth docutils literal notranslate"><span class="pre">get()</span></code> in order to retrieve
the target value from the local identity map
before querying the database.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>id</strong> – A scalar or tuple value representing
the primary key.   For a composite primary key,
the order of identifiers corresponds in most cases
to that of the mapped <code class="xref py py-class docutils literal notranslate"><span class="pre">Table</span></code> object’s
primary key columns.  For a <code class="xref py py-func docutils literal notranslate"><span class="pre">mapper()</span></code> that
was given the <code class="docutils literal notranslate"><span class="pre">primary</span> <span class="pre">key</span></code> argument during
construction, the order of identifiers corresponds
to the elements present in this collection.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The object instance, or <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p>
</dd>
</dl>
</dd></dl>
<dl class="method">
<dt id="sqlalchemy_unchained.ModelManager.get_by">
<code class="sig-name descname">get_by</code><span class="sig-paren">(</span><em class="sig-param">**kwargs</em><span class="sig-paren">)</span> → Optional[sqlalchemy_unchained.base_model.BaseModel]<a class="reference internal" href="_modules/sqlalchemy_unchained/model_manager.html#ModelManager.get_by"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sqlalchemy_unchained.ModelManager.get_by" title="Permalink to this definition">¶</a></dt>
<dd><p>Get one or none of <code class="docutils literal notranslate"><span class="pre">self.Meta.model</span></code> by <code class="docutils literal notranslate"><span class="pre">kwargs</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>kwargs</strong> – The data to filter by.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The model instance, or <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p>
</dd>
</dl>
</dd></dl>
<dl class="method">
<dt id="sqlalchemy_unchained.ModelManager.commit">
<code class="sig-name descname">commit</code><span class="sig-paren">(</span><span class="sig-paren">)</span> → None<a class="headerlink" href="#sqlalchemy_unchained.ModelManager.commit" title="Permalink to this definition">¶</a></dt>
<dd><p>Commits the current transaction.</p>
</dd></dl>
<dl class="method">
<dt id="sqlalchemy_unchained.ModelManager.filter">
<code class="sig-name descname">filter</code><span class="sig-paren">(</span><em class="sig-param">*criterion</em><span class="sig-paren">)</span> → sqlalchemy_unchained.base_query.BaseQuery<a class="reference internal" href="_modules/sqlalchemy_unchained/model_manager.html#ModelManager.filter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sqlalchemy_unchained.ModelManager.filter" title="Permalink to this definition">¶</a></dt>
<dd><p>Get all instances of <code class="docutils literal notranslate"><span class="pre">self.Meta.model</span></code> matching <code class="docutils literal notranslate"><span class="pre">criterion</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>criterion</strong> – The criterion to filter by.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A list of model instances (may be empty).</p>
</dd>
</dl>
</dd></dl>
<dl class="method">
<dt id="sqlalchemy_unchained.ModelManager.no_autoflush">
<em class="property">property </em><code class="sig-name descname">no_autoflush</code><a class="headerlink" href="#sqlalchemy_unchained.ModelManager.no_autoflush" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a context manager that disables autoflush.</p>
<p>e.g.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">session</span><span class="o">.</span><span class="n">no_autoflush</span><span class="p">:</span>

    <span class="n">some_object</span> <span class="o">=</span> <span class="n">SomeClass</span><span class="p">()</span>
    <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">some_object</span><span class="p">)</span>
    <span class="c1"># won't autoflush</span>
    <span class="n">some_object</span><span class="o">.</span><span class="n">related_thing</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">SomeRelated</span><span class="p">)</span><span class="o">.</span><span class="n">first</span><span class="p">()</span>
</pre></div>
</div>
<p>Operations that proceed within the <code class="docutils literal notranslate"><span class="pre">with:</span></code> block will not be subject to
flushes occurring upon query access.  This is useful when initializing a
series of objects which involve existing database queries, where the
uncompleted object should not yet be flushed.</p>
</dd></dl>
<dl class="method">
<dt id="sqlalchemy_unchained.ModelManager.save">
<code class="sig-name descname">save</code><span class="sig-paren">(</span><em class="sig-param">instance: sqlalchemy_unchained.base_model.BaseModel</em>, <em class="sig-param">commit: bool = False</em><span class="sig-paren">)</span> → sqlalchemy_unchained.base_model.BaseModel<a class="headerlink" href="#sqlalchemy_unchained.ModelManager.save" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a model instance to the session, optionally committing the current
transaction immediately.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>instance</strong> – The model instance to save.</p></li>
<li><p><strong>commit</strong> – Whether or not to immediately commit. <strong>WARNING:</strong> This
will commit the <em>entire</em> session, including any other model
instances that may have been added to the session but not
yet committed.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The model instance.</p>
</dd>
</dl>
</dd></dl>
<dl class="method">
<dt id="sqlalchemy_unchained.ModelManager.save_all">
<code class="sig-name descname">save_all</code><span class="sig-paren">(</span><em class="sig-param">instances: List[sqlalchemy_unchained.base_model.BaseModel], commit: bool = False</em><span class="sig-paren">)</span> → List[sqlalchemy_unchained.base_model.BaseModel]<a class="headerlink" href="#sqlalchemy_unchained.ModelManager.save_all" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds a list of model instances to the session, optionally committing the
current transaction immediately.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>instances</strong> – The list of model instance to save.</p></li>
<li><p><strong>commit</strong> – Whether or not to immediately commit. <strong>WARNING:</strong> This
will commit the <em>entire</em> session, including any other model
instances that may have been added to the session but not
yet committed.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The list of model instances.</p>
</dd>
</dl>
</dd></dl>
<dl class="method">
<dt id="sqlalchemy_unchained.ModelManager.set_session_factory">
<em class="property">classmethod </em><code class="sig-name descname">set_session_factory</code><span class="sig-paren">(</span><em class="sig-param">session_factory</em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy_unchained.ModelManager.set_session_factory" title="Permalink to this definition">¶</a></dt>
<dd><p>Classmethod to set the session factory
<a class="reference internal" href="#sqlalchemy_unchained.SessionManager" title="sqlalchemy_unchained.SessionManager"><code class="xref py py-class docutils literal notranslate"><span class="pre">SessionManager</span></code></a> should use.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>session_factory</strong> – The session factory callable.</p>
</dd>
</dl>
</dd></dl>
<dl class="method">
<dt id="sqlalchemy_unchained.ModelManager.filter_by">
<code class="sig-name descname">filter_by</code><span class="sig-paren">(</span><em class="sig-param">**kwargs</em><span class="sig-paren">)</span> → sqlalchemy_unchained.base_query.BaseQuery<a class="reference internal" href="_modules/sqlalchemy_unchained/model_manager.html#ModelManager.filter_by"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sqlalchemy_unchained.ModelManager.filter_by" title="Permalink to this definition">¶</a></dt>
<dd><p>Get all instances of <code class="docutils literal notranslate"><span class="pre">self.Meta.model</span></code> matching <code class="docutils literal notranslate"><span class="pre">kwargs</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>kwargs</strong> – The data to filter by.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A list of model instances (may be empty).</p>
</dd>
</dl>
</dd></dl>
</dd></dl>


<h2 id="columnmetaoption">ColumnMetaOption<a class="headerlink" href="#columnmetaoption" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="sqlalchemy_unchained.ColumnMetaOption">
<em class="property">class </em><code class="sig-prename descclassname">sqlalchemy_unchained.</code><code class="sig-name descname">ColumnMetaOption</code><span class="sig-paren">(</span><em class="sig-param">name: str</em>, <em class="sig-param">default: Any = None</em>, <em class="sig-param">inherit: bool = False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sqlalchemy_unchained/model_meta_options.html#ColumnMetaOption"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sqlalchemy_unchained.ColumnMetaOption" title="Permalink to this definition">¶</a></dt>
<dd><p>A <a class="reference external" href="https://py-meta-utils.readthedocs.io/en/latest/api.html#py_meta_utils.MetaOption" title="(in Py-Meta-Utils)"><code class="xref py py-class docutils literal notranslate"><span class="pre">MetaOption</span></code></a> subclass that simplifies adding columns
to models. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">sqlalchemy</span> <span class="k">as</span> <span class="nn">sa</span>

<span class="kn">from</span> <span class="nn">sqlalchemy_unchained</span> <span class="k">import</span> <span class="n">ColumnMetaOption</span>


<span class="k">class</span> <span class="nc">NameColumnMetaOption</span><span class="p">(</span><span class="n">ColumnMetaOption</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">():</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">'name'</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s1">'name'</span><span class="p">,</span> <span class="n">inherit</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_column</span><span class="p">(</span><span class="n">mcs_args</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">sa</span><span class="o">.</span><span class="n">Column</span><span class="p">(</span><span class="n">sa</span><span class="o">.</span><span class="n">String</span><span class="p">,</span> <span class="n">nullable</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
<dl class="method">
<dt id="sqlalchemy_unchained.ColumnMetaOption.check_value">
<code class="sig-name descname">check_value</code><span class="sig-paren">(</span><em class="sig-param">value</em>, <em class="sig-param">mcs_args: py_meta_utils.McsArgs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sqlalchemy_unchained/model_meta_options.html#ColumnMetaOption.check_value"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sqlalchemy_unchained.ColumnMetaOption.check_value" title="Permalink to this definition">¶</a></dt>
<dd><p>Optional callback to verify the user provided a valid value.</p>
<p>Your implementation should assert/raise with an error message if invalid.</p>
</dd></dl>
<dl class="method">
<dt id="sqlalchemy_unchained.ColumnMetaOption.contribute_to_class">
<code class="sig-name descname">contribute_to_class</code><span class="sig-paren">(</span><em class="sig-param">mcs_args: py_meta_utils.McsArgs</em>, <em class="sig-param">col_name</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sqlalchemy_unchained/model_meta_options.html#ColumnMetaOption.contribute_to_class"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sqlalchemy_unchained.ColumnMetaOption.contribute_to_class" title="Permalink to this definition">¶</a></dt>
<dd><p>Optional callback to modify the <code class="xref py py-class docutils literal notranslate"><span class="pre">McsArgs</span></code> of the class-under-construction.</p>
</dd></dl>
</dd></dl>


<h2 id="modelmetaoptionsfactory">ModelMetaOptionsFactory<a class="headerlink" href="#modelmetaoptionsfactory" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="sqlalchemy_unchained.ModelMetaOptionsFactory">
<em class="property">class </em><code class="sig-prename descclassname">sqlalchemy_unchained.</code><code class="sig-name descname">ModelMetaOptionsFactory</code><a class="reference internal" href="_modules/sqlalchemy_unchained/model_meta_options.html#ModelMetaOptionsFactory"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sqlalchemy_unchained.ModelMetaOptionsFactory" title="Permalink to this definition">¶</a></dt>
<dd><p>The default <a class="reference external" href="https://py-meta-utils.readthedocs.io/en/latest/api.html#py_meta_utils.MetaOptionsFactory" title="(in Py-Meta-Utils)"><code class="xref py py-class docutils literal notranslate"><span class="pre">MetaOptionsFactory</span></code></a> subclass used by
SQLAlchemy Unchained.</p>
</dd></dl>


<h2 id="modelregistry">_ModelRegistry<a class="headerlink" href="#modelregistry" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="sqlalchemy_unchained._ModelRegistry">
<em class="property">class </em><code class="sig-prename descclassname">sqlalchemy_unchained.</code><code class="sig-name descname">_ModelRegistry</code><a class="reference internal" href="_modules/sqlalchemy_unchained/model_registry.html#_ModelRegistry"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sqlalchemy_unchained._ModelRegistry" title="Permalink to this definition">¶</a></dt>
<dd><p>The SQLAlchemy Unchained model registry.</p>
<dl class="method">
<dt id="sqlalchemy_unchained._ModelRegistry.finalize_mappings">
<code class="sig-name descname">finalize_mappings</code><span class="sig-paren">(</span><span class="sig-paren">)</span> → Dict[str, object]<a class="reference internal" href="_modules/sqlalchemy_unchained/model_registry.html#_ModelRegistry.finalize_mappings"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sqlalchemy_unchained._ModelRegistry.finalize_mappings" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a dictionary of the model classes that were finalized.</p>
<p>Keyed by the names of the model classes, values are the classes themselves.</p>
</dd></dl>
<dl class="method">
<dt id="sqlalchemy_unchained._ModelRegistry.should_initialize">
<code class="sig-name descname">should_initialize</code><span class="sig-paren">(</span><em class="sig-param">mcs_init_args: py_meta_utils.McsInitArgs</em><span class="sig-paren">)</span> → bool<a class="reference internal" href="_modules/sqlalchemy_unchained/model_registry.html#_ModelRegistry.should_initialize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sqlalchemy_unchained._ModelRegistry.should_initialize" title="Permalink to this definition">¶</a></dt>
<dd><p>Whether or not the model represented by <code class="docutils literal notranslate"><span class="pre">mcs_init_args</span></code> should be initialized.</p>
</dd></dl>
</dd></dl>


<h2 id="basevalidator">BaseValidator<a class="headerlink" href="#basevalidator" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="sqlalchemy_unchained.BaseValidator">
<em class="property">class </em><code class="sig-prename descclassname">sqlalchemy_unchained.</code><code class="sig-name descname">BaseValidator</code><span class="sig-paren">(</span><em class="sig-param">msg=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sqlalchemy_unchained/validation.html#BaseValidator"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sqlalchemy_unchained.BaseValidator" title="Permalink to this definition">¶</a></dt>
<dd><p>Base class for column validators in SQLAlchemy Unchained.</p>
<p>You should supply the error message to the constructor, and implement your
validation logic in <code class="xref py py-meth docutils literal notranslate"><span class="pre">__call__()</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sqlalchemy_unchained</span> <span class="k">import</span> <span class="n">BaseValidator</span><span class="p">,</span> <span class="n">ValidationError</span>


<span class="k">class</span> <span class="nc">NameRequired</span><span class="p">(</span><span class="n">BaseValidator</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">msg</span><span class="o">=</span><span class="s1">'Name is required.'</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">msg</span><span class="o">=</span><span class="n">msg</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__call__</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">value</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">ValidationError</span><span class="p">(</span><span class="n">validator</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">YourModel</span><span class="p">(</span><span class="n">db</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">Column</span><span class="p">(</span><span class="n">db</span><span class="o">.</span><span class="n">String</span><span class="p">,</span> <span class="n">nullable</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">info</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
        <span class="n">validators</span><span class="o">=</span><span class="p">[</span><span class="n">NameRequired</span><span class="p">]))</span>
</pre></div>
</div>
<dl class="attribute">
<dt id="sqlalchemy_unchained.BaseValidator.msg">
<code class="sig-name descname">msg</code><em class="property"> = None</em><a class="headerlink" href="#sqlalchemy_unchained.BaseValidator.msg" title="Permalink to this definition">¶</a></dt>
<dd><p>The message for this validator.</p>
</dd></dl>
<dl class="method">
<dt id="sqlalchemy_unchained.BaseValidator.get_message">
<code class="sig-name descname">get_message</code><span class="sig-paren">(</span><em class="sig-param">e: sqlalchemy_unchained.validation.ValidationError</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sqlalchemy_unchained/validation.html#BaseValidator.get_message"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sqlalchemy_unchained.BaseValidator.get_message" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the message for this validation error. By default we just return
<code class="docutils literal notranslate"><span class="pre">self.msg</span></code>, but you can override this method if you need to customize
the message.</p>
</dd></dl>
</dd></dl>


<h2 id="validationerror">ValidationError<a class="headerlink" href="#validationerror" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="sqlalchemy_unchained.ValidationError">
<em class="property">class </em><code class="sig-prename descclassname">sqlalchemy_unchained.</code><code class="sig-name descname">ValidationError</code><span class="sig-paren">(</span><em class="sig-param">msg: str = None</em>, <em class="sig-param">model=None</em>, <em class="sig-param">column=None</em>, <em class="sig-param">validator=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sqlalchemy_unchained/validation.html#ValidationError"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sqlalchemy_unchained.ValidationError" title="Permalink to this definition">¶</a></dt>
<dd><p>Holds a validation error for a single column of a model.</p>
<dl class="attribute">
<dt id="sqlalchemy_unchained.ValidationError.msg">
<code class="sig-name descname">msg</code><em class="property"> = None</em><a class="headerlink" href="#sqlalchemy_unchained.ValidationError.msg" title="Permalink to this definition">¶</a></dt>
<dd><p>The error message. If <code class="docutils literal notranslate"><span class="pre">validator</span></code> is provided and it implements
<code class="docutils literal notranslate"><span class="pre">get_message</span></code>, that will take precedence over this value.</p>
</dd></dl>
<dl class="attribute">
<dt id="sqlalchemy_unchained.ValidationError.model">
<code class="sig-name descname">model</code><em class="property"> = None</em><a class="headerlink" href="#sqlalchemy_unchained.ValidationError.model" title="Permalink to this definition">¶</a></dt>
<dd><p>The model this validation error is for.</p>
</dd></dl>
<dl class="attribute">
<dt id="sqlalchemy_unchained.ValidationError.column">
<code class="sig-name descname">column</code><em class="property"> = None</em><a class="headerlink" href="#sqlalchemy_unchained.ValidationError.column" title="Permalink to this definition">¶</a></dt>
<dd><p>The <code class="xref py py-class docutils literal notranslate"><span class="pre">Column</span></code> this validation error is for.</p>
</dd></dl>
<dl class="attribute">
<dt id="sqlalchemy_unchained.ValidationError.validator">
<code class="sig-name descname">validator</code><em class="property"> = None</em><a class="headerlink" href="#sqlalchemy_unchained.ValidationError.validator" title="Permalink to this definition">¶</a></dt>
<dd><p>The validator instance that raised this validation error.</p>
</dd></dl>
</dd></dl>


<h2 id="validationerrors">ValidationErrors<a class="headerlink" href="#validationerrors" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="sqlalchemy_unchained.ValidationErrors">
<em class="property">class </em><code class="sig-prename descclassname">sqlalchemy_unchained.</code><code class="sig-name descname">ValidationErrors</code><span class="sig-paren">(</span><em class="sig-param">errors: Dict[str, List[str]]</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sqlalchemy_unchained/validation.html#ValidationErrors"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sqlalchemy_unchained.ValidationErrors" title="Permalink to this definition">¶</a></dt>
<dd><p>Holds validation errors for an entire model.</p>
<dl class="attribute">
<dt id="sqlalchemy_unchained.ValidationErrors.errors">
<code class="sig-name descname">errors</code><em class="property"> = None</em><a class="headerlink" href="#sqlalchemy_unchained.ValidationErrors.errors" title="Permalink to this definition">¶</a></dt>
<dd><p>A dictionary of errors, where the keys are column names, and the values are
lists of error messages for each column.</p>
</dd></dl>
</dd></dl>


<h2 id="required">Required<a class="headerlink" href="#required" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="sqlalchemy_unchained.Required">
<em class="property">class </em><code class="sig-prename descclassname">sqlalchemy_unchained.</code><code class="sig-name descname">Required</code><span class="sig-paren">(</span><em class="sig-param">msg=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sqlalchemy_unchained/validation.html#Required"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sqlalchemy_unchained.Required" title="Permalink to this definition">¶</a></dt>
<dd><p>A validator to require data.</p>
</dd></dl>




          </article>
        </div>
      </div>
    </main>
  </div>
  <footer class="md-footer">
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
          
            <a href="index.html" title="Material"
               class="md-flex md-footer-nav__link md-footer-nav__link--prev"
               rel="prev">
              <div class="md-flex__cell md-flex__cell--shrink">
                <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
              </div>
              <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
                <span class="md-flex__ellipsis">
                  <span
                      class="md-footer-nav__direction"> Previous </span> Introducing SQLAlchemy Unchained </span>
              </div>
            </a>
          
          
        </a>
        
      </nav>
    </div>
    <div class="md-footer-meta md-typeset">
      <div class="md-footer-meta__inner md-grid">
        <div class="md-footer-copyright">
          <div class="md-footer-copyright__highlight">
              &#169; Copyright 2018, Brian Cappello.
              
          </div>
            Created using
            <a href="http://sphinx-doc.org/">Sphinx</a> 2.2.0.
             and
            <a href="https://github.com/bashtage/sphinx-material/">Material for
              Sphinx</a>
        </div>
      </div>
    </div>
  </footer>
  <script src="_static/javascripts/application.js"></script>
  <script>app.initialize({version: "1.0.4", url: {base: ".."}})</script>
  </body>
</html>